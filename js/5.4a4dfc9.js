(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"+zHP":function(t,e,a){"use strict";var s=a("9Dpx"),i=a.n(s);i.a},"4LiD":function(t,e,a){"use strict";var s=a("dyZX"),i=a("XKFU"),o=a("KroJ"),n=a("3Lyj"),c=a("Z6vF"),r=a("SlkY"),h=a("9gX7"),l=a("0/R4"),d=a("eeVq"),u=a("XMVh"),v=a("fyDq"),f=a("Xbzi");t.exports=function(t,e,a,p,m,y){var g=s[t],D=g,k=m?"set":"add",w=D&&D.prototype,B={},b=function(t){var e=w[t];o(w,t,"delete"==t?function(t){return!(y&&!l(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(y&&!l(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return y&&!l(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,a){return e.call(this,0===t?0:t,a),this})};if("function"==typeof D&&(y||w.forEach&&!d(function(){(new D).entries().next()}))){var A=new D,$=A[k](y?{}:-0,1)!=A,P=d(function(){A.has(1)}),S=u(function(t){new D(t)}),O=!y&&d(function(){var t=new D,e=5;while(e--)t[k](e,e);return!t.has(-0)});S||(D=e(function(e,a){h(e,D,t);var s=f(new g,e,D);return void 0!=a&&r(a,m,s[k],s),s}),D.prototype=w,w.constructor=D),(P||O)&&(b("delete"),b("has"),m&&b("get")),(O||$)&&b(k),y&&w.clear&&delete w.clear}else D=p.getConstructor(e,t,m,k),n(D.prototype,a),c.NEED=!0;return v(D,t),B[t]=D,i(i.G+i.W+i.F*(D!=g),B),y||p.setStrong(D,t,m),D}},"7d8t":function(t,e,a){},"9Dpx":function(t,e,a){},BfXX:function(t,e,a){"use strict";var s=a("MWdH"),i=a.n(s);i.a},Bjc7:function(t,e,a){"use strict";var s=a("7d8t"),i=a.n(s);i.a},JGJa:function(t,e,a){},MWdH:function(t,e,a){},MjWO:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-page",[a("q-toolbar",{attrs:{color:"faded"}},[a("q-toolbar-title",[a("span",{staticClass:"q-title"},[t._v(t._s(t.getEventName))]),a("q-breadcrumbs",{attrs:{color:"white","active-color":"info",separator:">"}},[a("q-breadcrumbs-el",{staticClass:"q-subheading text-weight-bold",attrs:{active:"",color:"info",label:"Events",to:"/events"}}),a("q-breadcrumbs-el",{staticClass:"q-subheading text-weight-bold",attrs:{active:"",color:"info",label:"Seasons",to:{name:"eventSeason",params:{id:t.eventKey}}}}),a("q-breadcrumbs-el",{staticClass:"q-subheading text-weight-bold",attrs:{active:"",color:"info",label:"Batch"}})],1)],1),t.isNewBatch||t.$store.state.users.isNewSeasonActivities||t.editMode?t._e():a("div",[a("span",{staticClass:"q-caption"},[t._v("View Mode: ")]),a("q-btn-toggle",{staticClass:"q-mx-md",attrs:{rounded:"",size:"sm","toggle-color":"primary",options:[{label:"Batch",value:"batchMode"},{label:"Calendar",value:"calendarMode"},{label:"Agenda",value:"agendaMode"}]},on:{click:t.switchMode},model:{value:t.viewMode,callback:function(e){t.viewMode=e},expression:"viewMode"}})],1),a("div",{staticClass:"q-mr-md\t"},[t.isNewBatch?a("q-toggle",{attrs:{label:"All Batches"},model:{value:t.viewAllBatches,callback:function(e){t.viewAllBatches=e},expression:"viewAllBatches"}}):t._e()],1),t.$store.state.users.isNewSeasonActivities||t.isNewBatch||t.editMode?a("div",[a("q-btn",{staticClass:"q-my-md",attrs:{size:"sm",rounded:"",inverted:"",color:"secondary"},on:{click:t.saveSeasonActivities}},[t._v("Save")]),a("q-btn",{staticClass:"q-my-md",attrs:{size:"sm",rounded:"",inverted:"",color:"negative"},on:{click:t.cancel}},[t._v("Cancel")])],1):t._e(),a("q-btn-group",{attrs:{outline:""}},[t.$store.state.users.isNewSeasonActivities||t.isNewBatch||t.editMode?t._e():a("q-btn",{attrs:{color:"positive",size:"sm",rounded:""},on:{click:function(e){t.checkIfOverlap()}}},[t._v("New Batch")]),t.$store.state.users.isNewSeasonActivities||t.isNewBatch||t.editMode?t._e():a("q-btn",{attrs:{color:"primary",rounded:"",size:"sm",label:"Edit Batch"},on:{click:function(e){t.editBatch2()}}})],1),t.isCalendarView||t.isNewBatch||t.$store.state.users.isNewSeasonActivities?a("q-btn",{staticClass:"q-ml-md",attrs:{icon:"keyboard_arrow_left",size:"sm",color:"info",rounded:"",label:"activity list"},on:{click:function(e){t.showRight=!t.showRight,t.generateBatchNodes()}}}):t._e()],1),a("div"),a("div",{staticClass:"q-ma-md"},[t.isNewBatch||t.isCalendarView||t.isAgendaView?t._e():a("event-batch-view-component",{attrs:{eventKey:t.eventKey,seasonNumber:parseInt(t.seasonNumber)}})],1),t.$store.state.users.isNewSeasonActivities||t.isNewBatch||t.isCalendarView?a("div",{staticClass:"col calendar-parent",staticStyle:{"max-height":"100vw",height:"70vw"}},[a("calendar-view",{key:Date.now(),staticClass:"theme-default holiday-us-traditional q-ma-md",attrs:{"show-date":t.showDate,events:t.switchCalendarEvent,"show-event-times":t.showEventTimes,enableDragDrop:t.enableDragDrop,timeFormatOptions:{hour:"numeric",minute:"numeric",hour12:!0},startingDayOfWeek:t.startingDayOfWeek},on:{"show-date-change":t.setShowDate,"click-date":t.clickDate,"click-event":t.clickEvent,"drop-on-date":t.dropOnDate}})],1):t._e(),t.isAgendaView?a("div",[a("calendar-agenda",{staticClass:"q-ma-md",attrs:{"start-date":t.showDate,"event-array":t.agendaActivities,"allow-editing":!1}})],1):t._e(),a("q-modal",{attrs:{"content-css":{minWidth:"30vw",minHeight:"50vh"}},on:{hide:t.clearActivityModal},model:{value:t.activityModal,callback:function(e){t.activityModal=e},expression:"activityModal"}},[a("q-modal-layout",{attrs:{"content-class":"{'bg-primary': true}","footer-class":"","footer-style":"{fontSize: '24px', fontWeight: 'bold'}"}},[a("q-toolbar",[a("q-toolbar-title",[t._v("\n\t\t\t\t\t\t"+t._s(t.activity.originalEvent.title)+"\n          ")]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:function(e){t.activityModal=!1}}})],1),a("div",[a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Activity"},model:{value:t.activity.originalEvent.type,callback:function(e){t.$set(t.activity.originalEvent,"type",e)},expression:"activity.originalEvent.type"}}),t.activity.originalEvent.startDate&&"orientation"!==t.activity.originalEvent.type&&t.activity.originalEvent.type!==t.getBatchFinalEvent.type?a("q-datetime",{staticClass:"q-ma-md",attrs:{disable:"",min:t.getStartDateMin(t.activity.originalEvent),format:"MMM-DD-YYYY","stack-label":"Date",type:"date"},model:{value:t.activity.originalEvent.startDate,callback:function(e){t.$set(t.activity.originalEvent,"startDate",e)},expression:"activity.originalEvent.startDate"}}):t._e(),"payment"===t.activity.originalEvent.type?a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",prefix:"P",type:"number","stack-label":"Amount"},model:{value:t.activity.originalEvent.amount,callback:function(e){t.$set(t.activity.originalEvent,"amount",e)},expression:"activity.originalEvent.amount"}}):t._e(),t.activity.originalEvent.time?a("q-datetime",{staticClass:"q-ma-md",attrs:{disable:!t.editMode&&!t.isNewBatch,format:"h:mm A","stack-label":"Time",type:"time"},model:{value:t.activity.originalEvent.time,callback:function(e){t.$set(t.activity.originalEvent,"time",e)},expression:"activity.originalEvent.time"}}):t._e(),t.activity.originalEvent.dueDate?a("q-datetime",{staticClass:"q-ma-md",attrs:{disable:!t.editMode&&!t.isNewBatch,format:"MMM-DD-YYYY",min:t.$mathMixin.addDays(new Date(t.activity.originalEvent.startDate),1),"stack-label":"Due Date",type:"date"},model:{value:t.activity.originalEvent.dueDate,callback:function(e){t.$set(t.activity.originalEvent,"dueDate",e)},expression:"activity.originalEvent.dueDate"}}):t._e(),""!==t.activity.originalEvent.location&&!t.activity.originalEvent.location||t.activity.originalEvent.dueDate||t.activity.originalEvent.amount?t._e():a("q-input",{staticClass:"q-ma-md",attrs:{disable:!t.editMode&&!t.isNewBatch,type:"textarea","stack-label":"Location",rows:"7"},model:{value:t.activity.originalEvent.location,callback:function(e){t.$set(t.activity.originalEvent,"location",e)},expression:"activity.originalEvent.location"}},[a("q-autocomplete",{attrs:{"min-characters":0,debounce:700},on:{search:t.searchLocation,selected:t.selected}})],1),""!==t.activity.originalEvent.details&&!t.activity.originalEvent.details||t.activity.originalEvent.dueDate||t.activity.originalEvent.amount?t._e():a("q-input",{staticClass:"q-ma-md",attrs:{disable:!t.editMode&&!t.isNewBatch,type:"textarea","stack-label":"Details",rows:"7"},model:{value:t.activity.originalEvent.details,callback:function(e){t.$set(t.activity.originalEvent,"details",e)},expression:"activity.originalEvent.details"}},[a("q-autocomplete",{attrs:{"min-characters":0,debounce:700},on:{search:t.searchDetails,selected:t.selected}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("q-btn",{staticClass:"full-width",attrs:{color:"primary"},on:{click:t.saveActivity}},[t._v("OK")])],1)],1)],1),a("q-modal",{attrs:{maximized:""},on:{hide:t.clearNewBatch},model:{value:t.newBatchModal,callback:function(e){t.newBatchModal=e},expression:"newBatchModal"}},[a("q-modal-layout",{attrs:{"content-class":"{'bg-primary': true}","footer-class":"","footer-style":"{fontSize: '24px', fontWeight: 'bold'}"}},[a("q-toolbar",[a("q-toolbar-title",[t._v("\n            New Batch\n          ")]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:function(e){t.newBatchModal=!1}}})],1),a("div",[a("div",[a("new-batch-modal",{attrs:{eventKey:t.eventKey,eventCode:t.getEventCode,seasonNumber:parseInt(t.seasonNumber),seasonEnd:t.getSeasonEnd,lastBatchCourse:t.getLastBatch.course}}),a("q-field",{staticClass:"q-mx-md",attrs:{orientation:"vertical"}},t._l(t.getWorkshopActivity,function(e,s){return a("div",{key:s,staticClass:"q-my-md"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("span",{staticClass:"caption q-my-md"},[t._v("Workshop "+t._s(s+1))]),a("p",[t._v("Possible Dates: "),a("br"),t._l(t.upcomingSundays,function(e,i){return a("q-btn-group",{key:i},[t.alreadySelected(e)?a("q-btn",{attrs:{size:"sm"},on:{click:function(a){t.selectUpcomingDate(s,e)}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(t.$moment(e).format("ll"))+"\n\t\t\t\t\t\t\t\t\t\t\t\t")]):t._e()],1)})],2),a("q-datetime",{attrs:{disable:"",max:new Date(t.getSeasonEnd),format:"MMM-DD-YYYY","stack-label":"Date",type:"date"},model:{value:t.workshops.startDate[s],callback:function(e){t.$set(t.workshops.startDate,s,e)},expression:"workshops.startDate[i]"}}),a("q-datetime",{attrs:{format:"h:mm A","stack-label":"Time",type:"time"},model:{value:t.workshops.time[s],callback:function(e){t.$set(t.workshops.time,s,e)},expression:"workshops.time[i]"}}),a("q-input",{attrs:{"float-label":"Location","max-height":100,rows:"7",type:"textarea"},model:{value:t.workshops.location[s],callback:function(e){t.$set(t.workshops.location,s,e)},expression:"workshops.location[i]"}},[a("q-autocomplete",{attrs:{"min-characters":0,debounce:700},on:{search:t.searchLocation,selected:t.selected}})],1),t.getWorkshop.details?a("q-input",{attrs:{"float-label":"Details",type:"textarea","max-height":50,rows:"5"},model:{value:t.workshops.details[s],callback:function(e){t.$set(t.workshops.details,s,e)},expression:"workshops.details[i]"}},[a("q-autocomplete",{attrs:{"min-characters":0,debounce:700},on:{search:t.searchDetails,selected:t.selected}})],1):t._e()],1)]),a("q-item-separator")],1)}))],1)])],1)],1),a("q-modal",{attrs:{"content-css":{minWidth:"50vw",minHeight:"50vh"}},on:{hide:t.clearNewBatch},model:{value:t.batchNodeActivityModal,callback:function(e){t.batchNodeActivityModal=e},expression:"batchNodeActivityModal"}},[a("q-modal-layout",{attrs:{"content-class":"{'bg-primary': true}","footer-class":"","footer-style":"{fontSize: '24px', fontWeight: 'bold'}"}})],1),a("q-modal",{attrs:{maximized:""},on:{hide:function(t){},show:function(e){t.onShowEditBatch()}},model:{value:t.editBatchModal,callback:function(e){t.editBatchModal=e},expression:"editBatchModal"}},[a("q-modal-layout",{attrs:{"content-class":"{'bg-primary': true}","footer-class":"","footer-style":"{fontSize: '24px', fontWeight: 'bold'}"}},[a("q-toolbar",{attrs:{slot:"header"},slot:"header"},[a("q-toolbar-title",[t._v("Edit Batch")]),a("q-select",{staticStyle:{width:"150px"},attrs:{inverted:"","no-parent-field":"","float-label":"Select Batch",options:t.editBatchOpt},on:{input:function(e){t.onChangeSelectBatch()}},model:{value:t.selectedBatch,callback:function(e){t.selectedBatch=e},expression:"selectedBatch"}}),a("q-btn",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),"final event"!==t.selectedBatch?a("edit-batch-modal",{ref:"editBatchModalRef",attrs:{batchKey:t.selectedBatch,eventKey:t.eventKey,eventCode:t.getEventCode,seasonNumber:parseInt(t.seasonNumber),seasonEnd:t.getSeasonEnd,lastBatchCourse:t.getLastBatch.course}}):a("edit-final-activity",{attrs:{eventKey:t.eventKey,seasonNumber:parseInt(t.seasonNumber),finalActivity:t.getBatchFinalEvent}})],1)],1)],1),a("q-layout-drawer",{attrs:{"content-class":"bg-grey-3 flex ","content-style":{padding:"10px"},side:"right"},model:{value:t.showRight,callback:function(e){t.showRight=e},expression:"showRight"}},[a("div",[a("q-btn",{staticClass:"flex flex-right",attrs:{rounded:"",color:"info",label:"hide",icon:"keyboard_arrow_right",size:"xs"},on:{click:function(e){t.showRight=!t.showRight}}}),a("div",[a("span",{staticClass:"q-title text-weight-bold q-ma-md"},[t._v(t._s(t.getEventName))]),a("br"),a("span",{staticClass:"q-title q-mx-md"},[t._v("Season "+t._s(t.seasonNumber))]),a("q-tree",{attrs:{nodes:t.batchNode,"node-key":"label",accordion:"",selected:t.selectNode,"default-expand-all":""},on:{"update:selected":function(e){t.selectNode=e}},scopedSlots:t._u([{key:"default-header",fn:function(e){return a("div",{staticClass:"row items-center",on:{click:function(a){t.clickBatchNode(e)}}},[t.isBatchMissingDetails(e)?a("q-icon",{staticClass:"q-mr-sm",attrs:{name:"warning",color:"orange",size:"28px"}}):t._e(),a("div",{staticClass:"text-weight-bold text-primary"},[t.isMissingDetails(e)?a("q-icon",{staticClass:"q-mr-sm",attrs:{name:"warning",color:"orange",size:"28px"}}):t._e(),t._v("\n\t\t\t\t\t\t\t"+t._s(e.node.label))],1)],1)}},{key:"default-body",fn:function(e){return a("div",{},[e.node.startDate?a("div",[a("span",{staticClass:"text-weight-bold"},[t._v("Date")]),t._v(": "+t._s(t.$moment(e.node.startDate).format("ll"))+"\n\t\t\t\t\t\t\t")]):t._e(),e.node.amount?a("div",[a("span",{staticClass:"text-weight-bold"},[t._v("Amount")]),t._v(": "+t._s(t._f("currency")(e.node.amount))+"\n\t\t\t\t\t\t\t")]):t._e(),e.node.dueDate?a("div",[a("span",{staticClass:"text-weight-bold"},[t._v("Date End")]),t._v(": "+t._s(t.$moment(e.node.dueDate).format("ll"))+"\n\t\t\t\t\t\t\t")]):t._e()])}}])})],1)],1)])],1)},i=[];s._withStripped=!0;a("rGqo"),a("yt8O"),a("RW0V");var o=a("lSNA"),n=a.n(o),c=(a("91GP"),a("INYr"),a("a1Th"),a("MVZn")),r=a.n(c),h=(a("SRfc"),a("RIqP")),l=a.n(h),d=a("VVcl"),u=a.n(d),v=a("kv6+"),f=a("wdPS"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-table",{attrs:{title:"Batches",data:t.customBatches,columns:t.customColumn,"no-data-label":"No Batches Yet","row-key":"batchNumber"},scopedSlots:t._u([{key:"body",fn:function(e){return a("q-tr",{staticClass:"cursor-pointer",attrs:{props:e}},t._l(e.cols,function(s,i){return a("q-td",{key:s.name,attrs:{props:e}},[t.isActivityDate(s)?a("p",[t._v(t._s(t.$moment(s.value).format("ll")))]):"batchNumber"===s.name?a("p",[t._v(t._s(e.row.__index+1))]):"noOfModels"===s.name?a("p",[t._v(t._s(t.getNumOfSignedModels(e.row)))]):a("div",[t.isAbleToRemove(e)?a("q-btn",{attrs:{icon:"delete",round:"",color:"negative"},on:{click:function(a){t.removeBatch(e)}}}):t._e()],1)])}))}}])})],1)},m=[];p._withStripped=!0;a("f3/d"),a("xfY5");var y={props:{eventKey:{type:String,default:""},seasonNumber:{type:Number,default:0}},created:function(){},firebase:function(){return{schedules:this.$database.ref("event_schedules").orderByChild("eventKey").equalTo(this.eventKey),event:this.$database.ref("events").orderByKey().equalTo(this.eventKey)}},computed:{getSeasonStatus:function(){try{return this.$store.getters["startUp/getSeason"]({eventKey:this.eventKey,seasonNumber:this.seasonNumber}).status}catch(t){}},contractSigned:{get:function(){return this.$store.state.startUp.contractSigned},set:function(t){this.$store.state.startUp.contractSigned=t}},seasonBatchContractSigned:function(){var t=this,e=this.$lodash.filter(this.contractSigned,function(e){var a=parseInt(e.seasonName.match(/\d+/g)[0]);return e.eventKey===t.eventKey&&a===parseInt(t.seasonNumber)});return e},seasonBatches:function(){var t=this,e=this.$lodash.filter(this.schedules,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===t.seasonNumber});return e},customBatches:function(){var t=this;try{var e=new Array;l()(this.seasonBatches[0].activities);return this.$lodash.forEach(this.seasonBatches,function(a){var s=[],i=0,o=0;t.$lodash.forEach(a.activities,function(e){new Array;if("date range"===e.actType){var a=n()({},"".concat(t.$lodash.capitalize(e.type)," Start"),e.startDate),c=n()({},"".concat(t.$lodash.capitalize(e.type)," End"),e.endDate);s.push(a),s.push(c)}else if("payments"===e.type){++i;var r=n()({},"".concat(t.$lodash.capitalize(e.type)," ").concat(i),e.startDate);s.push(r)}else if("workshop"===e.type||"workshops"===e.type){++o;var h=n()({},"".concat(t.$lodash.capitalize(e.type)," ").concat(o),e.startDate);s.push(h)}else{var l=n()({},"".concat(t.$lodash.capitalize(e.type)),e.startDate);s.push(l)}});for(var c=0;c<s.length;c++){var h=t.$lodash.keys(s[c])[0],l=s[c][h];s[h]=h,s[h]=l}s.splice(0,s.length),e.push(r()({},s))}),e}catch(t){return[]}},customColumn:function(){var t=this;try{var e=this.seasonBatches[0].activities,a=new Array,s=0,i=0;this.$lodash.forEach(e,function(e){if("date range"===e.actType){var o={name:t.$lodash.capitalize(e.type)+"Start",required:!0,label:t.$lodash.capitalize(e.type)+" Start",align:"left",field:t.$lodash.capitalize(e.type)+" Start"},n={name:t.$lodash.capitalize(e.type)+"End",required:!0,label:t.$lodash.capitalize(e.type)+" End",align:"left",field:t.$lodash.capitalize(e.type)+" End"};a.push(o),a.push(n)}else if("payments"===e.type){s++;var c={name:e.title,required:!0,label:"".concat(t.$lodash.capitalize(e.type)," ").concat(s),align:"left",field:"".concat(t.$lodash.capitalize(e.type)," ").concat(s)};a.push(c)}else if("workshop"===e.type||"workshops"===e.type){i++;var r={name:e.title,required:!0,label:"".concat(t.$lodash.capitalize(e.type)," ").concat(i),align:"left",field:"".concat(t.$lodash.capitalize(e.type)," ").concat(i)};a.push(r)}else{var h={name:e.title,required:!0,label:t.$lodash.capitalize(e.type),align:"left",field:t.$lodash.capitalize(e.type)};a.push(h)}});var o={name:"batchNumber",label:"Batch",align:"left"};a.splice(0,0,o);var n={align:"center",label:"No. of Signed Models",name:"noOfModels",style:"width: 500px"},c={align:"center",label:"Action",name:"action"};return a.push(n),a.push(c),a}catch(t){return[]}}},data:function(){return{}},methods:{getProps:function(t){console.log("props",t)},removeBatch:function(t){var e=this;this.$q.dialog({title:"Confirm",message:"Are you sure you want to delete this batch?",ok:"Yes",cancel:"No"}).then(function(){console.log("seasonBatches",e.seasonBatches);var a=t.row.__index;if(a++,a<=1){var s=e.$lodash.findIndex(e.seasonBatches,function(t){return t.batchNumber===a}),i=e.seasonBatches[s],o=i[".key"],n=e;e.$database.ref("event_schedules").child(o).remove().then(function(){e.eventKey,e.seasonNumber;e.$database.ref("events/".concat(e.eventKey,"/seasons/").concat(e.seasonNumber-1)).remove().then(function(){n.$q.notify({message:"".concat(i.eventName," Season ").concat(i.seasonNumber," has been removed"),type:"info",color:"info",textColor:"white",icon:"info"}),n.$router.push("/eventseason/".concat(e.eventKey))}).catch(function(t){console.log("an error occur",t)})})}else{s=e.$lodash.findIndex(e.seasonBatches,function(t){return t.batchNumber===a});console.log("bIndex",e.seasonBatches[s]);var c=e.seasonBatches[s];o=c[".key"];e.$database.ref("event_schedules").child(o).remove().then(function(){e.$q.notify({message:"Batch ".concat(a," has been removed"),type:"info",color:"info",textColor:"white",icon:"info"})})}}).catch(function(){})},isAbleToRemove:function(t){if(!(t.row.__index>=this.customBatches.length-1))return!1;var e=t.row.__index;if("standby"===this.getSeasonStatus){if("standby"===this.getSeasonStatus||0===e)return!0;e++;var a=this.$lodash.findIndex(this.getSeasonBatches,function(t){return t.batchNumber===e}),s=this.getSeasonBatches[a],i=(s[".key"],this.$mathMixin.dayDiff(new Date,new Date(t.row.orientation)));if(i>0)return!0}},getNumOfSignedModels:function(t){var e=this.$store.getters["startUp/getPlainValue"](t),a=++e.__index,s=this.$lodash.findIndex(this.seasonBatches,function(t){return t.batchNumber===a}),i=this.seasonBatches[s],o=this.$lodash.filter(this.seasonBatchContractSigned,function(t){return t.batchKey===i[".key"]});return o.length},isActivityDate:function(t){return"batchNumber"!==t.name&&"noOfModels"!==t.name&&"action"!==t.name},test:function(){console.log("schdules",this.schedules),console.log("event",this.event),console.log("seasonBatches",this.seasonBatches)}}},g=y,D=a("KHd+"),k=Object(D["a"])(g,p,m,!1,null,null,null),w=k.exports,B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-ma-md"},[a("q-stepper",{ref:"stepper",attrs:{color:"secondary","alternative-labels":""}},[a("q-step",{attrs:{default:"",name:"first",title:"Set Date"}},[a("div",[a("q-select",{attrs:{filter:"","float-label":"Orientation Date",options:t.generateNewBatchPossibleDates},on:{input:t.onChangeNewBatchDate},model:{value:t.newBatchOrientationDate,callback:function(e){t.newBatchOrientationDate=e},expression:"newBatchOrientationDate"}})],1),a("q-stepper-navigation",[a("q-btn",{attrs:{color:"secondary",label:"Continue"},on:{click:function(e){t.$refs.stepper.next()}}})],1)],1),a("q-step",{attrs:{name:"second",title:"Activities"}},[a("activities",{ref:"activityRef",attrs:{eventKey:t.eventKey,eventCode:t.eventCode,seasonNumber:t.seasonNumber,seasonEnd:t.seasonEnd,lastBatchCourse:t.lastBatchCourse,newBatchOrientationDate:t.newBatchOrientationDate}}),a("q-stepper-navigation",[a("q-page-sticky",{attrs:{position:"bottom-right",offset:[18,18]}},[a("q-btn",{attrs:{color:"secondary",label:"Next"},on:{click:function(e){t.activityConfirmNext()}}})],1),a("q-page-sticky",{attrs:{position:"bottom-left",offset:[18,18]}},[a("q-btn",{attrs:{color:"secondary",flat:"",label:"Back"},on:{click:function(e){t.$refs.stepper.previous()}}})],1)],1)],1),a("q-step",{attrs:{name:"third",title:"Preview"}},[a("preview",{ref:"previewRef",attrs:{eventKey:t.eventKey,seasonNumber:t.seasonNumber,newBatchObject:t.getLastBatch,isNewBatch:!0}}),a("q-stepper-navigation",[a("q-page-sticky",{attrs:{position:"bottom-right",offset:[18,18]}},[a("q-btn",{attrs:{color:"secondary",label:"Finish"},on:{click:function(e){t.finishNewBatch()}}})],1),a("q-page-sticky",{attrs:{position:"bottom-left",offset:[18,18]}},[a("q-btn",{attrs:{color:"secondary",flat:"",label:"Back"},on:{click:function(e){t.backToActivity()}}})],1)],1)],1)],1)],1)},b=[];B._withStripped=!0;a("dRSK");var A,$=a("9JDm"),P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex row inline justify-center"},[a("div",[a("q-card",{staticClass:"q-ma-sm",staticStyle:{width:"350px"},attrs:{inline:""}},[a("q-card-title",[a("p",{staticClass:"q-title text-weight-bold"},[t._v("Orientation")])]),a("q-card-main",[a("q-field",{attrs:{orientation:"vertical","label-width":"2",icon:"date_range"}},[a("div",[a("q-datetime",{attrs:{disable:"",format:"ddd MMM D, YYYY",readonly:"",type:"date","stack-label":"Date"},model:{value:t.newBatchOrientationDate,callback:function(e){t.newBatchOrientationDate=e},expression:"newBatchOrientationDate"}}),a("q-datetime",{attrs:{format:"h:mm A",type:"time","stack-label":"Time"},model:{value:t.lastBatchOrientation.time,callback:function(e){t.$set(t.lastBatchOrientation,"time",e)},expression:"lastBatchOrientation.time"}})],1)])],1),a("q-card-separator",{attrs:{inset:""}}),a("q-card-main",[a("q-field",{attrs:{icon:"description"}},["new location"===this.lastBatchOrientation.locationID?a("div",{staticClass:"q-my-md flex row"},[a("q-input",{staticClass:"col-md-8",attrs:{"float-label":"Name"},model:{value:t.newOrientNameLocation,callback:function(e){t.newOrientNameLocation=e},expression:"newOrientNameLocation"}}),a("div",{staticClass:"q-mt-md"},[a("q-btn-group",{attrs:{rounded:""}},[a("q-btn",{attrs:{size:"sm",color:"positive",label:"Save"},on:{click:function(e){t.saveOrientLocation()}}}),a("q-btn",{attrs:{size:"sm",color:"negative",label:"Cancel"},on:{click:function(e){t.cancelNewOrientLocation()}}})],1)],1)],1):a("q-select",{attrs:{separator:"","float-label":"Select Location",filter:"",options:t.locationTemplateOpt},on:{input:t.onChangeOrientLocation},model:{value:t.lastBatchOrientation.locationID,callback:function(e){t.$set(t.lastBatchOrientation,"locationID",e)},expression:"lastBatchOrientation.locationID"}}),a("q-input",{attrs:{readonly:""===t.lastBatchOrientation.locationID,type:"textarea","float-label":"Location","max-height":80,rows:"5"},model:{value:t.lastBatchOrientation.location,callback:function(e){t.$set(t.lastBatchOrientation,"location",e)},expression:"lastBatchOrientation.location"}}),a("q-input",{attrs:{readonly:""===t.lastBatchOrientation.locationID,type:"textarea","float-label":"Details (optional)","max-height":80,rows:"5"},model:{value:t.lastBatchOrientation.details,callback:function(e){t.$set(t.lastBatchOrientation,"details",e)},expression:"lastBatchOrientation.details"}})],1)],1)],1)],1),a("div",[a("q-card",{staticClass:"q-ma-sm",staticStyle:{width:"400px"},attrs:{inline:""}},[a("q-card-title",[a("p",{staticClass:"q-title text-weight-bold"},[t._v("Payment\n\t      \t\t")])]),a("q-card-main",[a("q-field",{staticClass:"q-my-md",attrs:{orientation:"vertical",icon:"attach_money",label:"Payment Amount","error-label":"Please check Total Amount"}},[t._l(t.getLastBatch.numberOfPayments,function(e,s){return a("div",{key:e,staticClass:"row inline flex"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[t.paymentsPickDateChecked[s]?a("q-datetime",{attrs:{min:t.paymentsMinDate(s),max:t.paymentsMaxDate,format:"ddd MMM D, YYYY","stack-label":"Date",type:"date"},model:{value:t.lastBatchPayments[s].startDate,callback:function(e){t.$set(t.lastBatchPayments[s],"startDate",e)},expression:"lastBatchPayments[i].startDate"}}):a("q-select",{attrs:{"stack-label":"Payment "+(s+1)+" Date",filter:"",options:t.paymentsOpt(s)},on:{input:t.onChangePayment},model:{value:t.lastBatchPayments[s].startDate,callback:function(e){t.$set(t.lastBatchPayments[s],"startDate",e)},expression:"lastBatchPayments[i].startDate"}})],1),a("q-checkbox",{staticClass:"col-2",attrs:{"checked-icon":"calendar_today","unchecked-icon":"calendar_today"},model:{value:t.paymentsPickDateChecked[s],callback:function(e){t.$set(t.paymentsPickDateChecked,s,e)},expression:"paymentsPickDateChecked[i]"}}),a("q-input",{staticClass:"col-3 q-mb-md",attrs:{readonly:"","hide-underline":"",prefix:"P ","stack-label":"Amount",type:"number"},model:{value:t.lastBatchPayments[s].amount,callback:function(e){t.$set(t.lastBatchPayments[s],"amount",e)},expression:"lastBatchPayments[i].amount"}})],1)])}),a("q-item-separator")],2)],1)],1)],1),t.hasPhotoshoot?a("div",[a("q-card",{staticClass:"q-ma-sm",staticStyle:{width:"350px"},attrs:{inline:""}},[a("q-card-title",[a("p",{staticClass:"q-title text-weight-bold"},[t._v("Photoshoot\n\t      \t\t"),a("q-checkbox",{attrs:{label:"Edit","checked-icon":"edit","unchecked-icon":"edit"},model:{value:t.changePaymentActivity,callback:function(e){t.changePaymentActivity=e},expression:"changePaymentActivity"}})],1)]),a("q-card-main",[a("q-field",{attrs:{orientation:"vertical","label-width":"2",icon:"date_range"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[t.photoshootPickDateChecked||t.getPhotoshootActivity.datePick?a("q-datetime",{attrs:{min:t.photoshootMinDate,max:t.photoshootMaxDate,format:"ddd MMM D, YYYY",type:"date","stack-label":"Date"},model:{value:t.lastBatchPhotoshoot.startDate,callback:function(e){t.$set(t.lastBatchPhotoshoot,"startDate",e)},expression:"lastBatchPhotoshoot.startDate"}}):a("q-select",{attrs:{"stack-label":"Select Date",filter:"",options:t.photoshootOpt},model:{value:t.lastBatchPhotoshoot.startDate,callback:function(e){t.$set(t.lastBatchPhotoshoot,"startDate",e)},expression:"lastBatchPhotoshoot.startDate"}})],1),t.getPhotoshootActivity.datePick?t._e():a("q-checkbox",{staticClass:"col-2",attrs:{"checked-icon":"calendar_today","unchecked-icon":"calendar_today"},on:{input:function(t){}},model:{value:t.photoshootPickDateChecked,callback:function(e){t.photoshootPickDateChecked=e},expression:"photoshootPickDateChecked"}})],1),a("q-datetime",{attrs:{format:"h:mm A",type:"time","stack-label":"Time"},model:{value:t.photoshoot.time,callback:function(e){t.$set(t.photoshoot,"time",e)},expression:"photoshoot.time"}})],1)],1),a("q-card-separator",{attrs:{inset:""}}),a("q-card-main",[a("q-field",{attrs:{icon:"description"}},["new location"===t.lastBatchPhotoshoot.locationID?a("div",{staticClass:"q-my-md flex row"},[a("q-input",{staticClass:"col-md-8",attrs:{"float-label":"Name"},model:{value:t.newPhotoshootNameLocation,callback:function(e){t.newPhotoshootNameLocation=e},expression:"newPhotoshootNameLocation"}}),a("div",{staticClass:"q-mt-md"},[a("q-btn-group",{attrs:{rounded:""}},[a("q-btn",{attrs:{size:"sm",color:"positive",label:"Save"},on:{click:function(e){t.savePhotoshootLocation()}}}),a("q-btn",{attrs:{size:"sm",color:"negative",label:"Cancel"},on:{click:function(e){t.cancelNewPhotoshootLocation()}}})],1)],1)],1):a("q-select",{attrs:{"float-label":"Select Location",filter:"",options:t.locationTemplateOpt},on:{input:t.onChangePhotoLocation},model:{value:t.lastBatchPhotoshoot.locationID,callback:function(e){t.$set(t.lastBatchPhotoshoot,"locationID",e)},expression:"lastBatchPhotoshoot.locationID"}}),a("q-input",{attrs:{readonly:""===t.lastBatchPhotoshoot.locationID,type:"textarea","float-label":"Location","max-height":80,rows:"5"},model:{value:t.lastBatchPhotoshoot.location,callback:function(e){t.$set(t.lastBatchPhotoshoot,"location",e)},expression:"lastBatchPhotoshoot.location"}}),a("q-input",{attrs:{readonly:""===t.lastBatchPhotoshoot.locationID,type:"textarea","float-label":"Details","max-height":80,rows:"5"},model:{value:t.lastBatchPhotoshoot.details,callback:function(e){t.$set(t.lastBatchPhotoshoot,"details",e)},expression:"lastBatchPhotoshoot.details"}})],1)],1)],1)],1):t._e(),t.hasPhotoliking?a("div",[a("q-card",{staticClass:"q-ma-sm",staticStyle:{width:"350px"},attrs:{inline:""}},[a("q-card-title",[a("p",{staticClass:"q-title text-weight-bold"},[t._v("Photoliking")])]),a("q-card-main",[a("q-field",{attrs:{orientation:"vertical","label-width":"2",icon:"date_range"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[t.photolikingPickDateChecked||t.getPhotolikingActivity.datePick?a("q-datetime",{attrs:{min:t.photolikingMinDate,max:t.photolikingMaxDate,format:"ddd MMM D, YYYY",type:"date","stack-label":"Start Date"},on:{input:t.onChangePhotolikingStartDate},model:{value:t.lastBatchPhotoliking.startDate,callback:function(e){t.$set(t.lastBatchPhotoliking,"startDate",e)},expression:"lastBatchPhotoliking.startDate"}}):a("q-select",{attrs:{"stack-label":"Start Date",filter:"",options:t.photolikingOpt},on:{input:t.onChangePhotolikingStartDate},model:{value:t.lastBatchPhotoliking.startDate,callback:function(e){t.$set(t.lastBatchPhotoliking,"startDate",e)},expression:"lastBatchPhotoliking.startDate"}})],1),t.getPhotolikingActivity.datePick?t._e():a("q-checkbox",{staticClass:"col-2",attrs:{"checked-icon":"calendar_today","unchecked-icon":"calendar_today"},on:{input:function(t){}},model:{value:t.photolikingPickDateChecked,callback:function(e){t.photolikingPickDateChecked=e},expression:"photolikingPickDateChecked"}})],1),a("div",[a("q-datetime",{attrs:{min:t.photolikingMinEndDate,max:t.photolikindMaxEndDate,format:"ddd MMM D, YYYY",type:"date","stack-label":"End Date"},model:{value:t.lastBatchPhotoliking.endDate,callback:function(e){t.$set(t.lastBatchPhotoliking,"endDate",e)},expression:"lastBatchPhotoliking.endDate"}})],1)])],1)],1)],1):t._e(),t.hasWorkshops?a("div",[a("q-card",{staticClass:"q-ma-sm",staticStyle:{width:"950px"},attrs:{inline:""}},[a("q-card-title",[a("p",{staticClass:"q-title text-weight-bold"},[t._v("Workshops\n\t      \t\t"),t.hasWorkshops?a("q-checkbox",{attrs:{label:"Edit","checked-icon":"edit","unchecked-icon":"edit"},model:{value:t.changeWorkshopActivity,callback:function(e){t.changeWorkshopActivity=e},expression:"changeWorkshopActivity"}}):t._e()],1)]),a("q-card-main",t._l(t.getLastBatch.numberOfWorkshops,function(e,s){return a("div",{key:s,staticClass:"row inline flex"},[a("div",{staticClass:"q-ma-md"},[a("q-field",{attrs:{label:"Workshop "+(s+1),"label-width":"3",orientation:"vertical"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[t.getWorkshopActivity.datePick||t.workshopPickDateChecked[s]?a("q-datetime",{attrs:{disable:t.isFirstWorkshopIsNull(s),min:t.workshopsMinDate(s),max:t.workshopsMaxDate,format:"ddd MMM D, YYYY","stack-label":"Date",type:"date"},model:{value:t.lastBatchWorkshops[s].startDate,callback:function(e){t.$set(t.lastBatchWorkshops[s],"startDate",e)},expression:"lastBatchWorkshops[i].startDate"}}):a("q-select",{attrs:{disable:t.isFirstWorkshopIsNull(s),"stack-label":"Select Date",filter:"",options:t.workshopOpt(s)},model:{value:t.lastBatchWorkshops[s].startDate,callback:function(e){t.$set(t.lastBatchWorkshops[s],"startDate",e)},expression:"lastBatchWorkshops[i].startDate"}})],1),a("q-checkbox",{staticClass:"col-1 q-mt-md",attrs:{disable:t.isFirstWorkshopIsNull(s),"checked-icon":"calendar_today","unchecked-icon":"calendar_today"},on:{input:function(e){t.lastBatchWorkshops[s].startDate=""}},model:{value:t.workshopPickDateChecked[s],callback:function(e){t.$set(t.workshopPickDateChecked,s,e)},expression:"workshopPickDateChecked[i]"}})],1),a("q-datetime",{attrs:{format:"h:mm A","stack-label":"Time",type:"time"},model:{value:t.lastBatchWorkshops[s].time,callback:function(e){t.$set(t.lastBatchWorkshops[s],"time",e)},expression:"lastBatchWorkshops[i].time"}}),a("q-item-separator"),"new location"===t.lastBatchWorkshops[s].locationID?a("div",{staticClass:"q-my-md flex row"},[a("q-input",{staticClass:"col-md-8",attrs:{"float-label":"Name"},model:{value:t.newWorkshopNameLocation[s],callback:function(e){t.$set(t.newWorkshopNameLocation,s,e)},expression:"newWorkshopNameLocation[i]"}}),a("div",{staticClass:"q-mt-md"},[a("q-btn-group",{attrs:{rounded:""}},[a("q-btn",{attrs:{size:"sm",color:"positive",label:"Save"},on:{click:function(e){t.saveWorkshopLocation(s)}}}),a("q-btn",{attrs:{size:"sm",color:"negative",label:"Cancel"},on:{click:function(e){t.cancelNewWorkshopSelectLocation(s)}}})],1)],1)],1):a("q-select",{attrs:{"float-label":"Select Location",filter:"",options:t.locationTemplateOpt},on:{input:function(e){t.onChangeWorkshopLocation(s)}},model:{value:t.lastBatchWorkshops[s].locationID,callback:function(e){t.$set(t.lastBatchWorkshops[s],"locationID",e)},expression:"lastBatchWorkshops[i].locationID"}}),a("q-input",{attrs:{readonly:""===t.selectWorkshopLocation[s],type:"textarea","float-label":"Location","max-height":50,rows:"4"},model:{value:t.lastBatchWorkshops[s].location,callback:function(e){t.$set(t.lastBatchWorkshops[s],"location",e)},expression:"lastBatchWorkshops[i].location"}}),a("q-input",{attrs:{readonly:""===t.selectWorkshopLocation[s],type:"textarea","float-label":"Description","max-height":50,rows:"4"},model:{value:t.lastBatchWorkshops[s].details,callback:function(e){t.$set(t.lastBatchWorkshops[s],"details",e)},expression:"lastBatchWorkshops[i].details"}})],1)],1)])}))],1)],1):t._e(),t._l(t.getOtherActivity,function(e,s){return a("div",{key:s},[a("q-card",{staticClass:"q-ma-sm",staticStyle:{width:"350px"},attrs:{inline:""}},[a("q-card-title",[a("p",{staticClass:"q-title text-weight-bold"},[t._v(t._s(e.label))])]),a("q-card-main",[a("q-field",{attrs:{"label-width":"2",icon:"date_range"}},["detailed"===e.actType?a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[!1!==e.datePick||t.otherActivitiesPickDateChecked[s]?a("q-datetime",{attrs:{min:t.otherActivityMinStartDate(e,s),max:t.otherActivityMaxStartDate(e,s),"stack-label":"Date",format:"ddd MMM D, YYYY",type:"date"},model:{value:t.lastBatchOtherActivity[s].startDate,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"startDate",e)},expression:"lastBatchOtherActivity[i].startDate"}}):a("q-select",{attrs:{"stack-label":"Select Date",filter:"",options:t.otherActivityOpt(e,s)},model:{value:t.lastBatchOtherActivity[s].startDate,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"startDate",e)},expression:"lastBatchOtherActivity[i].startDate"}})],1),a("q-checkbox",{staticClass:"col-1 q-mt-md",attrs:{"checked-icon":"calendar_today","unchecked-icon":"calendar_today"},on:{input:function(e){t.lastBatchOtherActivity[s].startDate=""}},model:{value:t.otherActivitiesPickDateChecked[s],callback:function(e){t.$set(t.otherActivitiesPickDateChecked,s,e)},expression:"otherActivitiesPickDateChecked[i]"}})],1),a("q-datetime",{attrs:{"stack-label":"Time",format:"h:mm A",type:"time"},model:{value:t.lastBatchOtherActivity[s].time,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"time",e)},expression:"lastBatchOtherActivity[i].time"}})],1):a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[!1!==e.datePick||t.otherActivitiesPickDateChecked[s]?a("q-datetime",{attrs:{min:t.otherActivityMinStartDate(e,s),max:t.otherActivityMaxStartDate(e,s),"stack-label":"Start Date",format:"ddd MMM D, YYYY",type:"date"},on:{input:function(a){t.onChangeOtherActivityDateRange(e,s)}},model:{value:t.lastBatchOtherActivity[s].startDate,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"startDate",e)},expression:"lastBatchOtherActivity[i].startDate"}}):a("q-select",{attrs:{"stack-label":"Select Date",filter:"",options:t.otherActivityOpt(e)},on:{input:function(a){t.onChangeOtherActivityDateRange(e,s)}},model:{value:t.lastBatchOtherActivity[s].startDate,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"startDate",e)},expression:"lastBatchOtherActivity[i].startDate"}})],1),a("q-checkbox",{staticClass:"col-1 q-mt-md",attrs:{"checked-icon":"calendar_today","unchecked-icon":"calendar_today"},on:{input:function(e){t.lastBatchOtherActivity[s].startDate="",t.lastBatchOtherActivity[s].endDate=""}},model:{value:t.otherActivitiesPickDateChecked[s],callback:function(e){t.$set(t.otherActivitiesPickDateChecked,s,e)},expression:"otherActivitiesPickDateChecked[i]"}})],1),a("q-datetime",{attrs:{disable:t.isOtherActivityDateEndNull(e,s),min:t.otherActivityMinEndDate(e,s),max:t.otherActivityMaxEndDate(e,s),"stack-label":"End Date",format:"ddd MMM D, YYYY",type:"date"},model:{value:t.lastBatchOtherActivity[s].endDate,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"endDate",e)},expression:"lastBatchOtherActivity[i].endDate"}})],1)])],1),a("q-card-separator",{attrs:{inset:""}}),"detailed"===e.actType?a("q-card-main",[a("q-field",{attrs:{icon:"description"}},["new location"===t.lastBatchOtherActivity[s].locationID?a("div",{staticClass:"q-my-md flex row"},[a("q-input",{staticClass:"col-md-8",attrs:{"float-label":"Name"},model:{value:t.newOtherActivityLocation[s],callback:function(e){t.$set(t.newOtherActivityLocation,s,e)},expression:"newOtherActivityLocation[i]"}}),a("div",{staticClass:"q-mt-md"},[a("q-btn-group",{attrs:{rounded:""}},[a("q-btn",{attrs:{size:"sm",color:"positive",label:"Save"},on:{click:function(e){t.saveOtherActivityLocation(s)}}}),a("q-btn",{attrs:{size:"sm",color:"negative",label:"Cancel"},on:{click:function(e){t.cancelNewOtherActivitySelectLocation(s)}}})],1)],1)],1):a("q-select",{attrs:{separator:"","float-label":"Select Location",filter:"",options:t.locationTemplateOpt},on:{input:function(e){t.onChangeOtherActivityLocation(s)}},model:{value:t.lastBatchOtherActivity[s].locationID,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"locationID",e)},expression:"lastBatchOtherActivity[i].locationID"}}),a("q-input",{attrs:{readonly:""===t.lastBatchOtherActivity[s].locationID,type:"textarea","float-label":"Location","max-height":80,rows:"5"},model:{value:t.lastBatchOtherActivity[s].location,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"location",e)},expression:"lastBatchOtherActivity[i].location"}}),a("q-input",{attrs:{readonly:""===t.lastBatchOtherActivity[s].locationID,type:"textarea","float-label":"Details (optional)","max-height":80,rows:"5"},model:{value:t.lastBatchOtherActivity[s].details,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"details",e)},expression:"lastBatchOtherActivity[i].details"}})],1)],1):t._e()],1)],1)})],2)},S=[];P._withStripped=!0;var O={props:{eventKey:{type:String,default:""},eventCode:{type:String,default:""},seasonNumber:{type:Number,default:0},seasonEnd:{type:String,default:""},lastBatchCourse:{type:String,default:""},newBatchOrientationDate:{type:String,default:""}},created:function(){this.setCheckBoxes(),this.generateSchedules(),this.setTempLastBatchActivities()},firebase:function(){return{schedules:this.$database.ref("event_schedules").orderByChild("eventKey").equalTo(this.eventKey),course:this.$database.ref("settings/courses").orderByKey().equalTo(this.lastBatchCourse),locationTemplates:this.$database.ref("locationTemplates")}},computed:(A={getCourse:function(){return this.course[0]},plottedActivities:{get:function(){return this.$store.state.schedules.plottedActivities},set:function(t){this.$store.state.schedules.plottedActivities=t}},getOtherActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"payments"!=t.value&&"orientation"!=t.value&&"photoshoots"!=t.value&&"photoshoot"!=t.value&&"photoliking"!=t.value&&"workshop"!=t.value&&"workshops"!=t.value&&"final event"!=t.value})},photolikingOpt:function(){var t=this;if(!1===this.getPhotolikingActivity.datePick){for(var e=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.newBatchOrientationDate,seasonEnd:this.seasonEnd,daysofweek:this.getPhotolikingActivity.dayOfWeek}),a=0,s=0;s<e.length;s++){var i=$["d"].getDateDiff(e[s],this.lastBatchPhotoshoot.startDate);i<=0&&a++}var o=this.$lodash.dropRight(this.$lodash.drop(e,a));return this.$lodash.map(o,function(e){return e=new Date(e),e.setHours(0,0,0,0),{label:t.$store.getters["schedules/formatDate"](e),value:e.toString()}})}return[]},photoshootOpt:function(){var t=this,e=this.$lodash.filter(this.getCourse.activities,function(t){return"photoshoot"===t.value||"photoshoots"===t.value})[0];if(!1===e.datePick){for(var a=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.newBatchOrientationDate,seasonEnd:this.seasonEnd,daysofweek:e.dayOfWeek}),s=0,i=0;i<a.length;i++){var o=$["d"].getDateDiff(a[i],this.lastBatchPayments[0].startDate);o<=0&&s++}var n=this.$lodash.dropRight(this.$lodash.drop(a,s));return this.$lodash.map(n,function(e){return{label:t.$store.getters["schedules/formatDate"](e),value:e}})}return[]},isOnChangeOrientLocation:function(){return"new location"===this.lastBatchOrientation.locationID},locationTemplateOpt:function(){var t=new Array;return t=this.$lodash.map(this.locationTemplates,function(t){return{label:t.name,value:t[".key"]}}),t.push({label:"New Location",value:"new location",icon:"add"}),t},photolikindMaxEndDate:function(){return $["d"].subtractFromDate(new Date(this.seasonEnd),{days:1})},photolikingMinEndDate:function(){return $["d"].addToDate(new Date(this.lastBatchPhotoliking.startDate),{days:1})},photolikingMinDate:function(){return $["d"].addToDate(new Date(this.lastBatchPayments[1].startDate),{days:1})},photolikingMaxDate:function(){return $["d"].subtractFromDate(new Date(this.seasonEnd),{days:1})},photoshootMaxDate:function(){return $["d"].subtractFromDate(new Date(this.seasonEnd),{days:14})},photoshootMinDate:function(){return $["d"].addToDate(new Date(this.lastBatchPayments[0].startDate),{days:1})},paymentsMaxDate:function(){return $["d"].subtractFromDate(new Date(this.seasonEnd),{days:14})},workshopsMaxDate:function(){return $["d"].subtractFromDate(new Date(this.seasonEnd),{days:7})},payments:{get:function(){return this.$store.state.schedules.payments},set:function(t){this.$store.state.schedules.payments=t}},photoshoot:{get:function(){return this.$store.state.schedules.photoshoot},set:function(t){this.$store.state.schedules.photoshoot=t}},hasWorkshops:function(){return this.$lodash.some(this.lastBatchActivities,{type:"workshops"})},hasPhotoliking:function(){return this.$lodash.some(this.lastBatchActivities,{type:"photoliking"})},hasPhotoshoot:function(){return this.$lodash.some(this.lastBatchActivities,{type:"photoshoot"})},lastBatchFinalEvent:function(){return this.$lodash.find(this.lastBatchActivities,function(t){return"final event"===t.type})},lastBatchOtherActivity:function(){return this.$lodash.filter(this.lastBatchActivities,function(t){return"payments"!=t.type&&"orientation"!=t.type&&"photoshoots"!=t.type&&"photoshoot"!=t.type&&"photoliking"!=t.type&&"workshop"!=t.type&&"workshops"!=t.type&&"final event"!=t.type})},lastBatchWorkshops:function(){return this.hasWorkshops?this.$lodash.filter(this.lastBatchActivities,function(t){return"workshop"===t.type||"workshops"===t.type}):{}},lastBatchPhotoliking:function(){return this.hasPhotoliking?this.$lodash.find(this.lastBatchActivities,function(t){return"photoliking"===t.type}):{}},lastBatchPhotoshoot:function(){return this.hasPhotoshoot?this.$lodash.find(this.lastBatchActivities,function(t){return"photoshoot"===t.type||"photoshoots"===t.type}):{}},lastBatchPayments:function(){return this.$lodash.filter(this.lastBatchActivities,function(t){return"payments"===t.type||"payment"===t.type})},lastBatchOrientation:function(){return this.$lodash.filter(this.lastBatchActivities,function(t){return"orientation"===t.type})[0]},lastBatchActivities:function(){return this.getLastBatch.activities},getLastBatch:function(){var t=this.$lodash.maxBy(this.getSeasonBatches,function(t){return t.batchNumber});return t},getSeasonBatches:function(){var t=this,e=this.$lodash.filter(this.schedules,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===t.seasonNumber});return e},getWorkshopActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"workshops"===t.value||"workshop"===t.value})[0]},getOtherActivities:function(){return this.$lodash.remove(this.getSeasonBatches[0].activities,function(t){return"payments"!=t.type&&"orientation"!=t.type&&"photoshoots"!=t.type&&"photoshoot"!=t.type&&"photoliking"!=t.type&&"workshop"!=t.type&&"workshops"!=t.type&&"final event"!=t.type})},getOtherActivitiesDetailed:function(){return this.$lodash.filter(this.getOtherActivities,function(t){return"detailed"===t.actType})},generateNewBatchPossibleDates:function(){for(var t=this,e=this.getLastBatch.activities[0],a=(this.getLastBatch.activities,this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:e.startDate,seasonEnd:this.seasonEnd,daysofweek:"sunday"})),s=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:e.startDate,seasonEnd:this.seasonEnd,daysofweek:"saturday"}),i=this.$lodash.orderBy(a.concat(s),function(t){return new Date(t)}),o=i,n=0;n<this.getOtherActivitiesDetailed.length;n++)for(var c=0;c<i.length;c++){var r=new Date(i[c]),h=new Date(this.getOtherActivitiesDetailed[n].startDate);r.setHours(0,0,0,0),h.setHours(0,0,0,0),$["d"].isSameDate(new Date(r),new Date(h))&&o.splice(c,1)}return this.$lodash.map(o,function(e){return{label:t.$store.getters["schedules/formatDate"](e),value:e}})},getPhotoshootActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"photoshoot"===t.value||"photoshoots"===t.value})[0]},getPhotolikingActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"photoliking"===t.value})[0]}},n()(A,"getCourse",function(){return this.course[0]}),n()(A,"newBatchNumber",function(){return++this.getLastBatch.batchNumber}),n()(A,"isChangeWorkshopActivity",function(){this.changeWorkshopActivity&&this.generateWorkshopActivity()}),A),data:function(){return{newOtherActivityLocation:[],otherActivitiesPickDateChecked:[],photolikingPickDateChecked:!1,photoshootPickDateChecked:!1,paymentsPickDateChecked:[],newPhotoshootNameLocation:"",newOrientNameLocation:"",newWorkshopNameLocation:[],selectPhotoshootLocation:"",selectWorkshopLocation:[],workshopPickDateChecked:[],changePaymentActivity:!1,changeWorkshopActivity:!1,showDate:new Date,showEventTimes:!0,enableDragDrop:!0,startingDayOfWeek:0,tempLastBatchActivities:{}}},methods:{setCheckBoxes:function(){for(var t=0;t<this.getLastBatch.numberOfPayments;t++)this.paymentsPickDateChecked[t]=!1;if(this.hasPhotoshoot&&(this.photoshootPickDateChecked=!1),this.hasPhotoliking&&(this.photolikingPickDateChecked=!1),this.hasWorkshops)for(t=0;t<this.getLastBatch.numberOfWorkshops;t++)this.workshopPickDateChecked[t]=!1;for(t=0;t<this.lastBatchOtherActivity.length;t++)this.otherActivitiesPickDateChecked[t]=!1},proceedToPreview:function(){this.orientationToPreview(),this.paymentsToPreview(),this.photoshootToPreview(),this.photolikingToPreview(),this.workshopsToPreview(),this.otherActivitiesToPreview(),this.finalEventToPreview()},orientationToPreview:function(){this.lastBatchOrientation.startDate=new Date(this.$store.getters["schedules/setTime"]({date:this.newBatchOrientationDate,time:this.lastBatchOrientation.time})),this.lastBatchOrientation.endDate=new Date(this.$store.getters["schedules/setTime"]({date:this.newBatchOrientationDate,time:this.lastBatchOrientation.time}));var t=this.eventCode,e=this.getLastBatch.seasonNumber,a=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber);++a;var s=this.$lodash.find(this.getCourse.activities,function(t){return"orientation"===t.value});this.lastBatchOrientation.id="".concat(t,"(").concat(e,")_batch(").concat(a,")_").concat(s.value),this.lastBatchOrientation.title="Batch(".concat(a,")_").concat(s.label),this.plottedActivities.push(this.lastBatchOrientation)},paymentsToPreview:function(){var t=this.eventCode,e=this.getLastBatch.seasonNumber,a=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber);++a;for(var s=this.$lodash.find(this.getCourse.activities,function(t){return"payments"===t.value||"payment"===t.value}),i=0,o=0;o<this.getLastBatch.numberOfPayments;o++)this.lastBatchPayments[o].startDate=this.$store.getters["schedules/removeTime"](this.lastBatchPayments[o].startDate),this.lastBatchPayments[o].endDate=this.$store.getters["schedules/removeTime"](this.lastBatchPayments[o].startDate),this.lastBatchPayments[o].id="".concat(t,"(").concat(e,")_batch(").concat(a,")_").concat(s.value,"(").concat(++i,")"),this.lastBatchPayments[o].title="Batch(".concat(a,")_").concat(s.label,"(").concat(i,")"),this.plottedActivities.push(this.lastBatchPayments[o])},photoshootToPreview:function(){if(this.hasPhotoshoot){var t=this.eventCode,e=this.getLastBatch.seasonNumber,a=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber);++a;var s=this.$lodash.find(this.getCourse.activities,function(t){return"photoshoot"===t.value||"photoshoots"===t.value});this.lastBatchPhotoshoot.startDate=this.$store.getters["schedules/setTime2"]({date:this.lastBatchPhotoshoot.startDate,time:this.lastBatchPhotoshoot.time}),this.lastBatchPhotoshoot.endDate=this.$store.getters["schedules/setTime2"]({date:this.lastBatchPhotoshoot.startDate,time:this.lastBatchPhotoshoot.time}),this.lastBatchPhotoshoot.id="".concat(t,"(").concat(e,")_batch(").concat(a,")_").concat(s.value),this.lastBatchPhotoshoot.title="Batch(".concat(a,")_").concat(s.label),this.plottedActivities.push(this.lastBatchPhotoshoot),console.log("plottedActivities",this.plottedActivities)}},photolikingToPreview:function(){if(this.hasPhotoliking){var t=this.eventCode,e=this.getLastBatch.seasonNumber,a=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber);++a;var s=this.$lodash.find(this.getCourse.activities,function(t){return"photoliking"===t.value});this.lastBatchPhotoliking.startDate=this.$store.getters["schedules/removeTime"](this.lastBatchPhotoliking.startDate),this.lastBatchPhotoliking.endDate=this.$store.getters["schedules/removeTime"](this.lastBatchPhotoliking.endDate),this.lastBatchPhotoliking.id="".concat(t,"(").concat(e,")_batch(").concat(a,")_").concat(s.value),this.lastBatchPhotoliking.title="Batch(".concat(a,")_").concat(s.label),this.plottedActivities.push(this.lastBatchPhotoliking)}},workshopsToPreview:function(){if(this.hasWorkshops){var t=this.eventCode,e=this.getLastBatch.seasonNumber,a=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber);++a;for(var s=this.$lodash.find(this.getCourse.activities,function(t){return"workshop"===t.value||"workshops"===t.value}),i=0,o=0;o<this.getLastBatch.numberOfWorkshops;o++)this.lastBatchWorkshops[o].startDate=this.$store.getters["schedules/setTime2"]({date:this.lastBatchWorkshops[o].startDate,time:this.lastBatchWorkshops[o].time}),this.lastBatchWorkshops[o].endDate=this.$store.getters["schedules/setTime2"]({date:this.lastBatchWorkshops[o].startDate,time:this.lastBatchWorkshops[o].time}),this.lastBatchWorkshops[o].id="".concat(t,"(").concat(e,")_batch(").concat(a,")_").concat(s.value,"(").concat(++i,")"),this.lastBatchWorkshops[o].title="Batch(".concat(a,")_").concat(s.label,"(").concat(i,")"),this.plottedActivities.push(this.lastBatchWorkshops[o])}},otherActivitiesToPreview:function(){var t=this,e=this.eventCode,a=this.getLastBatch.seasonNumber,s=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber);++s;for(var i=0;i<this.lastBatchOtherActivity.length;i++)if("detailed"===this.lastBatchOtherActivity[i].actType){var o=this.$lodash.find(this.getCourse.activities,function(e){return e.value===t.lastBatchOtherActivity[i].type});this.lastBatchOtherActivity[i].startDate=this.$store.getters["schedules/setTime2"]({date:this.lastBatchOtherActivity[i].startDate,time:this.lastBatchOtherActivity[i].time}),this.lastBatchOtherActivity[i].endDate=this.$store.getters["schedules/setTime2"]({date:this.lastBatchOtherActivity[i].startDate,time:this.lastBatchOtherActivity[i].time}),this.lastBatchOtherActivity[i].id="".concat(e,"(").concat(a,")_batch(").concat(s,")_").concat(o.value),this.lastBatchOtherActivity[i].title="Batch(".concat(s,")_").concat(o.label),this.plottedActivities.push(this.lastBatchOtherActivity[i])}else{o=this.$lodash.find(this.getCourse.activities,function(e){return e.value===t.lastBatchOtherActivity[i].type});this.lastBatchOtherActivity[i].startDate=this.$store.getters["schedules/removeTime"](this.lastBatchOtherActivity[i].startDate),this.lastBatchOtherActivity[i].endDate=this.$store.getters["schedules/removeTime"](this.lastBatchOtherActivity[i].endDate),this.lastBatchOtherActivity[i].id="".concat(e,"(").concat(a,")_batch(").concat(s,")_").concat(o.value),this.lastBatchOtherActivity[i].title="Batch(".concat(s,")_").concat(o.label),this.plottedActivities.push(this.lastBatchOtherActivity[i])}},finalEventToPreview:function(){var t=this.eventCode,e=this.getLastBatch.seasonNumber,a=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber);++a;var s=this.$lodash.find(this.getCourse.activities,function(t){return"final event"===t.value});this.lastBatchFinalEvent.startDate=new Date(this.lastBatchFinalEvent.startDate),this.lastBatchFinalEvent.endDate=new Date(this.lastBatchFinalEvent.endDate),this.lastBatchFinalEvent.id="".concat(t,"(").concat(e,")_batch(").concat(a,")_").concat(s.value),this.lastBatchFinalEvent.title="Batch(".concat(a,")_").concat(s.label),this.plottedActivities.push(this.lastBatchFinalEvent)},cancelNewOtherActivitySelectLocation:function(t){var e=this.$lodash.filter(this.tempLastBatchActivities,function(t){return"payments"!=t.type&&"orientation"!=t.type&&"photoshoots"!=t.type&&"photoshoot"!=t.type&&"photoliking"!=t.type&&"workshop"!=t.type&&"workshops"!=t.type&&"final event"!=t.type});console.log(e,"tempOtherActivities"),this.lastBatchOtherActivity[t].locationID=e[t].locationID,console.log(this.lastBatchOtherActivity,"lastBatchOtherActivity")},saveOtherActivityLocation:function(t){var e=this;this.$store.dispatch("schedules/saveNewLocation",{name:this.newOtherActivityLocation[t],location:this.lastBatchOtherActivity[t].location,details:this.lastBatchOtherActivity[t].details}).then(function(a){e.lastBatchOtherActivity[t].locationID=a,e.newOtherActivityLocation[t]="",e.$forceUpdate()}).catch(function(){})},onChangeOtherActivityLocation:function(t){try{this.lastBatchOtherActivity[t].location=this.getLocation(this.lastBatchOtherActivity[t].locationID).location,this.lastBatchOtherActivity[t].details=this.getLocation(this.lastBatchOtherActivity[t].locationID).details}catch(t){}},onChangeOtherActivityDateRange:function(t,e){if("date range"===t.actType){var a=$["d"].addToDate(new Date(this.lastBatchOtherActivity[e].startDate),{days:t.duration}),s=$["d"].getDateDiff(new Date(this.otherActivityMaxEndDate(t,e)),a);if(s<=0){var i=t.duration+s;this.lastBatchOtherActivity[e].endDate=$["d"].addToDate(new Date(this.lastBatchOtherActivity[e].startDate),{days:i})}else this.lastBatchOtherActivity[e].endDate=$["d"].addToDate(new Date(this.lastBatchOtherActivity[e].startDate),{days:t.duration})}},otherActivityMaxStartDate:function(t,e){return t.actType,$["d"].subtractFromDate(new Date(this.seasonEnd),{days:6})},otherActivityMinStartDate:function(t,e){return t.actType,$["d"].addToDate(new Date(this.lastBatchPayments[2].startDate),{days:1})},otherActivityMinEndDate:function(t,e){if("date range"===t.actType)return $["d"].addToDate(new Date(this.lastBatchOtherActivity[e].startDate),{days:1})},otherActivityMaxEndDate:function(t,e){if("date range"===t.actType)return $["d"].subtractFromDate(new Date(this.seasonEnd),{days:1})},isOtherActivityDateEndNull:function(t,e){return"date range"===t.actType&&null===this.lastBatchOtherActivity[e].startDate},getOtherActivityDatesUsed:function(t,e){if(!1!==t.datePick&&"date range"!==t.actType){for(var a=[],s=this.$lodash.map(this.lastBatchOtherActivity,function(t){return t.startDate}),i=s,o=0;o<s.length;o++)o!==e&&a.push(i[o]);return a}return[]},onChangePhotolikingStartDate:function(t){var e=$["d"].addToDate(new Date(t),{days:this.getPhotolikingActivity.duration}),a=$["d"].getDateDiff(new Date(this.photolikingMaxDate),e);if(a<=0){var s=this.getPhotolikingActivity.duration+a;this.lastBatchPhotoliking.endDate=$["d"].addToDate(new Date(t),{days:s})}else this.lastBatchPhotoliking.endDate=$["d"].addToDate(new Date(t),{days:this.getPhotolikingActivity.duration});this.$forceUpdate()},onChangePhotoLocation:function(t){try{this.lastBatchPhotoshoot.location=this.getLocation(t).location,this.lastBatchPhotoshoot.details=this.getLocation(t).details}catch(t){}},savePhotoshootLocation:function(){var t=this;this.$store.dispatch("schedules/saveNewLocation",{name:this.newPhotoshootNameLocation,location:this.lastBatchPhotoshoot.location,details:this.lastBatchPhotoshoot.details}).then(function(e){t.lastBatchPhotoshoot.locationID=e,t.newPhotoshootNameLocation=""}).catch(function(){})},onChangePayment:function(t){console.log(t,"new val")},paymentsMinDate:function(t){return t>0?$["d"].addToDate(new Date(this.lastBatchPayments[t-1].startDate),{days:1}):$["d"].addToDate(new Date(this.newBatchOrientationDate),{days:1})},paymentsOpt:function(t){var e=this;if(t>=1){for(var a=this.$lodash.filter(this.getCourse.activities,function(t){return"payments"===t.value||"payment"===t.value})[0],s=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.newBatchOrientationDate,seasonEnd:this.seasonEnd,daysofweek:a.dayOfWeek}),i=0,o=s.length,n=0;n<o;n++){var c=$["d"].getDateDiff(s[n],this.lastBatchPayments[t-1].startDate);c<=0&&i++}var r=this.$lodash.drop(s,i);return this.$lodash.map(r,function(t){return t=new Date(t),t.setHours(0,0,0,0),{label:e.$store.getters["schedules/formatDate"](t),value:t.toString()}})}var h=this.$lodash.filter(this.getCourse.activities,function(t){return"payments"===t.value||"payment"===t.value})[0],l=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.newBatchOrientationDate,seasonEnd:this.seasonEnd,daysofweek:h.dayOfWeek});return this.$lodash.map(l,function(t){return t=new Date(t),t.setHours(0,0,0,0),{label:e.$store.getters["schedules/formatDate"](t),value:t.toString()}})},setTempLastBatchActivities:function(){var t=this.$lodash.maxBy(this.getSeasonBatches,function(t){return t.batchNumber});this.tempLastBatchActivities=this.$store.getters["startUp/getPlainValue"](t.activities)},cancelNewPhotoshootLocation:function(){var t=this.$lodash.find(this.tempLastBatchActivities,function(t){return"photoshoot"===t.type||"photoshoots"===t.type});this.lastBatchPhotoshoot.locationID=t.locationID},cancelNewOrientLocation:function(){var t=this.$lodash.find(this.tempLastBatchActivities,function(t){return"orientation"===t.type});this.lastBatchOrientation.locationID=t.locationID},onChangeOrientLocation:function(t){try{this.lastBatchOrientation.location=this.getLocation(t).location,this.lastBatchOrientation.details=this.getLocation(t).details}catch(t){}},saveOrientLocation:function(){var t=this;this.$store.dispatch("schedules/saveNewLocation",{name:this.newOrientNameLocation,location:this.lastBatchOrientation.location,details:this.lastBatchOrientation.details}).then(function(e){t.lastBatchOrientation.locationID=e,t.newOrientNameLocation=""}).catch(function(){})},getLocation:function(t){return this.$lodash.filter(this.locationTemplates,function(e){return e[".key"]===t})[0]},onChangeWorkshopLocation:function(t){try{this.lastBatchWorkshops[t].location=this.getLocation(this.lastBatchWorkshops[t].locationID).location,this.lastBatchWorkshops[t].details=this.getLocation(this.lastBatchWorkshops[t].locationID).details}catch(t){}},cancelNewWorkshopSelectLocation:function(t){var e=this.$lodash.filter(this.tempLastBatchActivities,function(t){return"workshop"===t.type||"workshops"===t.type});console.log(e,"tempWorkshops"),this.lastBatchWorkshops[t].locationID=e[t].locationID},saveWorkshopLocation:function(t){var e=this;this.$store.dispatch("schedules/saveNewLocation",{name:this.newWorkshopNameLocation[t],location:this.lastBatchWorkshops[t].location,details:this.lastBatchWorkshops[t].details}).then(function(a){e.lastBatchWorkshops[t].locationID=a,e.newWorkshopNameLocation[t]="",e.$forceUpdate()}).catch(function(){})},workshopsMinDate:function(t){if(t>0)return $["d"].addToDate(new Date(this.lastBatchWorkshops[t-1].startDate),{days:1});var e=this.lastBatchPayments[1].startDate?this.lastBatchPayments[1].startDate:this.lastBatchPhotoshoot.startDate;return $["d"].addToDate(new Date(e),{days:1})},otherActivityOpt:function(t,e){var a=this,s=this.$lodash.map(this.lastBatchWorkshops,function(t){return t.startDate}),i=this.$lodash.map(this.lastBatchPayments,function(t){return t.startDate});if(!1===t.datePick&&"date range"===t.actType){for(var o=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.newBatchOrientationDate,seasonEnd:this.seasonEnd,daysofweek:t.dayOfWeek}),n=0,c=0;c<o.length;c++){var r=$["d"].getDateDiff(new Date(o[c]),this.lastBatchPayments[1].startDate);r<0&&n++}var h=this.$lodash.union(i,[this.lastBatchPhotoshoot.startDate],[this.lastBatchPhotoliking.startDate],s),l=this.$lodash.drop(o,n),d=l;for(c=0;c<l.length;c++)for(var u=0;u<h.length;u++)$["d"].isSameDate(new Date(l[c]),new Date(h[u]))&&d.splice(c,1);var v=this.$lodash.map(l,function(t){var e=new Date(t);return e.setHours(0,0,0,0),{label:a.$store.getters["schedules/formatDate"](t),value:e.toString()}});return v}var f=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.newBatchOrientationDate,seasonEnd:this.seasonEnd,daysofweek:t.dayOfWeek}),p=(n=0,this.lastBatchPayments[1].startDate?this.lastBatchPayments[1].startDate:this.lastBatchPhotoliking.startDate);for(c=0;c<f.length;c++){r=$["d"].getDateDiff(new Date(f[c]),p);r<0&&n++}for(h=this.$lodash.union(i,[this.lastBatchPhotoshoot.startDate],[this.lastBatchPhotoliking.startDate],s,this.getOtherActivityDatesUsed(t,e)),l=this.$lodash.drop(f,n),d=l,c=0;c<l.length;c++)for(u=0;u<h.length;u++){var m=new Date(l[c]),y=new Date(h[u]);m.setHours(0,0,0,0),y.setHours(0,0,0,0),$["d"].isSameDate(m,y)&&d.splice(c,1)}var g=this.$lodash.map(d,function(t){return{label:a.$store.getters["schedules/formatDate"](t),value:t}});return g},workshopOpt:function(t){var e=this,a=this.lastBatchPhotoshoot.startDate?this.lastBatchPhotoshoot.startDate:this.lastBatchPayments[1].startDate,s=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:a,seasonEnd:this.seasonEnd,daysofweek:this.getWorkshopActivity.dayOfWeek});if(console.log(s,"dates"),t>=1){for(var i=0,o=s.length,n=0;n<o;n++){var c=$["d"].getDateDiff(s[n],this.lastBatchWorkshops[t-1].startDate);c<=0&&i++}var r=this.$lodash.drop(s,i),h=this.$lodash.map(r,function(t){var a=new Date(t);return a.setHours(0,0,0,0),{label:e.$store.getters["schedules/formatDate"](t),value:a.toString()}});return h}i=0,o=s.length;var l=this.lastBatchPhotoshoot.startDate||this.lastBatchPayments[2].startDate;for(n=0;n<o;n++){c=$["d"].getDateDiff(s[n],l);c<=0&&i++}r=this.$lodash.drop(s,i);var d=this.$lodash.union(this.lastBatchPhotoshoot.startDate,[this.lastBatchPhotoshoot.startDate],[this.lastBatchPhotoliking.startDate]),u=r;for(n=0;n<r.length;n++)for(var v=0;v<d.length;v++)$["d"].isSameDate(new Date(r[n]),new Date(d[v]))&&u.splice(n,1);var f=this.$lodash.map(u,function(t){var a=new Date(t);return a.setHours(0,0,0,0),{label:e.$store.getters["schedules/formatDate"](t),value:a.toString()}});return f},isFirstWorkshopIsNull:function(t){return t>0&&null===this.lastBatchWorkshops[t-1].startDate},isConflictPhotoshootWorkshop:function(){var t=$["d"].getDateDiff(this.lastBatchPhotoshoot.startDate,this.lastBatchWorkshops[0].startDate);this.changeWorkshopActivity=t>=0},generateOtherActivities:function(){this.$lodash.forEach(this.lastBatchOtherActivity,function(t){var e=new Date(t.startDate);e.setHours(0,0,0,0),t.startDate=e.toString()})},generateWorkshopActivity:function(){for(var t=0;t<this.lastBatchWorkshops.length;t++){var e=new Date(this.lastBatchWorkshops[t].startDate);e.setHours(0,0,0,0),this.lastBatchWorkshops[t].startDate=e.toString(),this.selectWorkshopLocation[t]=this.lastBatchWorkshops[t].locationIDs}this.$lodash.forEach(this.lastBatchWorkshops,function(t){var e=new Date(t.startDate);e.setHours(0,0,0,0),t.startDate=e.toString()})},generatePhotolikingActivity:function(){if(this.hasPhotoliking&&!1===this.getPhotolikingActivity.datePick){var t=this.lastBatchPayments[1].startDate?this.lastBatchPayments[1].startDate:this.lastBatchPhotoshoot.startDate,e=(t=this.lastBatchPhotoshoot.startDate?this.lastBatchPhotoshoot.startDate:this.lastBatchPayments[0].startDate,this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:t,seasonEnd:this.seasonEnd,daysofweek:this.getPhotolikingActivity.dayOfWeek}));if("undefined"!==typeof e[0]){var a=new Date(e[0]);a.setHours(0,0,0,0),this.lastBatchPhotoliking.startDate=a.toString(),this.lastBatchPhotoliking.endDate=$["d"].addToDate(new Date(e[0]),{days:this.getPhotolikingActivity.duration})}}},generatePhotoshootActivity:function(){if(!1===this.getPhotoshootActivity.datePick){var t=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.lastBatchPayments[0].startDate,seasonEnd:this.seasonEnd,daysofweek:this.getPhotoshootActivity.dayOfWeek});new Date;this.lastBatchPhotoshoot.startDate=this.$store.getters["schedules/setTime"]({date:t[0],time:this.lastBatchPhotoshoot.time}),this.lastBatchPhotoshoot.endDate=this.$store.getters["schedules/setTime"]({date:t[0],time:this.lastBatchPhotoshoot.time})}},generatePaymentsDate:function(){var t=this.$lodash.filter(this.course[0].activities,function(t){return"payments"===t.value}),e=(this.getLastBatch.activities[0],this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.newBatchOrientationDate,seasonEnd:this.seasonEnd,daysofweek:t[0].dayOfWeek})),a=1,s=new Date(e[0]);s.setHours(0,0,0,0);var i=new Date(e[2]);i.setHours(0,0,0,0),this.lastBatchPayments[0].startDate=s.toString(),this.lastBatchPayments[0].endDate=s.toString(),"undefined"!==typeof this.lastBatchPayments[1].startDate&&(this.lastBatchPayments[1].startDate=i.toString(),this.lastBatchPayments[1].endDate=i.toString(),++a);for(var o=a;o<this.lastBatchPayments.length;o++){if("undefined"===typeof e[o+1])return;console.log("dates[i+1]",e[o+1]);var n=new Date(e[o+1]);n.setHours(0,0,0,0),this.lastBatchPayments[o].startDate=n.toString(),this.lastBatchPayments[o].endDate=n.toString()}},onChangeNewBatchDate:function(t){},clickDate:function(t){},clickEvent:function(t){},dropOnDate:function(t,e){},setShowDate:function(t){this.showDate=t},generateSchedules:function(){this.generatePaymentsDate(),this.hasPhotoshoot&&(this.generatePhotoshootActivity(),this.generatePhotolikingActivity()),this.hasWorkshops&&(this.isConflictPhotoshootWorkshop(),this.generateWorkshopActivity()),this.generateOtherActivities()},test:function(){console.log(this.lastBatchOtherActivity,"lastBatchOtherActivity")}}},C=O,q=Object(D["a"])(C,P,S,!1,null,null,null),x=q.exports,N=a("vL7x");a("i7dR"),a("iO8G");var E={props:{eventKey:{type:String,default:""},eventCode:{type:String,default:""},seasonNumber:{type:Number,default:0},seasonEnd:{type:String,default:""},lastBatchCourse:{type:String,default:""}},components:{CalendarView:u.a,activities:x,preview:N["a"]},firebase:function(){return{schedules:this.$database.ref("event_schedules").orderByChild("eventKey").equalTo(this.eventKey),course:this.$database.ref("settings/courses").orderByKey().equalTo(this.lastBatchCourse),locationTemplates:this.$database.ref("locationTemplates")}},computed:{locationTemplateOpt:function(){var t=new Array;return t=this.$lodash.map(this.locationTemplates,function(t){return{label:t.name,value:t[".key"]}}),t.push({label:"New Location",value:"new location",icon:"add"}),t},workshopsMaxDate:function(){return $["d"].subtractFromDate(new Date(this.seasonEnd),{days:7})},payments:{get:function(){return this.$store.state.schedules.payments},set:function(t){this.$store.state.schedules.payments=t}},photoshoot:{get:function(){return this.$store.state.schedules.photoshoot},set:function(t){this.$store.state.schedules.photoshoot=t}},hasWorkshops:function(){return this.$lodash.some(this.lastBatchActivities,{type:"workshops"})},hasPhotoliking:function(){return this.$lodash.some(this.lastBatchActivities,{type:"photoliking"})},hasPhotoshoot:function(){return this.$lodash.some(this.lastBatchActivities,{type:"photoshoot"})},lastBatchWorkshops:function(){return this.hasWorkshops?this.$lodash.filter(this.lastBatchActivities,function(t){return"workshop"===t.type||"workshops"===t.type}):{}},lastBatchPhotoliking:function(){return this.hasPhotoliking?this.$lodash.find(this.lastBatchActivities,function(t){return"photoliking"===t.type}):{}},lastBatchPhotoshoot:function(){return this.hasPhotoshoot?this.$lodash.find(this.lastBatchActivities,function(t){return"photoshoot"===t.type||"photoshoots"===t.type}):{}},lastBatchPayments:function(){return this.$lodash.filter(this.lastBatchActivities,function(t){return"payments"===t.type||"payment"===t.type})},lastBatchActivities:function(){return this.getLastBatch.activities},getLastBatch:function(){var t=this.$lodash.maxBy(this.getSeasonBatches,function(t){return t.batchNumber});return t},getSeasonBatches:function(){var t=this,e=this.$lodash.filter(this.schedules,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===t.seasonNumber});return e},getWorkshopActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"workshops"===t.value||"workshop"===t.value})[0]},getOtherActivities:function(){return this.$lodash.filter(this.getSeasonBatches[0].activities,function(t){return"payments"!=t.type&&"orientation"!=t.type&&"photoshoots"!=t.type&&"photoshoot"!=t.type&&"photoliking"!=t.type&&"workshop"!=t.type&&"workshops"!=t.type&&"final event"!=t.type})},getOtherActivitiesDetailed:function(){return this.$lodash.filter(this.getOtherActivities,function(t){return"detailed"===t.actType})},generateNewBatchPossibleDates:function(){for(var t=this,e=this.getLastBatch.activities[0],a=(this.getLastBatch.activities,this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:e.startDate,seasonEnd:this.seasonEnd,daysofweek:"sunday"})),s=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:e.startDate,seasonEnd:this.seasonEnd,daysofweek:"saturday"}),i=this.$lodash.orderBy(a.concat(s),function(t){return new Date(t)}),o=i,n=0;n<this.getOtherActivitiesDetailed.length;n++)for(var c=0;c<i.length;c++){var r=new Date(i[c]),h=new Date(this.getOtherActivitiesDetailed[n].startDate);r.setHours(0,0,0,0),h.setHours(0,0,0,0),$["d"].isSameDate(new Date(r),new Date(h))&&o.splice(c,1)}return this.$lodash.map(o,function(e){return{label:t.$store.getters["schedules/formatDate"](e),value:e}})},getPhotoshootActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"photoshoot"===t.value||"photoshoots"===t.value})[0]},getPhotolikingActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"photoliking"===t.value})[0]},getCourse:function(){return this.course[0]},newBatchNumber:function(){return++this.getLastBatch.batchNumber},isShowWorkshopActivity:function(){this.showWorkshopActivity&&this.generateWorkshopActivity()}},data:function(){return{newWorkshopNameLocation:[],selectWorkshopLocation:[],workshopPickDateChecked:[],showWorkshopActivity:!1,newBatchOrientationDate:"",showDate:new Date,showEventTimes:!0,enableDragDrop:!0,startingDayOfWeek:0}},methods:{finishNewBatch:function(){var t=this;this.$refs.previewRef.saveNewSeasonBatchActivity().then(function(e){e&&t.$refs.stepper.reset()})},backToActivity:function(){this.$refs.stepper.previous(),this.$store.state.schedules.plottedActivities=[]},activityConfirmNext:function(){console.log(this.$refs.activityRef,"activityRef"),this.$refs.activityRef.proceedToPreview(),this.$refs.stepper.next()},getLocation:function(t){return this.$lodash.filter(this.locationTemplates,function(e){return e[".key"]===t})[0]},onChangeWorkshopLocation:function(t){try{this.lastBatchWorkshops.location[t]=this.getLocation(this.selectWorkshopLocation[t]).location,this.lastBatchWorkshops.details[t]=this.getLocation(this.selectWorkshopLocation[t]).details}catch(t){}},clearWorkshopSelectLocation:function(t){this.selectWorkshopLocation[t]="",this.$forceUpdate()},saveWorkshopLocation:function(t){var e=this;this.$store.dispatch("schedules/saveNewLocation",{name:this.newWorkshopNameLocation[t],location:this.lastBatchWorkshops[t].location,details:this.lastBatchWorkshops[t].details}).then(function(a){e.selectWorkshopLocation[t]=a,e.newWorkshopNameLocation[t]="",e.$forceUpdate()}).catch(function(){})},workshopsMinDate:function(t){if(t>0)return $["d"].addToDate(new Date(this.lastBatchWorkshops[t-1].startDate),{days:1});var e=this.lastBatchPayments[1].startDate?this.lastBatchPayments[1].startDate:this.lastBatchPhotoshoot.startDate;return $["d"].addToDate(new Date(e),{days:1})},workshopOpt:function(t){var e=this;function a(t,e){var a=e(new Date(t));return a.format("ddd MMMM DD, YYYY")}var s=this.lastBatchPayments[1].startDate?this.lastBatchPayments[1].startDate:this.lastBatchPhotoshoot.startDate,i=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:s,seasonEnd:this.seasonEnd,daysofweek:this.getWorkshopActivity.dayOfWeek});if(t>=1){for(var o=0,n=i.length,c=0;c<n;c++){var r=$["d"].getDateDiff(i[c],this.lastBatchWorkshops[t-1].startDate);r<=0&&o++}var h=this.$lodash.drop(i,o),l=this.$lodash.map(h,function(t){return{label:e.$store.getters["schedules/formatDate"](t),value:t}});return l}o=0,n=i.length;var d=this.lastBatchPayments[2].startDate?this.lastBatchPayments[2].startDate:this.lastBatchPayments[1].startDate;for(c=0;c<n;c++){r=$["d"].getDateDiff(i[c],d);r<=0&&o++}h=this.$lodash.drop(i,o);var u=this.$lodash.union(this.lastBatchPhotoshoot.startDate,[this.lastBatchPhotoshoot.startDate],[this.lastBatchPhotoliking.startDate]),v=h;for(c=0;c<h.length;c++)for(var f=0;f<u.length;f++)$["d"].isSameDate(new Date(h[c]),new Date(u[f]))&&v.splice(c,1);var p=this.$lodash.map(v,function(t){return{label:a(t,e.$moment),value:t}});return p},isFirstWorkshopIsNull:function(t){return t>0&&null===this.lastBatchWorkshops[t-1].startDate},isConflictPhotoshootWorkshop:function(){var t=$["d"].getDateDiff(this.lastBatchPhotoshoot.startDate,this.lastBatchWorkshops[0].startDate);console.log(t,"dif"),this.showWorkshopActivity=t>=0},generateWorkshopActivity:function(){console.log("lastBatchWorkshops",this.lastBatchWorkshops),console.log("lastBatchPayments",this.lastBatchPayments),!1===this.isConflictPhotoshootWorkshop||(this.showWorkshopActivity=!0)},generatePhotolikingActivity:function(){if(this.hasPhotoliking&&!1===this.getPhotolikingActivity.datePick){var t=this.lastBatchPayments[1].startDate?this.lastBatchPayments[1].startDate:this.lastBatchPhotoshoot.startDate,e=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:t,seasonEnd:this.seasonEnd,daysofweek:this.getPhotoshootActivity.dayOfWeek});"undefined"!==typeof e[0]&&(this.lastBatchPhotoliking.startDate=e[0],this.lastBatchPhotoliking.endDate=$["d"].addToDate(new Date(e[0]),{days:this.getPhotolikingActivity.duration}).toString())}},generatePhotoshootActivity:function(){if(!1===this.getPhotoshootActivity.datePick){var t=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.lastBatchPayments[0].startDate,seasonEnd:this.seasonEnd,daysofweek:this.getPhotoshootActivity.dayOfWeek});this.lastBatchPhotoshoot.startDate=t[0],this.lastBatchPhotoshoot.endDate=t[0]}},generatePaymentsDate:function(){var t=this.$lodash.filter(this.course[0].activities,function(t){return"payments"===t.value}),e=(this.getLastBatch.activities[0],this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.newBatchOrientationDate,seasonEnd:this.seasonEnd,daysofweek:t[0].dayOfWeek})),a=1;this.lastBatchPayments[0].startDate=e[0],"undefined"!==typeof this.lastBatchPayments[1].startDate&&(this.lastBatchPayments[1].startDate=e[2],a++);for(var s=a;s<this.lastBatchPayments.length;s++){if("undefined"===typeof e[s+1])return;var i=new Date(e[s+1]);i.setHours(0,0,0,0).toString(),this.lastBatchPayments[s].startDate=i,this.lastBatchPayments[s].endDate=i}},onChangeNewBatchDate:function(t){},clickDate:function(t){},clickEvent:function(t){},dropOnDate:function(t,e){},setShowDate:function(t){this.showDate=t},test:function(){console.log("getLastBatch",this.getLastBatch),this.generatePaymentsDate(),this.generatePhotoshootActivity(),this.generatePhotolikingActivity(),this.generateWorkshopActivity(),this.isConflictPhotoshootWorkshop()}}},_=E,W=(a("BfXX"),Object(D["a"])(_,B,b,!1,null,null,null)),L=W.exports,M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-ma-md"},[a("q-stepper",{ref:"stepper",attrs:{color:"secondary","alternative-labels":""}},[a("q-step",{attrs:{default:"",name:"first",title:"Activities"}},[a("div",[a("edit-activities",{ref:"activityRef2",attrs:{eventKey:t.eventKey,eventCode:t.eventCode,seasonNumber:t.seasonNumber,seasonEnd:t.seasonEnd,lastBatchCourse:t.lastBatchCourse,newBatchOrientationDate:t.newBatchOrientationDate,batchKey:t.batchKey}})],1),a("q-stepper-navigation",[a("q-page-sticky",{attrs:{position:"bottom-right",offset:[18,18]}},[a("q-btn",{attrs:{color:"secondary",label:"Continue"},on:{click:function(e){t.proceedToPreview2()}}})],1)],1)],1),a("q-step",{attrs:{name:"second",title:"Preview"}},[a("preview",{ref:"previewRef",attrs:{eventKey:t.eventKey,seasonNumber:t.seasonNumber,editBatchKey:t.batchKey,batchNumber:t.getLastBatch}}),a("q-stepper-navigation",[a("q-page-sticky",{attrs:{position:"bottom-right",offset:[18,18]}},[a("q-btn",{attrs:{color:"positive",label:"Finish"},on:{click:function(e){t.activityConfirmEditActivity()}}})],1),a("q-page-sticky",{attrs:{position:"bottom-left",offset:[18,18]}},[a("q-btn",{attrs:{color:"secondary",flat:"",label:"Back"},on:{click:function(e){t.backToActivity2()}}})],1)],1)],1)],1)],1)},T=[];M._withStripped=!0;var K=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex row inline justify-center"},[a("div",[a("q-card",{staticClass:"q-ma-sm",staticStyle:{width:"350px"},attrs:{inline:""}},[a("q-card-title",[a("p",{staticClass:"q-title text-weight-bold"},[t._v("Orientation")])]),a("q-card-main",[a("q-field",{attrs:{orientation:"vertical","label-width":"2",icon:"date_range"}},[a("div",[a("q-datetime",{attrs:{disable:"",format:"ddd MMM D, YYYY",readonly:"",type:"date","stack-label":"Date"},model:{value:t.lastBatchOrientation.startDate,callback:function(e){t.$set(t.lastBatchOrientation,"startDate",e)},expression:"lastBatchOrientation.startDate"}}),a("q-datetime",{attrs:{format:"h:mm A",type:"time","stack-label":"Time"},model:{value:t.lastBatchOrientation.time,callback:function(e){t.$set(t.lastBatchOrientation,"time",e)},expression:"lastBatchOrientation.time"}})],1)])],1),a("q-card-separator",{attrs:{inset:""}}),a("q-card-main",[a("q-field",{attrs:{icon:"description"}},["new location"===this.lastBatchOrientation.locationID?a("div",{staticClass:"q-my-md flex row"},[a("q-input",{staticClass:"col-md-8",attrs:{"float-label":"Name"},model:{value:t.newOrientNameLocation,callback:function(e){t.newOrientNameLocation=e},expression:"newOrientNameLocation"}}),a("div",{staticClass:"q-mt-md"},[a("q-btn-group",{attrs:{rounded:""}},[a("q-btn",{attrs:{size:"sm",color:"positive",label:"Save"},on:{click:function(e){t.saveOrientLocation()}}}),a("q-btn",{attrs:{size:"sm",color:"negative",label:"Cancel"},on:{click:function(e){t.cancelNewOrientLocation()}}})],1)],1)],1):a("q-select",{attrs:{separator:"","float-label":"Select Location",filter:"",options:t.locationTemplateOpt},on:{input:t.onChangeOrientLocation},model:{value:t.lastBatchOrientation.locationID,callback:function(e){t.$set(t.lastBatchOrientation,"locationID",e)},expression:"lastBatchOrientation.locationID"}}),a("q-input",{attrs:{readonly:""===t.lastBatchOrientation.locationID,type:"textarea","float-label":"Location","max-height":80,rows:"5"},model:{value:t.lastBatchOrientation.location,callback:function(e){t.$set(t.lastBatchOrientation,"location",e)},expression:"lastBatchOrientation.location"}}),a("q-input",{attrs:{readonly:""===t.lastBatchOrientation.locationID,type:"textarea","float-label":"Details (optional)","max-height":80,rows:"5"},model:{value:t.lastBatchOrientation.details,callback:function(e){t.$set(t.lastBatchOrientation,"details",e)},expression:"lastBatchOrientation.details"}})],1)],1)],1)],1),a("div",[a("q-card",{staticClass:"q-ma-sm",staticStyle:{width:"400px"},attrs:{inline:""}},[a("q-card-title",[a("p",{staticClass:"q-title text-weight-bold"},[t._v("Payment\n\t      \t\t")])]),a("q-card-main",[a("q-field",{staticClass:"q-my-md",attrs:{orientation:"vertical",icon:"attach_money",label:"Payment Amount","error-label":"Please check Total Amount"}},[t._l(t.getLastBatch.numberOfPayments,function(e,s){return a("div",{key:e,staticClass:"row inline flex"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-datetime",{attrs:{disable:"",min:t.paymentsMinDate(s),max:t.paymentsMaxDate,format:"ddd MMM D, YYYY","stack-label":"Date",type:"date"},model:{value:t.lastBatchPayments[s].startDate,callback:function(e){t.$set(t.lastBatchPayments[s],"startDate",e)},expression:"lastBatchPayments[i].startDate"}})],1),t.changePaymentActivity?a("q-checkbox",{staticClass:"col-2",attrs:{"checked-icon":"calendar_today","unchecked-icon":"calendar_today"},model:{value:t.paymentsPickDateChecked[s],callback:function(e){t.$set(t.paymentsPickDateChecked,s,e)},expression:"paymentsPickDateChecked[i]"}}):t._e(),a("q-input",{staticClass:"col-4 q-mb-md",attrs:{readonly:"","hide-underline":"",prefix:"P ","stack-label":"Amount",type:"number"},model:{value:t.lastBatchPayments[s].amount,callback:function(e){t.$set(t.lastBatchPayments[s],"amount",e)},expression:"lastBatchPayments[i].amount"}})],1)])}),a("q-item-separator")],2)],1)],1)],1),t.hasPhotoshoot?a("div",[a("q-card",{staticClass:"q-ma-sm",staticStyle:{width:"350px"},attrs:{inline:""}},[a("q-card-title",[a("p",{staticClass:"q-title text-weight-bold"},[t._v("Photoshoot\n\t      \t\t")])]),a("q-card-main",[a("q-field",{attrs:{orientation:"vertical","label-width":"2",icon:"date_range"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-datetime",{attrs:{disable:"",min:t.photoshootMinDate,max:t.photoshootMaxDate,format:"ddd MMM D, YYYY",type:"date","stack-label":"Date"},model:{value:t.lastBatchPhotoshoot.startDate,callback:function(e){t.$set(t.lastBatchPhotoshoot,"startDate",e)},expression:"lastBatchPhotoshoot.startDate"}})],1)]),a("q-datetime",{attrs:{format:"h:mm A",type:"time","stack-label":"Time"},model:{value:t.photoshoot.time,callback:function(e){t.$set(t.photoshoot,"time",e)},expression:"photoshoot.time"}})],1)],1),a("q-card-separator",{attrs:{inset:""}}),a("q-card-main",[a("q-field",{attrs:{icon:"description"}},["new location"===t.lastBatchPhotoshoot.locationID?a("div",{staticClass:"q-my-md flex row"},[a("q-input",{staticClass:"col-md-8",attrs:{"float-label":"Name"},model:{value:t.newPhotoshootNameLocation,callback:function(e){t.newPhotoshootNameLocation=e},expression:"newPhotoshootNameLocation"}}),a("div",{staticClass:"q-mt-md"},[a("q-btn-group",{attrs:{rounded:""}},[a("q-btn",{attrs:{size:"sm",color:"positive",label:"Save"},on:{click:function(e){t.savePhotoshootLocation()}}}),a("q-btn",{attrs:{size:"sm",color:"negative",label:"Cancel"},on:{click:function(e){t.cancelNewPhotoshootLocation()}}})],1)],1)],1):a("q-select",{attrs:{"float-label":"Select Location",filter:"",options:t.locationTemplateOpt},on:{input:t.onChangePhotoLocation},model:{value:t.lastBatchPhotoshoot.locationID,callback:function(e){t.$set(t.lastBatchPhotoshoot,"locationID",e)},expression:"lastBatchPhotoshoot.locationID"}}),a("q-input",{attrs:{readonly:""===t.lastBatchPhotoshoot.locationID,type:"textarea","float-label":"Location","max-height":80,rows:"5"},model:{value:t.lastBatchPhotoshoot.location,callback:function(e){t.$set(t.lastBatchPhotoshoot,"location",e)},expression:"lastBatchPhotoshoot.location"}}),a("q-input",{attrs:{readonly:""===t.lastBatchPhotoshoot.locationID,type:"textarea","float-label":"Details","max-height":80,rows:"5"},model:{value:t.lastBatchPhotoshoot.details,callback:function(e){t.$set(t.lastBatchPhotoshoot,"details",e)},expression:"lastBatchPhotoshoot.details"}})],1)],1)],1)],1):t._e(),t.hasPhotoliking?a("div",[a("q-card",{staticClass:"q-ma-sm",staticStyle:{width:"350px"},attrs:{inline:""}},[a("q-card-title",[a("p",{staticClass:"q-title text-weight-bold"},[t._v("Photoliking")])]),a("q-card-main",[a("q-field",{attrs:{orientation:"vertical","label-width":"2",icon:"date_range"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-datetime",{attrs:{disable:"",min:t.photolikingMinDate,max:t.photolikingMaxDate,format:"ddd MMM D, YYYY",type:"date","stack-label":"Start Date"},on:{input:t.onChangePhotolikingStartDate},model:{value:t.lastBatchPhotoliking.startDate,callback:function(e){t.$set(t.lastBatchPhotoliking,"startDate",e)},expression:"lastBatchPhotoliking.startDate"}})],1)]),a("div",[a("q-datetime",{attrs:{min:t.photolikingMinEndDate,max:t.photolikindMaxEndDate,format:"ddd MMM D, YYYY",type:"date","stack-label":"End Date"},model:{value:t.lastBatchPhotoliking.endDate,callback:function(e){t.$set(t.lastBatchPhotoliking,"endDate",e)},expression:"lastBatchPhotoliking.endDate"}})],1)])],1)],1)],1):t._e(),t.hasWorkshops?a("div",[a("q-card",{staticClass:"q-ma-sm",staticStyle:{width:"950px"},attrs:{inline:""}},[a("q-card-title",[a("p",{staticClass:"q-title text-weight-bold"},[t._v("Workshops\n\t      \t\t")])]),a("q-card-main",t._l(t.getLastBatch.numberOfWorkshops,function(e,s){return a("div",{key:s,staticClass:"row inline flex"},[a("div",{staticClass:"q-ma-md"},[a("q-field",{attrs:{label:"Workshop "+(s+1),"label-width":"3",orientation:"vertical"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-datetime",{attrs:{disable:"",min:t.workshopsMinDate(s),max:t.workshopsMaxDate,format:"ddd MMM D, YYYY","stack-label":"Date",type:"date"},model:{value:t.lastBatchWorkshops[s].startDate,callback:function(e){t.$set(t.lastBatchWorkshops[s],"startDate",e)},expression:"lastBatchWorkshops[i].startDate"}})],1)]),a("q-datetime",{attrs:{format:"h:mm A","stack-label":"Time",type:"time"},model:{value:t.lastBatchWorkshops[s].time,callback:function(e){t.$set(t.lastBatchWorkshops[s],"time",e)},expression:"lastBatchWorkshops[i].time"}}),a("q-item-separator"),"new location"===t.lastBatchWorkshops[s].locationID?a("div",{staticClass:"q-my-md flex row"},[a("q-input",{staticClass:"col-md-8",attrs:{"float-label":"Name"},model:{value:t.newWorkshopNameLocation[s],callback:function(e){t.$set(t.newWorkshopNameLocation,s,e)},expression:"newWorkshopNameLocation[i]"}}),a("div",{staticClass:"q-mt-md"},[a("q-btn-group",{attrs:{rounded:""}},[a("q-btn",{attrs:{size:"sm",color:"positive",label:"Save"},on:{click:function(e){t.saveWorkshopLocation(s)}}}),a("q-btn",{attrs:{size:"sm",color:"negative",label:"Cancel"},on:{click:function(e){t.cancelNewWorkshopSelectLocation(s)}}})],1)],1)],1):a("q-select",{attrs:{"float-label":"Select Location",filter:"",options:t.locationTemplateOpt},on:{input:function(e){t.onChangeWorkshopLocation(s)}},model:{value:t.lastBatchWorkshops[s].locationID,callback:function(e){t.$set(t.lastBatchWorkshops[s],"locationID",e)},expression:"lastBatchWorkshops[i].locationID"}}),a("q-input",{attrs:{readonly:""===t.selectWorkshopLocation[s],type:"textarea","float-label":"Location","max-height":50,rows:"4"},model:{value:t.lastBatchWorkshops[s].location,callback:function(e){t.$set(t.lastBatchWorkshops[s],"location",e)},expression:"lastBatchWorkshops[i].location"}}),a("q-input",{attrs:{readonly:""===t.selectWorkshopLocation[s],type:"textarea","float-label":"Description","max-height":50,rows:"4"},model:{value:t.lastBatchWorkshops[s].details,callback:function(e){t.$set(t.lastBatchWorkshops[s],"details",e)},expression:"lastBatchWorkshops[i].details"}})],1)],1)])}))],1)],1):t._e(),t._l(t.getOtherActivity,function(e,s){return a("div",{key:s},[a("q-card",{staticClass:"q-ma-sm",staticStyle:{width:"350px"},attrs:{inline:""}},[a("q-card-title",[a("p",{staticClass:"q-title text-weight-bold"},[t._v(t._s(e.label))])]),a("q-card-main",[a("q-field",{attrs:{"label-width":"2",icon:"date_range"}},["detailed"===e.actType?a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-datetime",{attrs:{disable:"",min:t.otherActivityMinStartDate(e,s),max:t.otherActivityMaxStartDate(e,s),"stack-label":"Date",format:"ddd MMM D, YYYY",type:"date"},model:{value:t.lastBatchOtherActivity[s].startDate,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"startDate",e)},expression:"lastBatchOtherActivity[i].startDate"}})],1)]),a("q-datetime",{attrs:{"stack-label":"Time",format:"h:mm A",type:"time"},model:{value:t.lastBatchOtherActivity[s].time,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"time",e)},expression:"lastBatchOtherActivity[i].time"}})],1):a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-datetime",{attrs:{disable:"",min:t.otherActivityMinStartDate(e,s),max:t.otherActivityMaxStartDate(e,s),"stack-label":"Start Date",format:"ddd MMM D, YYYY",type:"date"},on:{input:function(a){t.onChangeOtherActivityDateRange(e,s)}},model:{value:t.lastBatchOtherActivity[s].startDate,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"startDate",e)},expression:"lastBatchOtherActivity[i].startDate"}})],1)]),a("q-datetime",{attrs:{disable:t.isOtherActivityDateEndNull(e,s),min:t.otherActivityMinEndDate(e,s),max:t.otherActivityMaxEndDate(e,s),"stack-label":"End Date",format:"ddd MMM D, YYYY",type:"date"},model:{value:t.lastBatchOtherActivity[s].endDate,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"endDate",e)},expression:"lastBatchOtherActivity[i].endDate"}})],1)])],1),a("q-card-separator",{attrs:{inset:""}}),"detailed"===e.actType?a("q-card-main",[a("q-field",{attrs:{icon:"description"}},["new location"===t.lastBatchOtherActivity[s].locationID?a("div",{staticClass:"q-my-md flex row"},[a("q-input",{staticClass:"col-md-8",attrs:{"float-label":"Name"},model:{value:t.newOtherActivityLocation[s],callback:function(e){t.$set(t.newOtherActivityLocation,s,e)},expression:"newOtherActivityLocation[i]"}}),a("div",{staticClass:"q-mt-md"},[a("q-btn-group",{attrs:{rounded:""}},[a("q-btn",{attrs:{size:"sm",color:"positive",label:"Save"},on:{click:function(e){t.saveOtherActivityLocation(s)}}}),a("q-btn",{attrs:{size:"sm",color:"negative",label:"Cancel"},on:{click:function(e){t.cancelNewOtherActivitySelectLocation(s)}}})],1)],1)],1):a("q-select",{attrs:{separator:"","float-label":"Select Location",filter:"",options:t.locationTemplateOpt},on:{input:function(e){t.onChangeOtherActivityLocation(s)}},model:{value:t.lastBatchOtherActivity[s].locationID,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"locationID",e)},expression:"lastBatchOtherActivity[i].locationID"}}),a("q-input",{attrs:{readonly:""===t.lastBatchOtherActivity[s].locationID,type:"textarea","float-label":"Location","max-height":80,rows:"5"},model:{value:t.lastBatchOtherActivity[s].location,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"location",e)},expression:"lastBatchOtherActivity[i].location"}}),a("q-input",{attrs:{readonly:""===t.lastBatchOtherActivity[s].locationID,type:"textarea","float-label":"Details (optional)","max-height":80,rows:"5"},model:{value:t.lastBatchOtherActivity[s].details,callback:function(e){t.$set(t.lastBatchOtherActivity[s],"details",e)},expression:"lastBatchOtherActivity[i].details"}})],1)],1):t._e()],1)],1)})],2)},U=[];K._withStripped=!0;a("rE2o"),a("ioFf");var I,Y={props:{eventKey:{type:String,default:""},eventCode:{type:String,default:""},seasonNumber:{type:Number,default:0},seasonEnd:{type:String,default:""},lastBatchCourse:{type:String,default:""},newBatchOrientationDate:{type:String,default:""},batchKey:{type:String,default:""}},created:function(){console.log("test")},firebase:function(){return{schedules:this.$database.ref("event_schedules").orderByKey().equalTo(this.batchKey),course:this.$database.ref("settings/courses").orderByKey().equalTo(this.lastBatchCourse),locationTemplates:this.$database.ref("locationTemplates")}},watch:{batchKey:{handler:function(){this.$bindAsArray("schedules",this.$database.ref("event_schedules").orderByKey().equalTo(this.batchKey)),this.$forceUpdate()},deep:!0}},computed:(I={isFirstBatch:function(){return 1===this.schedules[0].batchNumber},getCourse:function(){return this.course[0]},plottedActivities:{get:function(){return this.$store.state.schedules.plottedActivities},set:function(t){this.$store.state.schedules.plottedActivities=t}},getOtherActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"payments"!=t.value&&"orientation"!=t.value&&"photoshoots"!=t.value&&"photoshoot"!=t.value&&"photoliking"!=t.value&&"workshop"!=t.value&&"workshops"!=t.value&&"final event"!=t.value})},photolikingOpt:function(){var t=this;if(!1===this.getPhotolikingActivity.datePick){for(var e=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.lastBatchOrientation.startDate,seasonEnd:this.seasonEnd,daysofweek:this.getPhotolikingActivity.dayOfWeek}),a=0,s=0;s<e.length;s++){var i=$["d"].getDateDiff(e[s],this.lastBatchPayments[1].startDate);i<=0&&a++}var o=this.$lodash.dropRight(this.$lodash.drop(e,a));return this.$lodash.map(o,function(e){return e=new Date(e),e.setHours(0,0,0,0),{label:t.$store.getters["schedules/formatDate"](e),value:e.toString()}})}return[]},photoshootOpt:function(){var t=this,e=this.$lodash.filter(this.getCourse.activities,function(t){return"photoshoot"===t.value||"photoshoots"===t.value})[0];if(!1===e.datePick){for(var a=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.lastBatchOrientation.startDate,seasonEnd:this.seasonEnd,daysofweek:e.dayOfWeek}),s=0,i=0;i<a.length;i++){var o=$["d"].getDateDiff(a[i],this.lastBatchPayments[0].startDate);o<=0&&s++}var n=this.$lodash.dropRight(this.$lodash.drop(a,s));return this.$lodash.map(n,function(e){return{label:t.$store.getters["schedules/formatDate"](e),value:e}})}return[]},isOnChangeOrientLocation:function(){return"new location"===this.lastBatchOrientation.locationID},locationTemplateOpt:function(){var t=new Array;return t=this.$lodash.map(this.locationTemplates,function(t){return{label:t.name,value:t[".key"]}}),t.push({label:"New Location",value:"new location",icon:"add"}),t},photolikindMaxEndDate:function(){return $["d"].subtractFromDate(new Date(this.seasonEnd),{month:1})},photolikingMinEndDate:function(){return $["d"].addToDate(new Date(this.lastBatchPhotoliking.startDate),{days:1})},photolikingMinDate:function(){return $["d"].addToDate(new Date(this.lastBatchPayments[1].startDate),{days:1})},photolikingMaxDate:function(){return $["d"].subtractFromDate(new Date(this.seasonEnd),{days:14})},photoshootMaxDate:function(){return $["d"].subtractFromDate(new Date(this.seasonEnd),{days:14})},photoshootMinDate:function(){return $["d"].addToDate(new Date(this.lastBatchPayments[0].startDate),{days:1})},paymentsMaxDate:function(){return $["d"].subtractFromDate(new Date(this.seasonEnd),{days:14})},workshopsMaxDate:function(){return $["d"].subtractFromDate(new Date(this.seasonEnd),{days:7})},payments:{get:function(){return this.$store.state.schedules.payments},set:function(t){this.$store.state.schedules.payments=t}},photoshoot:{get:function(){return this.$store.state.schedules.photoshoot},set:function(t){this.$store.state.schedules.photoshoot=t}},hasWorkshops:function(){return this.$lodash.some(this.lastBatchActivities,{type:"workshops"})},hasPhotoliking:function(){return this.$lodash.some(this.lastBatchActivities,{type:"photoliking"})},hasPhotoshoot:function(){return this.$lodash.some(this.lastBatchActivities,{type:"photoshoot"})},lastBatchFinalEvent:function(){return this.$lodash.find(this.lastBatchActivities,function(t){return"final event"===t.type})},lastBatchOtherActivity:function(){var t=this.$lodash.filter(this.lastBatchActivities,function(t){return"payments"!=t.type&&"orientation"!=t.type&&"photoshoots"!=t.type&&"photoshoot"!=t.type&&"photoliking"!=t.type&&"workshop"!=t.type&&"workshops"!=t.type&&"final event"!=t.type}),e=!0,a=!1,s=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var n=i.value;"detailed"===n.actType&&(n.startDate=this.$store.getters["schedules/removeTime"](n.startDate).toString())}}catch(t){a=!0,s=t}finally{try{e||null==o.return||o.return()}finally{if(a)throw s}}return t},lastBatchWorkshops:function(){if(this.hasWorkshops){var t=this.$lodash.filter(this.lastBatchActivities,function(t){return"workshop"===t.type||"workshops"===t.type}),e=!0,a=!1,s=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var n=i.value;n.startDate=this.$store.getters["schedules/removeTime"](n.startDate).toString()}}catch(t){a=!0,s=t}finally{try{e||null==o.return||o.return()}finally{if(a)throw s}}return t}return{}},lastBatchPhotoliking:function(){return this.hasPhotoliking?this.$lodash.find(this.lastBatchActivities,function(t){return"photoliking"===t.type}):{}},lastBatchPhotoshoot:function(){return this.hasPhotoshoot?this.$lodash.find(this.lastBatchActivities,function(t){return"photoshoot"===t.type||"photoshoots"===t.type}):{}},lastBatchPayments:function(){return this.$lodash.filter(this.lastBatchActivities,function(t){return"payments"===t.type||"payment"===t.type})},lastBatchOrientation:function(){return this.$lodash.filter(this.lastBatchActivities,function(t){return"orientation"===t.type})[0]},lastBatchActivities:function(){try{return this.schedules[0].activities}catch(t){}},getLastBatch:function(){var t=this.$lodash.maxBy(this.getSeasonBatches,function(t){return t.batchNumber});return t},getSeasonBatches:function(){var t=this,e=this.$lodash.filter(this.schedules,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===t.seasonNumber});return e},getWorkshopActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"workshops"===t.value||"workshop"===t.value})[0]},getOtherActivities:function(){return this.$lodash.filter(this.getSeasonBatches[0].activities,function(t){return"payments"!=t.type&&"orientation"!=t.type&&"photoshoots"!=t.type&&"photoshoot"!=t.type&&"photoliking"!=t.type&&"workshop"!=t.type&&"workshops"!=t.type&&"final event"!=t.type})},getOtherActivitiesDetailed:function(){return this.$lodash.filter(this.getOtherActivities,function(t){return"detailed"===t.actType})},generateNewBatchPossibleDates:function(){for(var t=this,e=this.getLastBatch.activities[0],a=(this.getLastBatch.activities,this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:e.startDate,seasonEnd:this.seasonEnd,daysofweek:"sunday"})),s=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:e.startDate,seasonEnd:this.seasonEnd,daysofweek:"saturday"}),i=this.$lodash.orderBy(a.concat(s),function(t){return new Date(t)}),o=i,n=0;n<this.getOtherActivitiesDetailed.length;n++)for(var c=0;c<i.length;c++){var r=new Date(i[c]),h=new Date(this.getOtherActivitiesDetailed[n].startDate);r.setHours(0,0,0,0),h.setHours(0,0,0,0),$["d"].isSameDate(new Date(r),new Date(h))&&o.splice(c,1)}return this.$lodash.map(o,function(e){return{label:t.$store.getters["schedules/formatDate"](e),value:e}})},getPhotoshootActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"photoshoot"===t.value||"photoshoots"===t.value})[0]},getPhotolikingActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"photoliking"===t.value})[0]}},n()(I,"getCourse",function(){return this.course[0]}),n()(I,"newBatchNumber",function(){return++this.getLastBatch.batchNumber}),n()(I,"isChangeWorkshopActivity",function(){this.changeWorkshopActivity&&this.generateWorkshopActivity()}),I),data:function(){return{schedules:[],newOtherActivityLocation:[],otherActivitiesPickDateChecked:[],photolikingPickDateChecked:!1,photoshootPickDateChecked:!1,paymentsPickDateChecked:[],newPhotoshootNameLocation:"",newOrientNameLocation:"",newWorkshopNameLocation:[],selectPhotoshootLocation:"",selectWorkshopLocation:[],workshopPickDateChecked:[],changePaymentActivity:!1,changeWorkshopActivity:!1,showDate:new Date,showEventTimes:!0,enableDragDrop:!0,startingDayOfWeek:0,tempLastBatchActivities:{}}},methods:{reset:function(){console.log("reset"),this.$bindAsArray("schedules",this.$database.ref("event_schedules").orderByKey().equalTo(this.batchKey)),this.$forceUpdate()},proceedToPreview:function(){this.orientationToPreview(),this.paymentsToPreview(),this.photoshootToPreview(),this.photolikingToPreview(),this.workshopsToPreview(),this.otherActivitiesToPreview(),this.finalEventToPreview()},orientationToPreview:function(){this.lastBatchOrientation.startDate=new Date(this.$store.getters["schedules/setTime"]({date:this.lastBatchOrientation.startDate,time:this.lastBatchOrientation.time})),this.lastBatchOrientation.endDate=new Date(this.$store.getters["schedules/setTime"]({date:this.lastBatchOrientation.startDate,time:this.lastBatchOrientation.time}));var t=this.eventCode,e=this.getLastBatch.seasonNumber,a=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber),s=this.$lodash.find(this.getCourse.activities,function(t){return"orientation"===t.value});this.lastBatchOrientation.id="".concat(t,"(").concat(e,")_batch(").concat(a,")_").concat(s.value),this.lastBatchOrientation.title="Batch(".concat(a,")_").concat(s.label),this.plottedActivities.push(this.lastBatchOrientation)},paymentsToPreview:function(){for(var t=this.eventCode,e=this.getLastBatch.seasonNumber,a=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber),s=this.$lodash.find(this.getCourse.activities,function(t){return"payments"===t.value||"payment"===t.value}),i=0,o=0;o<this.getLastBatch.numberOfPayments;o++)this.lastBatchPayments[o].startDate=this.$store.getters["schedules/removeTime"](this.lastBatchPayments[o].startDate),this.lastBatchPayments[o].endDate=this.$store.getters["schedules/removeTime"](this.lastBatchPayments[o].startDate),this.lastBatchPayments[o].id="".concat(t,"(").concat(e,")_batch(").concat(a,")_").concat(s.value,"(").concat(++i,")"),this.lastBatchPayments[o].title="Batch(".concat(a,")_").concat(s.label,"(").concat(i,")"),this.plottedActivities.push(this.lastBatchPayments[o])},photoshootToPreview:function(){if(this.hasPhotoshoot){var t=this.eventCode,e=this.getLastBatch.seasonNumber,a=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber),s=this.$lodash.find(this.getCourse.activities,function(t){return"photoshoot"===t.value||"photoshoots"===t.value});this.lastBatchPhotoshoot.startDate=this.$store.getters["schedules/setTime2"]({date:this.lastBatchPhotoshoot.startDate,time:this.lastBatchPhotoshoot.time}),this.lastBatchPhotoshoot.endDate=this.$store.getters["schedules/setTime2"]({date:this.lastBatchPhotoshoot.startDate,time:this.lastBatchPhotoshoot.time}),this.lastBatchPhotoshoot.id="".concat(t,"(").concat(e,")_batch(").concat(a,")_").concat(s.value),this.lastBatchPhotoshoot.title="Batch(".concat(a,")_").concat(s.label),this.plottedActivities.push(this.lastBatchPhotoshoot)}},photolikingToPreview:function(){if(this.hasPhotoliking){var t=this.eventCode,e=this.getLastBatch.seasonNumber,a=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber),s=this.$lodash.find(this.getCourse.activities,function(t){return"photoliking"===t.value});this.lastBatchPhotoliking.startDate=this.$store.getters["schedules/removeTime"](this.lastBatchPhotoliking.startDate),this.lastBatchPhotoliking.endDate=this.$store.getters["schedules/removeTime"](this.lastBatchPhotoliking.endDate),this.lastBatchPhotoliking.id="".concat(t,"(").concat(e,")_batch(").concat(a,")_").concat(s.value),this.lastBatchPhotoliking.title="Batch(".concat(a,")_").concat(s.label),this.plottedActivities.push(this.lastBatchPhotoliking)}},workshopsToPreview:function(){function t(t,e){var a=new Date(e).getHours(),s=new Date(e).getMinutes(),i=new Date(t);return i.setHours(a,s,0,0),i}var e=this.$store.getters["startUp/getPlainValue"](this.lastBatchWorkshops);if(this.hasWorkshops)for(var a=this.eventCode,s=this.getLastBatch.seasonNumber,i=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber),o=this.$lodash.find(this.getCourse.activities,function(t){return"workshop"===t.value||"workshops"===t.value}),n=0,c=0;c<this.getLastBatch.numberOfWorkshops;c++)e[c].startDate=this.$store.getters["schedules/setTime2"]({date:e[c].startDate,time:e[c].time}),e[c].endDate=t(e[c].startDate,e[c].time),e[c].id="".concat(a,"(").concat(s,")_batch(").concat(i,")_").concat(o.value,"(").concat(++n,")"),e[c].title="Batch(".concat(i,")_").concat(o.label,"(").concat(n,")"),this.plottedActivities.push(e[c])},otherActivitiesToPreview:function(){for(var t=this.eventCode,e=this.getLastBatch.seasonNumber,a=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber),s=this.$store.getters["startUp/getPlainValue"](this.lastBatchOtherActivity),i=0;i<this.lastBatchOtherActivity.length;i++)if("detailed"===s[i].actType){var o=this.$lodash.find(this.getCourse.activities,function(t){return t.value===s[i].type});s[i].startDate=this.$store.getters["schedules/setTime2"]({date:s[i].startDate,time:s[i].time}),s[i].endDate=this.$store.getters["schedules/setTime2"]({date:s[i].startDate,time:s[i].time}),s[i].id="".concat(t,"(").concat(e,")_batch(").concat(a,")_").concat(o.value),s[i].title="Batch(".concat(a,")_").concat(o.label),this.plottedActivities.push(s[i])}else{o=this.$lodash.find(this.getCourse.activities,function(t){return t.value===s[i].type});s[i].startDate=this.$store.getters["schedules/removeTime"](s[i].startDate),s[i].endDate=this.$store.getters["schedules/removeTime"](s[i].endDate),s[i].id="".concat(t,"(").concat(e,")_batch(").concat(a,")_").concat(o.value),s[i].title="Batch(".concat(a,")_").concat(o.label),this.plottedActivities.push(s[i])}},finalEventToPreview:function(){var t=this.eventCode,e=this.getLastBatch.seasonNumber,a=this.$store.getters["startUp/getPlainValue"](this.getLastBatch.batchNumber),s=this.$lodash.find(this.getCourse.activities,function(t){return"final event"===t.value});this.lastBatchFinalEvent.startDate=new Date(this.lastBatchFinalEvent.startDate),this.lastBatchFinalEvent.endDate=new Date(this.lastBatchFinalEvent.endDate),this.lastBatchFinalEvent.id="".concat(t,"(").concat(e,")_batch(").concat(a,")_").concat(s.value),this.lastBatchFinalEvent.title="Batch(".concat(a,")_").concat(s.label),this.plottedActivities.push(this.lastBatchFinalEvent)},cancelNewOtherActivitySelectLocation:function(t){var e=this.$lodash.filter(this.tempLastBatchActivities,function(t){return"payments"!=t.type&&"orientation"!=t.type&&"photoshoots"!=t.type&&"photoshoot"!=t.type&&"photoliking"!=t.type&&"workshop"!=t.type&&"workshops"!=t.type&&"final event"!=t.type});console.log(e,"tempOtherActivities"),this.lastBatchOtherActivity[t].locationID=e[t].locationID,console.log(this.lastBatchOtherActivity,"lastBatchOtherActivity")},saveOtherActivityLocation:function(t){var e=this;this.$store.dispatch("schedules/saveNewLocation",{name:this.newOtherActivityLocation[t],location:this.lastBatchOtherActivity[t].location,details:this.lastBatchOtherActivity[t].details}).then(function(a){e.lastBatchOtherActivity[t].locationID=a,e.newOtherActivityLocation[t]="",e.$forceUpdate()}).catch(function(){})},onChangeOtherActivityLocation:function(t){try{this.lastBatchOtherActivity[t].location=this.getLocation(this.lastBatchOtherActivity[t].locationID).location,this.lastBatchOtherActivity[t].details=this.getLocation(this.lastBatchOtherActivity[t].locationID).details}catch(t){}},onChangeOtherActivityDateRange:function(t,e){if("date range"===t.actType){var a=$["d"].addToDate(new Date(this.lastBatchOtherActivity[e].startDate),{days:t.duration}),s=$["d"].getDateDiff(new Date(this.otherActivityMaxEndDate(t,e)),a);if(s<=0){var i=t.duration+s;this.lastBatchOtherActivity[e].endDate=$["d"].addToDate(new Date(this.lastBatchOtherActivity[e].startDate),{days:i})}else this.lastBatchOtherActivity[e].endDate=$["d"].addToDate(new Date(this.lastBatchOtherActivity[e].startDate),{days:t.duration})}},otherActivityMaxStartDate:function(t,e){return t.actType,$["d"].subtractFromDate(new Date(this.seasonEnd),{days:6})},otherActivityMinStartDate:function(t,e){return t.actType,$["d"].addToDate(new Date(this.lastBatchPayments[2].startDate),{days:1})},otherActivityMinEndDate:function(t,e){if("date range"===t.actType)return $["d"].addToDate(new Date(this.lastBatchOtherActivity[e].startDate),{days:1})},otherActivityMaxEndDate:function(t,e){if("date range"===t.actType)return $["d"].subtractFromDate(new Date(this.seasonEnd),{days:1})},isOtherActivityDateEndNull:function(t,e){return"date range"===t.actType&&null===this.lastBatchOtherActivity[e].startDate},getOtherActivityDatesUsed:function(t,e){if(!1!==t.datePick&&"date range"!==t.actType){for(var a=[],s=this.$lodash.map(this.lastBatchOtherActivity,function(t){return t.startDate}),i=s,o=0;o<s.length;o++)o!==e&&a.push(i[o]);return a}return[]},onChangePhotolikingStartDate:function(t){var e=$["d"].addToDate(new Date(t),{days:this.getPhotolikingActivity.duration}),a=$["d"].getDateDiff(new Date(this.photolikingMaxDate),e);if(a<=0){var s=this.getPhotolikingActivity.duration+a;this.lastBatchPhotoliking.endDate=$["d"].addToDate(new Date(t),{days:s})}else this.lastBatchPhotoliking.endDate=$["d"].addToDate(new Date(t),{days:this.getPhotolikingActivity.duration});this.$forceUpdate()},onChangePhotoLocation:function(t){try{this.lastBatchPhotoshoot.location=this.getLocation(t).location,this.lastBatchPhotoshoot.details=this.getLocation(t).details}catch(t){}},savePhotoshootLocation:function(){var t=this;this.$store.dispatch("schedules/saveNewLocation",{name:this.newPhotoshootNameLocation,location:this.lastBatchPhotoshoot.location,details:this.lastBatchPhotoshoot.details}).then(function(e){t.lastBatchPhotoshoot.locationID=e,t.newPhotoshootNameLocation=""}).catch(function(){})},onChangePayment:function(t){console.log(t,"new val")},paymentsMinDate:function(t){return t>0?$["d"].addToDate(new Date(this.lastBatchPayments[t-1].startDate),{days:1}):$["d"].addToDate(new Date(this.lastBatchOrientation.startDate),{days:1})},paymentsOpt:function(t){var e=this;if(t>=1){for(var a=this.$lodash.filter(this.getCourse.activities,function(t){return"payments"===t.value||"payment"===t.value})[0],s=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.lastBatchOrientation.startDate,seasonEnd:this.seasonEnd,daysofweek:a.dayOfWeek}),i=0,o=s.length,n=0;n<o;n++){var c=$["d"].getDateDiff(s[n],this.lastBatchPayments[t-1].startDate);c<=0&&i++}var r=this.$lodash.drop(s,i);return this.$lodash.map(r,function(t){return t=new Date(t),t.setHours(0,0,0,0),{label:e.$store.getters["schedules/formatDate"](t),value:t.toString()}})}var h=this.$lodash.filter(this.getCourse.activities,function(t){return"payments"===t.value||"payment"===t.value})[0],l=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.lastBatchOrientation.startDate,seasonEnd:this.seasonEnd,daysofweek:h.dayOfWeek});return this.$lodash.map(l,function(t){return t=new Date(t),t.setHours(0,0,0,0),{label:e.$store.getters["schedules/formatDate"](t),value:t.toString()}})},setTempLastBatchActivities:function(){var t=this.$lodash.maxBy(this.getSeasonBatches,function(t){return t.batchNumber});this.tempLastBatchActivities=this.$store.getters["startUp/getPlainValue"](t.activities)},cancelNewPhotoshootLocation:function(){var t=this.$lodash.find(this.tempLastBatchActivities,function(t){return"photoshoot"===t.type||"photoshoots"===t.type});this.lastBatchPhotoshoot.locationID=t.locationID},cancelNewOrientLocation:function(){var t=this.$lodash.find(this.tempLastBatchActivities,function(t){return"orientation"===t.type});this.lastBatchOrientation.locationID=t.locationID},onChangeOrientLocation:function(t){try{this.lastBatchOrientation.location=this.getLocation(t).location,this.lastBatchOrientation.details=this.getLocation(t).details}catch(t){}},saveOrientLocation:function(){var t=this;this.$store.dispatch("schedules/saveNewLocation",{name:this.newOrientNameLocation,location:this.lastBatchOrientation.location,details:this.lastBatchOrientation.details}).then(function(e){t.lastBatchOrientation.locationID=e,t.newOrientNameLocation=""}).catch(function(){})},getLocation:function(t){return this.$lodash.filter(this.locationTemplates,function(e){return e[".key"]===t})[0]},onChangeWorkshopLocation:function(t){try{this.lastBatchWorkshops[t].location=this.getLocation(this.lastBatchWorkshops[t].locationID).location,this.lastBatchWorkshops[t].details=this.getLocation(this.lastBatchWorkshops[t].locationID).details}catch(t){}},cancelNewWorkshopSelectLocation:function(t){var e=this.$lodash.filter(this.tempLastBatchActivities,function(t){return"workshop"===t.type||"workshops"===t.type});console.log(e,"tempWorkshops"),this.lastBatchWorkshops[t].locationID=e[t].locationID},saveWorkshopLocation:function(t){var e=this;this.$store.dispatch("schedules/saveNewLocation",{name:this.newWorkshopNameLocation[t],location:this.lastBatchWorkshops[t].location,details:this.lastBatchWorkshops[t].details}).then(function(a){e.lastBatchWorkshops[t].locationID=a,e.newWorkshopNameLocation[t]="",e.$forceUpdate()}).catch(function(){})},workshopsMinDate:function(t){if(t>0)return $["d"].addToDate(new Date(this.lastBatchWorkshops[t-1].startDate),{days:1});var e=this.lastBatchPayments[1].startDate?this.lastBatchPayments[1].startDate:this.lastBatchPhotoshoot.startDate;return $["d"].addToDate(new Date(e),{days:1})},otherActivityOpt:function(t,e){var a=this,s=this.$lodash.map(this.lastBatchWorkshops,function(t){return t.startDate}),i=this.$lodash.map(this.lastBatchPayments,function(t){return t.startDate});if(!1===t.datePick&&"date range"===t.actType){for(var o=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.lastBatchOrientation.startDate,seasonEnd:this.seasonEnd,daysofweek:t.dayOfWeek}),n=0,c=0;c<o.length;c++){var r=$["d"].getDateDiff(new Date(o[c]),this.lastBatchPayments[1].startDate);r<0&&n++}var h=this.$lodash.union(i,[this.lastBatchPhotoshoot.startDate],[this.lastBatchPhotoliking.startDate],s),l=this.$lodash.drop(o,n),d=l;for(c=0;c<l.length;c++)for(var u=0;u<h.length;u++)$["d"].isSameDate(new Date(l[c]),new Date(h[u]))&&d.splice(c,1);var v=this.$lodash.map(l,function(t){var e=new Date(t);return e.setHours(0,0,0,0),{label:a.$store.getters["schedules/formatDate"](t),value:e.toString()}});return v}var f=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.lastBatchOrientation.startDate,seasonEnd:this.seasonEnd,daysofweek:t.dayOfWeek}),p=(n=0,this.lastBatchPayments[1].startDate?this.lastBatchPayments[1].startDate:this.lastBatchPhotoliking.startDate);for(c=0;c<f.length;c++){r=$["d"].getDateDiff(new Date(f[c]),p);r<0&&n++}for(h=this.$lodash.union(i,[this.lastBatchPhotoshoot.startDate],[this.lastBatchPhotoliking.startDate],s,this.getOtherActivityDatesUsed(t,e)),l=this.$lodash.drop(f,n),d=l,c=0;c<l.length;c++)for(u=0;u<h.length;u++){var m=new Date(l[c]),y=new Date(h[u]);m.setHours(0,0,0,0),y.setHours(0,0,0,0),$["d"].isSameDate(m,y)&&d.splice(c,1)}var g=this.$lodash.map(d,function(t){return{label:a.$store.getters["schedules/formatDate"](t),value:a.$store.getters["schedules/removeTime"](t).toString()}});return g},workshopOpt:function(t){var e=this,a=this.lastBatchPayments[1].startDate?this.lastBatchPayments[1].startDate:this.lastBatchPhotoshoot.startDate,s=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:a,seasonEnd:this.seasonEnd,daysofweek:this.getWorkshopActivity.dayOfWeek});if(t>=1){for(var i=0,o=s.length,n=0;n<o;n++){var c=$["d"].getDateDiff(s[n],this.lastBatchWorkshops[t-1].startDate);c<=0&&i++}var r=this.$lodash.drop(s,i),h=this.$lodash.map(r,function(t){return{label:e.$store.getters["schedules/formatDate"](t),value:t}});return h}i=0,o=s.length;var l=this.lastBatchPayments[2].startDate?this.lastBatchPayments[2].startDate:this.lastBatchPayments[1].startDate;for(n=0;n<o;n++){c=$["d"].getDateDiff(s[n],l);c<=0&&i++}r=this.$lodash.drop(s,i);var d=this.$lodash.union(this.lastBatchPhotoshoot.startDate,[this.lastBatchPhotoshoot.startDate],[this.lastBatchPhotoliking.startDate]),u=r;for(n=0;n<r.length;n++)for(var v=0;v<d.length;v++)$["d"].isSameDate(new Date(r[n]),new Date(d[v]))&&u.splice(n,1);var f=this.$lodash.map(u,function(t){return{label:e.$store.getters["schedules/formatDate"](t),value:t}});return f},isFirstWorkshopIsNull:function(t){return t>0&&null===this.lastBatchWorkshops[t-1].startDate},isConflictPhotoshootWorkshop:function(){var t=$["d"].getDateDiff(this.lastBatchPhotoshoot.startDate,this.lastBatchWorkshops[0].startDate);this.changeWorkshopActivity=t>=0},generateOtherActivities:function(){this.$lodash.forEach(this.lastBatchOtherActivity,function(t){var e=new Date(t.startDate);e.setHours(0,0,0,0),t.startDate=e.toString()}),console.log("lastBatchOtherActivity",this.lastBatchOtherActivity)},generateWorkshopActivity:function(){for(var t=0;t<this.lastBatchWorkshops.length;t++){var e=new Date(this.lastBatchWorkshops[t].startDate);e.setHours(0,0,0,0),this.lastBatchWorkshops[t].startDate=e.toString(),this.selectWorkshopLocation[t]=this.lastBatchWorkshops[t].locationIDs}this.$lodash.forEach(this.lastBatchWorkshops,function(t){var e=new Date(t.startDate);e.setHours(0,0,0,0),t.startDate=e.toString()})},generatePhotolikingActivity:function(){if(this.hasPhotoliking&&!1===this.getPhotolikingActivity.datePick){var t=this.lastBatchPayments[1].startDate?this.lastBatchPayments[1].startDate:this.lastBatchPhotoshoot.startDate,e=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:t,seasonEnd:this.seasonEnd,daysofweek:this.getPhotolikingActivity.dayOfWeek});if("undefined"!==typeof e[0]){var a=new Date(e[0]);a.setHours(0,0,0,0),this.lastBatchPhotoliking.startDate=a.toString(),this.lastBatchPhotoliking.endDate=$["d"].addToDate(new Date(e[0]),{days:this.getPhotolikingActivity.duration})}}},generatePhotoshootActivity:function(){if(!1===this.getPhotoshootActivity.datePick){var t=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.lastBatchPayments[0].startDate,seasonEnd:this.seasonEnd,daysofweek:this.getPhotoshootActivity.dayOfWeek});new Date;this.lastBatchPhotoshoot.startDate=this.$store.getters["schedules/setTime"]({date:t[0],time:this.lastBatchPhotoshoot.time}),this.lastBatchPhotoshoot.endDate=this.$store.getters["schedules/setTime"]({date:t[0],time:this.lastBatchPhotoshoot.time})}},generatePaymentsDate:function(){var t=this.$lodash.filter(this.course[0].activities,function(t){return"payments"===t.value}),e=(this.getLastBatch.activities[0],this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.lastBatchOrientation.startDate,seasonEnd:this.seasonEnd,daysofweek:t[0].dayOfWeek})),a=1,s=new Date(e[0]);s.setHours(0,0,0,0);var i=new Date(e[2]);i.setHours(0,0,0,0),this.lastBatchPayments[0].startDate=s.toString(),this.lastBatchPayments[0].endDate=s.toString(),"undefined"!==typeof this.lastBatchPayments[1].startDate&&(this.lastBatchPayments[1].startDate=i.toString(),this.lastBatchPayments[1].endDate=i.toString(),++a);for(var o=a;o<this.lastBatchPayments.length;o++){if("undefined"===typeof e[o+1])return;var n=new Date(e[o+1]);n.setHours(0,0,0,0),this.lastBatchPayments[o].startDate=n.toString(),this.lastBatchPayments[o].endDate=n.toString()}},onChangeNewBatchDate:function(t){},clickDate:function(t){},clickEvent:function(t){},dropOnDate:function(t,e){},setShowDate:function(t){this.showDate=t},generateSchedules:function(){this.generatePaymentsDate(),this.generatePhotoshootActivity(),this.generatePhotolikingActivity(),this.generateWorkshopActivity(),this.isConflictPhotoshootWorkshop(),this.generateOtherActivities()},test:function(){this.workshopsToPreview()}}},F=Y,V=Object(D["a"])(F,K,U,!1,null,null,null),H=V.exports,R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row flex justify-center"},[t.activityListDrawer?a("div",{staticClass:"q-mr-md",staticStyle:{width:"168px"}},[a("transition",{attrs:{appear:"","enter-active-class":"animated slideInLeft","leave-active-class":"animated slideOutLeft"}},[a("q-list",{attrs:{highlight:""}},[a("p",{staticClass:"q-title q-ma-md"},[t._v("Activities")]),t._l(t.plottedActivities,function(e,s){return a("q-item",{key:s},[a("q-item-main",[a("div",{on:{click:function(a){t.locateActivity(e)}}},[a("q-item-tile",{attrs:{label:""}},[t._v(" "+t._s(e.title))]),"detailed"===e.actType?a("div",[a("q-item-tile",{staticClass:"q-caption",attrs:{sublabel:""}},[t._v(t._s(t.$moment(e.startDate).format("ll"))+"\n\t\t\t\t\t\t\t      "+t._s(e.time?"- "+t.$moment(e.time).format("LT"):""))]),"payments"===e.type?a("q-item-tile",{attrs:{sublabel:""}},[a("b",[t._v("Amount: P"+t._s(e.amount))])]):t._e()],1):a("div",[a("q-item-tile",{staticClass:"q-caption",attrs:{sublabel:""}},[a("b",[t._v("Start Date: ")]),t._v(" "+t._s(t.$moment(e.startDate).format("ll")))]),a("q-item-tile",{staticClass:"q-caption",attrs:{sublabel:""}},[a("b",[t._v("End Date: ")]),t._v(" "+t._s(t.$moment(e.endDate).format("ll")))])],1)],1)])],1)})],2)],1)],1):t._e(),a("div",{staticClass:"col"},[a("q-btn",{attrs:{size:"sm",flat:"",icon:"calendar view day"},on:{click:function(e){t.activityListDrawer=!t.activityListDrawer}}}),a("div",{staticClass:"a"},[a("q-toggle",{attrs:{label:"All Schedules"},on:{input:t.onChangeAllSchedules},model:{value:t.allScheduleChecked,callback:function(e){t.allScheduleChecked=e},expression:"allScheduleChecked"}}),a("q-toggle",{attrs:{label:"View Batches"},on:{input:t.onChangeViewBatches},model:{value:t.viewBatchesChecked,callback:function(e){t.viewBatchesChecked=e},expression:"viewBatchesChecked"}})],1),a("calendar-view",{staticClass:"calendar theme-default holiday-us-traditional q-ma-md",attrs:{"show-date":t.showDate,events:t.localPlottedActivities,"show-event-times":t.showEventTimes,enableDragDrop:t.enableDragDrop,timeFormatOptions:{hour:"numeric",minute:"numeric",hour12:!0},startingDayOfWeek:t.startingDayOfWeek},on:{"show-date-change":t.setShowDate,"click-date":t.clickDate,"click-event":t.clickEvent,"drop-on-date":t.dropOnDate}})],1),a("q-modal",{attrs:{minimized:"","content-css":{minWidth:"60px",minHeight:"85vh"}},model:{value:t.activityModal,callback:function(e){t.activityModal=e},expression:"activityModal"}},[a("q-modal-layout",[a("q-toolbar",{attrs:{slot:"header"},slot:"header"},[a("q-btn",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],attrs:{flat:"",round:"",dense:"",icon:"keyboard_arrow_left"}}),a("q-toolbar-title",[t._v("\n\t\t        "+t._s(t.selectedActivity.title)+"\n\t\t      ")])],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("p",[t._v("Footer")])]),a("div",{staticClass:"layout-padding"},[a("q-field",{attrs:{"label-width":"2",icon:"date_range"}},[a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-select",{attrs:{"stack-label":"Select Date",filter:"",options:t.otherActivityOpt},model:{value:t.selectedActivity.startDate,callback:function(e){t.$set(t.selectedActivity,"startDate",e)},expression:"selectedActivity.startDate"}}),a("q-datetime",{attrs:{"stack-label":"Date",format:"ddd MMM D, YYYY",type:"date"},model:{value:t.selectedActivity.startDate,callback:function(e){t.$set(t.selectedActivity,"startDate",e)},expression:"selectedActivity.startDate"}})],1),a("q-checkbox",{staticClass:"col-1 q-mt-md",attrs:{"checked-icon":"calendar_today","unchecked-icon":"calendar_today"},model:{value:t.modelcheck,callback:function(e){t.modelcheck=e},expression:"modelcheck"}})],1),a("q-datetime",{attrs:{"stack-label":"Time",format:"h:mm A",type:"time"},model:{value:t.selectedActivity.time,callback:function(e){t.$set(t.selectedActivity,"time",e)},expression:"selectedActivity.time"}})],1)]),a("q-item-separator"),a("q-field",{attrs:{icon:"description"}},[a("q-select",{attrs:{separator:"","float-label":"Select Location",filter:"",options:t.locationTemplateOpt},model:{value:t.selectedActivity.location,callback:function(e){t.$set(t.selectedActivity,"location",e)},expression:"selectedActivity.location"}}),a("q-input",{attrs:{type:"textarea","float-label":"Location","max-height":80,rows:"5"},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}),a("q-input",{attrs:{type:"textarea","float-label":"Details (optional)","max-height":80,rows:"5"},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1)],1)],1)],1)},z=[];R._withStripped=!0;a("T39b"),a("VRzm"),a("ls82");var j=a("yXPU"),J=a.n(j);a("i7dR"),a("iO8G");var G={components:{CalendarView:u.a},props:{course:{type:String,default:""},discount:{type:Number,default:0},eventKey:{type:String,default:""},eventCode:{type:String,default:""},eventName:{type:String,default:""},numberOfPayments:{type:Number,default:0},numberOfWorkshops:{type:Number,default:0},seasonNumber:{type:Number,default:0},ticketCount:{type:Number,default:0},ticketPrice:{type:Number,default:0},totalAmount:{type:Number,default:0},seasonDraftKey:{type:String,default:""},editBatchKey:{type:String,default:""},batchNumber:{type:Number,default:1}},created:function(){this.localPlottedActivities=this.plottedActivities,this.setLocalPlottedAsOriginalActivity()},watch:{allScheduleChecked:function(){}},computed:{seasonBatches:function(){var t=this,e=this.$lodash.filter(this.eventSchedules,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===t.seasonNumber});return e},getFinalEventActivity:function(){return this.$store.state.schedules.finalEvent},getOrientationActivity:function(){return this.$store.state.schedules.orientation},plottedActivities:{get:function(){return this.$store.state.schedules.plottedActivities},set:function(t){this.$store.state.schedules.plottedActivities=t}},otherActivityOpt:function(){return[]},locationTemplateOpt:function(){return[]}},firebase:function(){return{eventSchedules:this.$database.ref("event_schedules")}},data:function(){return{localPlottedActivities:[],viewBatchesChecked:!1,allScheduleChecked:!1,selectedActivity:{actType:"",classes:"",details:"",endDate:"",eventKey:"",id:"",location:"",startDate:"",time:"",title:"",type:""},modelcheck:!1,model:"",activityModal:!1,activityListDrawer:!1,events:[{startDate:new Date("Sat Jan 12 2019 08:00:00"),endDate:new Date("Sat Jan 12 2019 08:00:00"),id:"test",title:"testing",classes:"salad yellow"}],checked:!1,showDate:new Date,showEventTimes:!0,enableDragDrop:!0,startingDayOfWeek:0}},methods:{onChangeViewBatches:function(){var t=J()(regeneratorRuntime.mark(function t(){var e,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=new Promise(function(t){if(a.viewBatchesChecked){var e;a.allScheduleChecked&&(a.allScheduleChecked=!1,a.onChangeAllSchedules());var s=a.$store.getters["startUp/getPlainValue"](a.localPlottedActivities),i=a.$store.getters["startUp/getPlainValue"](a.seasonBatches),o=[];a.$lodash.remove(i,function(t){return t[".key"]===a.editBatchKey}),a.$lodash.forEach(i,function(t){var e=a.$store.getters["startUp/getPlainValue"](t.activities);o.push(e)}),o.push(s);var n=l()(new Set((e=[]).concat.apply(e,o))),c=a.$lodash.map(n,function(t){var e=a.$store.getters["startUp/get2ndAfterUnderline"](t.id),s=a.$store.getters["startUp/extractNumber"](e);return t.title="Batch(".concat(s,")_").concat(a.$store.getters["startUp/get3rdAfterUnderline"](t.id)),t.startDate=new Date(t.startDate),t.endDate=new Date(t.endDate),t});a.localPlottedActivities=c}else{var r=a.$store.getters["startUp/getPlainValue"](a.localPlottedActivities);console.log("tempAct",r);for(var h=[],d=0;d<r.length;d++)r[d].originalActivity&&(r[d].startDate=new Date(r[d].startDate),r[d].endDate=new Date(r[d].endDate),h.push(r[d]));console.log("toReplacement",h),a.localPlottedActivities=[],a.localPlottedActivities=h,console.log("this.localPlottedActivities",a.localPlottedActivities)}t("done")}),t.next=3,e;case 3:t.sent;case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),setLocalPlottedAsOriginalActivity:function(){for(var t=0;t<this.localPlottedActivities.length;t++)0!==t&&(this.localPlottedActivities[t].beforeDate=this.localPlottedActivities[t-1].startDate),this.localPlottedActivities.length,this.localPlottedActivities[t].index=t,this.localPlottedActivities[t].originalActivity=!0},setShowDate:function(t){this.showDate=t},locateActivity:function(t){this.setShowDate(t.startDate)},onChangeAllSchedules:function(){var t=J()(regeneratorRuntime.mark(function t(e){var a,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=new Promise(function(t){if(s.allScheduleChecked){var e;s.allScheduleChecked&&(s.viewBatchesChecked=!1,s.onChangeViewBatches());var a=[],i=s.$store.getters["startUp/getPlainValue"](s.localPlottedActivities),o=s.$store.getters["startUp/getPlainValue"](s.eventSchedules);s.$lodash.remove(o,function(t){return t[".key"]===s.editBatchKey&&t.batchNumber===s.batchNumber}),console.log("eventSchedules",o);for(var n=0;n<o.length;n++)a.push(o[n].activities);for(n=0;n<i.length;n++)i[n].startDate=new Date(i[n].startDate),i[n].endDate=new Date(i[n].endDate);a.push(i);var c=l()(new Set((e=[]).concat.apply(e,a))),r=s.$lodash.map(c,function(t){return t.originalActivity||(t.title=t.id,t.startDate=new Date(t.startDate),t.endDate=new Date(t.endDate)),t});s.localPlottedActivities=r}else{var h=s.$store.getters["startUp/getPlainValue"](s.localPlottedActivities),d=[];for(n=0;n<h.length;n++)h[n].originalActivity&&(h[n].startDate=new Date(h[n].startDate),h[n].endDate=new Date(h[n].endDate),d.push(h[n]));s.localPlottedActivities=[],s.localPlottedActivities=d,console.log("this.localPlottedActivities",s.localPlottedActivities)}t("done")}),t.next=3,a;case 3:t.sent;case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),convertToStringDates:function(t){return this.$lodash.forEach(t,function(t){t.startDate=t.startDate.toString(),t.endDate=t.endDate.toString(),t.time=t.time.toString()}),t},saveNewSeasonBatchActivity:function(){var t=this;this.$q.dialog({title:"Confirmation",message:"Do you want to save ?",ok:"Yes",cancel:"No"}).then(function(){t.isNewBatch?t.saveNewBatch():t.saveNewSeason()}).catch(function(){})},saveEdiBatchActivity:function(){var t=this;this.$q.dialog({title:"Confirmation",message:"Do you want to save ?",ok:"Yes",cancel:"No"}).then(function(){var e=t.$lodash.find(t.eventSchedules,function(e){return e[".key"]===t.editBatchKey&&e.batchNumber===t.batchNumber}),a=l()(t.localPlottedActivities);e.activities=t.convertToStringDates(a),e.batchStart=e.activities[0].startDate,console.log("batchToUpdate",e),t.$store.dispatch("schedules/updateEditBatch",e).then(function(){t.plottedActivities=[],t.$store.state.schedules.editBatchModal=!1}).catch(function(t){})}).catch(function(){})},removeOriginalActivityField:function(){this.$lodash.forEach(this.localPlottedActivities,function(t){return delete t.originalActivity,t})},removeSeasonDraft:function(){var t=J()(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("schedules/removeSeasonDraftAfterSave",this.seasonDraftKey);case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),saveNewBatch:function(){var t=this,e=this.$store.getters["startUp/getPlainValue"](this.newBatchObject),a=l()(this.localPlottedActivities);e.activities=this.convertToStringDates(a),delete e[".key"],e.batchNumber++,e.batchStart=e.activities[0].startDate,e.dateCreated=(new Date).toString(),console.log("newBatch",e),this.$store.dispatch("schedules/saveNewBatch",e).then(function(){t.plottedActivities=[],t.$store.state.users.newBatchModal=!1}).catch(function(t){})},saveNewSeason:function(){var t=this;this.removeOriginalActivityField();var e=l()(this.localPlottedActivities),a={activities:this.convertToStringDates(e),batchNumber:1,batchStart:this.getOrientationActivity.startDate.toString(),colorCode:this.getOrientationActivity.classes,course:this.course,dateCreated:(new Date).toString(),discount:this.discount,eventKey:this.eventKey,eventCode:this.eventCode,eventName:this.eventName,numberOfPayments:this.numberOfPayments,numberOfWorkshops:this.numberOfWorkshops,seasonEnd:this.getFinalEventActivity.startDate.toString(),seasonName:"".concat(this.eventCode,"_Season").concat(this.seasonNumber),seasonNumber:this.seasonNumber,seasonStart:this.getOrientationActivity.startDate.toString(),status:"standby",ticketCount:this.ticketCount,ticketPrice:this.ticketPrice,totalAmount:this.totalAmount};console.log("newSeason",a),this.$store.dispatch("schedules/saveNewSeasonBatchActivity",a).then(function(){""!==t.seasonDraftKey&&t.removeSeasonDraft(),t.$router.push("/eventseason/".concat(t.$route.params.id,"/").concat(a.seasonNumber,"/seasonBatches"))}).catch(function(t){console.log("err")})},test:function(){},clickDate:function(t){},clickEvent:function(t){},setTime:function(t,e){var a=new Date(e).getHours(),s=new Date(e).getMinutes(),i=new Date(t);return i.setHours(a,s,0,0),i},removeTime:function(t){var e=new Date(t);return e.setHours(0,0,0,0),e},dropOnDate:function(t,e){var a=t.originalEvent;if(t.originalEvent.originalActivity){var s=this.$lodash.find(this.localPlottedActivities,function(t){return"orientation"===t.type}),i=this.$lodash.find(this.localPlottedActivities,function(t){return"final event"===t.type}),o=$["d"].getDateDiff(e,s.startDate),n=$["d"].getDateDiff(e,i.startDate);if("orientation"!=a.type&&"final event"!=a.type&&o>0&&n<0)if("detailed"===a.actType)"payments"===a.type?(a.startDate=this.removeTime(e),a.endDate=this.removeTime(e)):(a.startDate=this.setTime(e,a.time),a.endDate=this.setTime(e,a.time));else{var c=$["d"].getDateDiff(a.startDate,a.endDate);a.startDate=e,a.endDate=$["d"].addToDate(e,{days:Math.abs(c)})}}}},destroyed:function(){console.log("destryoed"),this.locateActivity=[],this.plottedActivities=[]}},X=G,Z=(a("xRJO"),Object(D["a"])(X,R,z,!1,null,null,null)),Q=Z.exports;a("i7dR"),a("iO8G");var tt={props:{batchKey:{type:String,default:""},eventKey:{type:String,default:""},eventCode:{type:String,default:""},seasonNumber:{type:Number,default:0},seasonEnd:{type:String,default:""},lastBatchCourse:{type:String,default:""}},components:{CalendarView:u.a,EditActivities:H,preview:Q},firebase:function(){return{course:this.$database.ref("settings/courses").orderByKey().equalTo(this.lastBatchCourse),locationTemplates:this.$database.ref("locationTemplates")}},computed:{locationTemplateOpt:function(){var t=new Array;return t=this.$lodash.map(this.locationTemplates,function(t){return{label:t.name,value:t[".key"]}}),t.push({label:"New Location",value:"new location",icon:"add"}),t},workshopsMaxDate:function(){return $["d"].subtractFromDate(new Date(this.seasonEnd),{days:7})},payments:{get:function(){return this.$store.state.schedules.payments},set:function(t){this.$store.state.schedules.payments=t}},photoshoot:{get:function(){return this.$store.state.schedules.photoshoot},set:function(t){this.$store.state.schedules.photoshoot=t}},hasWorkshops:function(){return this.$lodash.some(this.lastBatchActivities,{type:"workshops"})},hasPhotoliking:function(){return this.$lodash.some(this.lastBatchActivities,{type:"photoliking"})},hasPhotoshoot:function(){return this.$lodash.some(this.lastBatchActivities,{type:"photoshoot"})},lastBatchWorkshops:function(){return this.hasWorkshops?this.$lodash.filter(this.lastBatchActivities,function(t){return"workshop"===t.type||"workshops"===t.type}):{}},lastBatchPhotoliking:function(){return this.hasPhotoliking?this.$lodash.find(this.lastBatchActivities,function(t){return"photoliking"===t.type}):{}},lastBatchPhotoshoot:function(){return this.hasPhotoshoot?this.$lodash.find(this.lastBatchActivities,function(t){return"photoshoot"===t.type||"photoshoots"===t.type}):{}},lastBatchPayments:function(){return this.$lodash.filter(this.lastBatchActivities,function(t){return"payments"===t.type||"payment"===t.type})},getOrientation:function(){return this.$lodash.filter(this.lastBatchActivities,function(t){return"orientation"===t.type})},lastBatchActivities:function(){return this.schedules[0].activities},getLastBatch:function(){var t=this.$lodash.maxBy(this.getSeasonBatches,function(t){return t.batchNumber});return t},getSeasonBatches:function(){var t=this,e=this.$lodash.filter(this.schedules,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===t.seasonNumber});return e},getWorkshopActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"workshops"===t.value||"workshop"===t.value})[0]},getOtherActivities:function(){return this.$lodash.filter(this.getSeasonBatches[0].activities,function(t){return"payments"!=t.type&&"orientation"!=t.type&&"photoshoots"!=t.type&&"photoshoot"!=t.type&&"photoliking"!=t.type&&"workshop"!=t.type&&"workshops"!=t.type&&"final event"!=t.type})},getOtherActivitiesDetailed:function(){return this.$lodash.filter(this.getOtherActivities,function(t){return"detailed"===t.actType})},generateNewBatchPossibleDates:function(){for(var t=this,e=this.getLastBatch.activities[0],a=(this.getLastBatch.activities,this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:e.startDate,seasonEnd:this.seasonEnd,daysofweek:"sunday"})),s=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:e.startDate,seasonEnd:this.seasonEnd,daysofweek:"saturday"}),i=this.$lodash.orderBy(a.concat(s),function(t){return new Date(t)}),o=i,n=0;n<this.getOtherActivitiesDetailed.length;n++)for(var c=0;c<i.length;c++){var r=new Date(i[c]),h=new Date(this.getOtherActivitiesDetailed[n].startDate);r.setHours(0,0,0,0),h.setHours(0,0,0,0),$["d"].isSameDate(new Date(r),new Date(h))&&o.splice(c,1)}return this.$lodash.map(o,function(e){return{label:t.$store.getters["schedules/formatDate"](e),value:e}})},getPhotoshootActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"photoshoot"===t.value||"photoshoots"===t.value})[0]},getPhotolikingActivity:function(){return this.$lodash.filter(this.getCourse.activities,function(t){return"photoliking"===t.value})[0]},getCourse:function(){return this.course[0]},newBatchNumber:function(){return++this.getLastBatch.batchNumber},isShowWorkshopActivity:function(){this.showWorkshopActivity&&this.generateWorkshopActivity()}},data:function(){return{newWorkshopNameLocation:[],selectWorkshopLocation:[],workshopPickDateChecked:[],showWorkshopActivity:!1,newBatchOrientationDate:"",showDate:new Date,showEventTimes:!0,enableDragDrop:!0,startingDayOfWeek:0}},methods:{backToActivity2:function(){this.$refs.stepper.previous()},proceedToPreview2:function(){this.$refs.stepper.next(),this.$refs.activityRef2.proceedToPreview()},finishNewBatch:function(){console.log("finishNewBatch"),this.$refs.previewRef.saveNewSeasonBatchActivity().then(function(t){console.log(t,"result")})},backToActivity:function(){this.$refs.stepper.previous(),this.$store.state.schedules.plottedActivities=[]},activityConfirmEditActivity:function(){this.$refs.previewRef.saveEdiBatchActivity()},getLocation:function(t){return this.$lodash.filter(this.locationTemplates,function(e){return e[".key"]===t})[0]},onChangeWorkshopLocation:function(t){try{this.lastBatchWorkshops.location[t]=this.getLocation(this.selectWorkshopLocation[t]).location,this.lastBatchWorkshops.details[t]=this.getLocation(this.selectWorkshopLocation[t]).details}catch(t){}},clearWorkshopSelectLocation:function(t){this.selectWorkshopLocation[t]="",this.$forceUpdate()},saveWorkshopLocation:function(t){var e=this;this.$store.dispatch("schedules/saveNewLocation",{name:this.newWorkshopNameLocation[t],location:this.lastBatchWorkshops[t].location,details:this.lastBatchWorkshops[t].details}).then(function(a){e.selectWorkshopLocation[t]=a,e.newWorkshopNameLocation[t]="",e.$forceUpdate()}).catch(function(){})},workshopsMinDate:function(t){if(t>0)return $["d"].addToDate(new Date(this.lastBatchWorkshops[t-1].startDate),{days:1});var e=this.lastBatchPayments[1].startDate?this.lastBatchPayments[1].startDate:this.lastBatchPhotoshoot.startDate;return $["d"].addToDate(new Date(e),{days:1})},workshopOpt:function(t){var e=this;function a(t,e){var a=e(new Date(t));return a.format("ddd MMMM DD, YYYY")}var s=this.lastBatchPayments[1].startDate?this.lastBatchPayments[1].startDate:this.lastBatchPhotoshoot.startDate,i=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:s,seasonEnd:this.seasonEnd,daysofweek:this.getWorkshopActivity.dayOfWeek});if(t>=1){for(var o=0,n=i.length,c=0;c<n;c++){var r=$["d"].getDateDiff(i[c],this.lastBatchWorkshops[t-1].startDate);r<=0&&o++}var h=this.$lodash.drop(i,o),l=this.$lodash.map(h,function(t){return{label:e.$store.getters["schedules/formatDate"](t),value:t}});return l}o=0,n=i.length;var d=this.lastBatchPayments[2].startDate?this.lastBatchPayments[2].startDate:this.lastBatchPayments[1].startDate;for(c=0;c<n;c++){r=$["d"].getDateDiff(i[c],d);r<=0&&o++}h=this.$lodash.drop(i,o);var u=this.$lodash.union(this.lastBatchPhotoshoot.startDate,[this.lastBatchPhotoshoot.startDate],[this.lastBatchPhotoliking.startDate]),v=h;for(c=0;c<h.length;c++)for(var f=0;f<u.length;f++)$["d"].isSameDate(new Date(h[c]),new Date(u[f]))&&v.splice(c,1);var p=this.$lodash.map(v,function(t){return{label:a(t,e.$moment),value:t}});return p},isFirstWorkshopIsNull:function(t){return t>0&&null===this.lastBatchWorkshops[t-1].startDate},isConflictPhotoshootWorkshop:function(){var t=$["d"].getDateDiff(this.lastBatchPhotoshoot.startDate,this.lastBatchWorkshops[0].startDate);console.log(t,"dif"),this.showWorkshopActivity=t>=0},generateWorkshopActivity:function(){console.log("lastBatchWorkshops",this.lastBatchWorkshops),console.log("lastBatchPayments",this.lastBatchPayments),!1===this.isConflictPhotoshootWorkshop||(this.showWorkshopActivity=!0)},generatePhotolikingActivity:function(){if(this.hasPhotoliking&&!1===this.getPhotolikingActivity.datePick){var t=this.lastBatchPayments[1].startDate?this.lastBatchPayments[1].startDate:this.lastBatchPhotoshoot.startDate,e=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:t,seasonEnd:this.seasonEnd,daysofweek:this.getPhotoshootActivity.dayOfWeek});"undefined"!==typeof e[0]&&(this.lastBatchPhotoliking.startDate=e[0],this.lastBatchPhotoliking.endDate=$["d"].addToDate(new Date(e[0]),{days:this.getPhotolikingActivity.duration}).toString())}},generatePhotoshootActivity:function(){if(!1===this.getPhotoshootActivity.datePick){var t=this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.lastBatchPayments[0].startDate,seasonEnd:this.seasonEnd,daysofweek:this.getPhotoshootActivity.dayOfWeek});this.lastBatchPhotoshoot.startDate=t[0],this.lastBatchPhotoshoot.endDate=t[0]}},generatePaymentsDate:function(){var t=this.$lodash.filter(this.course[0].activities,function(t){return"payments"===t.value}),e=(this.getLastBatch.activities[0],this.$store.getters["schedules/getDatesOfWeek"]({seasonStart:this.newBatchOrientationDate,seasonEnd:this.seasonEnd,daysofweek:t[0].dayOfWeek})),a=1;this.lastBatchPayments[0].startDate=e[0],"undefined"!==typeof this.lastBatchPayments[1].startDate&&(this.lastBatchPayments[1].startDate=e[2],a++);for(var s=a;s<this.lastBatchPayments.length;s++){if("undefined"===typeof e[s+1])return;var i=new Date(e[s+1]);i.setHours(0,0,0,0).toString(),this.lastBatchPayments[s].startDate=i,this.lastBatchPayments[s].endDate=i}},onChangeNewBatchDate:function(t){},clickDate:function(t){},clickEvent:function(t){},dropOnDate:function(t,e){},setShowDate:function(t){this.showDate=t},test:function(){console.log(this.lastBatchPayments,"lastBatchPayments")}}},et=tt,at=(a("+zHP"),Object(D["a"])(et,M,T,!1,null,null,null)),st=at.exports,it=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex row justify-center"},[a("div",[a("q-btn",{attrs:{label:"test"},on:{click:t.test}}),a("q-card",{staticClass:"q-ma-sm",staticStyle:{width:"350px"},attrs:{inline:""}},[a("q-card-title",[a("p",{staticClass:"q-title text-weight-bold"},[t._v("Final Event")])]),a("q-card-main",[a("q-field",{attrs:{orientation:"vertical","label-width":"2",icon:"date_range"}},[a("div",[a("q-datetime",{attrs:{min:t.getfinalEventStartDate,format:"ddd MMM D, YYYY",type:"date","stack-label":"Date"},model:{value:t.finalEvent.startDate,callback:function(e){t.$set(t.finalEvent,"startDate",e)},expression:"finalEvent.startDate"}}),a("q-datetime",{attrs:{format:"h:mm A",type:"time","stack-label":"Time"},model:{value:t.finalEvent.time,callback:function(e){t.$set(t.finalEvent,"time",e)},expression:"finalEvent.time"}})],1)])],1),a("q-card-separator",{attrs:{inset:""}}),a("q-card-main",[a("q-field",{attrs:{icon:"description"}},["new location"===t.finalEvent.locationID?a("div",{staticClass:"q-my-md flex row"},[a("q-input",{staticClass:"col-md-8",attrs:{"float-label":"Name"},model:{value:t.newOrientNameLocation,callback:function(e){t.newOrientNameLocation=e},expression:"newOrientNameLocation"}}),a("div",{staticClass:"q-mt-md"},[a("q-btn-group",{attrs:{rounded:""}},[a("q-btn",{attrs:{size:"sm",color:"positive",label:"Save"},on:{click:function(e){t.saveFinalEventLocation()}}}),a("q-btn",{attrs:{size:"sm",color:"negative",label:"Cancel"},on:{click:function(e){t.cancelNewFinalEventLocation()}}})],1)],1)],1):a("q-select",{attrs:{separator:"","float-label":"Select Location",filter:"",options:t.locationTemplateOpt},on:{input:t.onChangeOrientLocation},model:{value:t.finalEvent.locationID,callback:function(e){t.$set(t.finalEvent,"locationID",e)},expression:"finalEvent.locationID"}}),a("q-input",{attrs:{readonly:""===t.finalEvent.locationID,type:"textarea","float-label":"Location","max-height":80,rows:"5"},model:{value:t.finalEvent.location,callback:function(e){t.$set(t.finalEvent,"location",e)},expression:"finalEvent.location"}}),a("q-input",{attrs:{readonly:""===t.finalEvent.locationID,type:"textarea","float-label":"Details (optional)","max-height":80,rows:"5"},model:{value:t.finalEvent.details,callback:function(e){t.$set(t.finalEvent,"details",e)},expression:"finalEvent.details"}})],1)],1),a("q-btn",{staticClass:"full-width",attrs:{label:"save",color:"positive"},on:{click:function(e){t.saveFinalEventLocation()}}})],1)],1)])},ot=[];it._withStripped=!0;var nt,ct={props:{eventKey:{type:String,default:""},seasonNumber:{type:Number,default:""}},created:function(){this.tempFinalActivity=this.$store.getters["startUp/getPlainValue"](this.finalEvent)},firebase:function(){return{event:this.$database.ref("event_schedules").orderByChild("eventKey").equalTo(this.eventKey),locationTemplates:this.$database.ref("locationTemplates")}},computed:{locationTemplateOpt:function(){var t=new Array;return t=this.$lodash.map(this.locationTemplates,function(t){return{label:t.name,value:t[".key"]}}),t.push({label:"New Location",value:"new location",icon:"add"}),t},finalEvent:function(){return this.$lodash.find(this.event[0].activities,function(t){return"final event"===t.type})},getfinalEventStartDate:function(){return this.event[0].seasonEnd}},data:function(){return{finalStartDate:"",tempFinalActivity:{}}},methods:{getLocation:function(t){return this.$lodash.filter(this.locationTemplates,function(e){return e[".key"]===t})[0]},saveFinalEventLocation:function(){console.log(this.finalEvent,"finalEvent")},cancelNewFinalEventLocation:function(){},onChangeOrientLocation:function(){this.finalEvent.location=this.getLocation(this.finalEvent.locationID).location,this.finalEvent.details=this.getLocation(this.finalEvent.locationID).details},saveFinalActivity:function(){},test:function(){console.log(this.finalEvent,"finalEvent")}}},rt=ct,ht=Object(D["a"])(rt,it,ot,!1,null,null,null),lt=ht.exports,dt={created:function(){this.eventKey=this.$route.params.id,this.viewMode="batchMode",this.seasonNumber=this.$route.params.seasonNumber,this.$store.state.users.isNewSeasonActivities&&(this.editMode=!0,this.setShowDate(new Date(this.$store.state.users.newSeasonActivities[0].startDate)))},mounted:function(){this.$bindAsArray("schedules2",this.$database.ref("event_schedules")),this.$bindAsArray("event",this.$database.ref("event_schedules").orderByChild("eventKey").equalTo(this.eventKey)),this.$store.state.startUp.schedules=this.schedules2},components:{CalendarView:u.a,CalendarAgenda:v["b"],EventBatchViewComponent:w,newBatchModal:L,editBatchModal:st,editFinalActivity:lt},watch:{isCalendarView:{handler:function(t,e){if(t){for(var a=[],s=0;s<this.getSeasonBatches.length;s++)for(var i=0;i<this.getSeasonBatches[s].activities.length;i++)a.push(this.getSeasonBatches[s].activities[i]);for(var o=0;o<a.length;o++)a[o].startDate=new Date(a[o].startDate),a[o].endDate=new Date(a[o].endDate),a[o].dueDate=a[o].dueDate?new Date(a[o].dueDate):"",a[o].time=a[o].time?new Date(a[o].time):"";this.$store.state.users.newSeasonActivities=a,this.setShowDate(new Date(a[0].startDate)),this.generateBatchNodes()}else this.$store.state.users.newSeasonActivities=[],this.$store.state.users.batchNode=[]},deep:!0},isAgendaView:{handler:function(t,e){if(t){var a=this.getSeasonBatchesActivities;console.log("activities",a);var s=this.$lodash.map(a,function(t){if("payment"!==t.type)return{id:t.id,summary:t.title,description:t.details?t.details:"",location:t.location?t.location:"",start:{dateTime:new Date(t.startDate).toISOString()},end:{dateTime:new Date(t.endDate).toISOString()},color:"faded"}});this.agendaActivities=this.$lodash.compact(s),this.setShowDate(new Date(a[0].startDate))}else this.agendaActivities=[]},deep:!0},viewAllBatches:function(){if(console.log("watching viewall",this.viewAllBatches),this.viewAllBatches){console.log("batches",this.getSeasonBatches),console.log("newSeasonActivities",this.$store.state.users.newSeasonActivities);for(var t=this.getSeasonBatches,e=l()(this.$store.state.users.newSeasonActivities),a=0;a<t.length;a++)for(var s=0;s<t[a].activities.length;s++)t[a].activities[s].startDate=new Date(t[a].activities[s].startDate),t[a].activities[s].endDate=new Date(t[a].activities[s].endDate),t[a].activities[s].dueDate=t[a].activities[s].dueDate?new Date(t[a].activities[s].dueDate):"",t[a].activities[s].time=t[a].activities[s].time?new Date(t[a].activities[s].time):"",e.push(t[a].activities[s]);console.log("newSeasonAct",e),this.$store.state.users.seeAllBatch=e}else this.$store.state.users.seeAllBatch=[]},isNewSeasonActivities:function(){this.isNewSeasonActivities&&(this.viewMode="calendarMode")}},computed:(nt={getFinalActivity:function(){},editBatchOpt:function(){var t=this.$lodash.map(this.getBatches,function(t){return{label:"Batch ".concat(t.batchNumber),value:t[".key"]}});return t.push({label:"Final Event",value:"final event"}),t},editBatchModal:{get:function(){return this.$store.state.schedules.editBatchModal},set:function(t){this.$store.state.schedules.editBatchModal=t}},getEventCode:function(){try{return this.$store.getters["startUp/getEvent"](this.eventKey).eventCode}catch(t){}},isCanAddAnotherBatch:function(){var t=this;if(this.is4BatchMax){for(var e=this.$lodash.filter(this.getLastBatch.activities,function(t){return"payment"===t.type})[2],a=this.$lodash.filter(this.getLastBatch.activities,function(e){return e.type===t.getOtherActivities[0].label})[0],s=this.$store.getters["startUp/getUpcomingWeekEnds"]({startDate:new Date(e.startDate),weekEnd:"sundays"}),i=new Array,o=0;o<s.length;o++){var n=this.$mathMixin.dayDiff(new Date(e.startDate),new Date(s[o]));n>0&&i.push(s[o])}i.splice(0,this.getWorkshopActivity.length);var c=new Array;for(o=0;o<i.length;o++){var r=this.$mathMixin.dayDiff(new Date(a.startDate),new Date(i[o]));r<0&&c.push(i[o])}return c.length>=this.getWorkshopActivity.length&&(c.length%this.getWorkshopActivity.length===0?(console.log("can add another 4 batch",c.length%this.getWorkshopActivity.length),!0):(console.log("bawal na mag add ng 4 batch"),!1))}return!0},getOtherActivities:function(){for(var t=[],e=l()(this.getCourse.activities),a=0;a<e.length;a++)"orientation"!==e[a].value&&"payment"!==e[a].value&&"photoshoot"!==e[a].value&&"photoliking"!==e[a].value&&"workshop"!==e[a].value&&e[a].value!==this.getFinalActivity.value&&t.push(e[a]);return t}},n()(nt,"getFinalActivity",function(){try{var t=this.getCourse.activities[this.getCourse.activities.length-1];return t}catch(t){return{}}}),n()(nt,"getCourse",function(){var t=this,e=this.$lodash.filter(this.$store.state.startUp.courses,function(e){return e[".key"]===t.getLastBatch.course});return e[0]}),n()(nt,"getLastBatch",function(){var t=this.$lodash.maxBy(this.getSeasonBatches,function(t){return t.batchNumber});return t}),n()(nt,"otherActivities",function(){for(var t=[],e=l()(this.course.activities),a=0;a<e.length;a++)"orientation"!==e[a].value&&"payment"!==e[a].value&&"photoshoot"!==e[a].value&&"photoliking"!==e[a].value&&"workshop"!==e[a].value&&e[a].value!==this.getFinalActivity.value&&t.push(e[a]);for(var s=0;s<t.length;s++)this.otherActivity.value.push(t[s].value),this.otherActivity.label.push(t[s].label);return this.otherActivities2=t,t}),n()(nt,"getSeasonBatchesActivities",function(){for(var t=this.getSeasonBatches,e=new Array,a=0;a<t.length;a++)for(var s=0;s<t[a].activities.length;s++)e.push(t[a].activities[s]);return e}),n()(nt,"seasonBatchContractSigned",function(){var t=this,e=this.$lodash.filter(this.contractSigned,function(e){var a=parseInt(e.seasonName.match(/\d+/g)[0]);return e.eventKey===t.eventKey&&a===parseInt(t.seasonNumber)});return e}),n()(nt,"contractSigned",{get:function(){return this.$store.state.startUp.contractSigned},set:function(t){this.$store.state.startUp.contractSigned=t}}),n()(nt,"switchCalendarEvent",function(){return this.viewAllBatches?this.$store.state.users.seeAllBatch:this.$store.state.users.newSeasonActivities}),n()(nt,"isWorkshopIsAhead",function(){if(!this.$store.state.users.isNewSeasonActivities){this.batch0=r()({},this.getSeasonBatches[0]);for(var t=this.$store.getters["startUp/getPlainValue"](this.getSeasonBatches[0]),e=this.getSeasonBatches.length,a=0;a<t.activities.length;a++)t.activities[a].startDate=t.activities[a].startDate.toString(),t.activities[a].endDate=t.activities[a].endDate.toString();++e;var s=this.$lodash.findIndex(t.activities,function(t){return"orientation"===t.type});t.activities[s].startDate=new Date(this.newBatchStartDate),t.activities[s].endDate=new Date(this.newBatchStartDate),t.activities[s].startDate.setHours(0,0,0,0),t.activities[s].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_orientation"),t.activities[s].title="Batch(".concat(e,")_orientation");for(var i=this.$store.getters["users/convertToDays"]({dateType:this.getPaymentCourseActivity.dayAfter.dateType,dateNumber:this.getPaymentCourseActivity.dayAfter.dateNumber}),o=this.$lodash.filter(t.activities,function(t){return"payment"===t.type}),n=0;n<o.length;n++)0===n?(o[n].startDate=this.$mathMixin.addDays(new Date(this.newBatchStartDate),3),o[n].endDate=this.$mathMixin.addDays(new Date(this.newBatchStartDate),3),o[n].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_payment(").concat(n+1,")"),o[n].title="Batch(".concat(e,")_payment(").concat(n+1,")")):(o[n].startDate=this.$mathMixin.addDays(new Date(o[n-1].startDate),i),o[n].endDate=this.$mathMixin.addDays(new Date(o[n-1].startDate),i),o[n].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_payment(").concat(n+1,")"),o[n].title="Batch(".concat(e,")_payment(").concat(n+1,")"));var c=this.$store.getters["users/convertToDays"]({dateType:this.getPhotoshootCourseActivity.dayAfter.dateType,dateNumber:this.getPhotoshootCourseActivity.dayAfter.dateNumber}),h=this.$lodash.findIndex(t.activities,function(t){return"photoshoot"===t.type});t.activities[h].startDate=this.$mathMixin.addDays(new Date(o[0].startDate),c),t.activities[h].endDate=this.$mathMixin.addDays(new Date(o[0].startDate),c),t.activities[h].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_photoshoot"),t.activities[h].title="Batch(".concat(e,")_photoshoot");this.$store.getters["users/convertToDays"]({dateType:this.getPhotolikingCourseActivity.dayAfter.dateType,dateNumber:this.getPhotolikingCourseActivity.dayAfter.dateNumber});var l=this.$lodash.findIndex(t.activities,function(t){return"photoliking"===t.type});t.activities[l].startDate=this.$mathMixin.addDays(new Date(o[1].startDate),c),t.activities[l].endDate=this.$mathMixin.addDays(new Date(o[1].startDate),14),t.activities[l].dueDate=this.$mathMixin.addDays(new Date(o[1].startDate),14),t.activities[l].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_photoliking"),t.activities[l].title="Batch(".concat(e,")_photoliking");for(var d=0,u=0;u<t.activities.length;u++)"orientation"!==t.activities[u].type&&"payment"!==t.activities[u].type&&"photoshoot"!==t.activities[u].type&&"photoliking"!==t.activities[u].type&&(t.activities[u].startDate=new Date(t.activities[u].startDate),t.activities[u].endDate=new Date(t.activities[u].endDate),t.activities[u].time=t.activities[u].time?new Date(t.activities[u].time):"",t.activities[u].dueDate=t.activities[u].dueDate?new Date(t.activities[u].dueDate):"",t.activities[u].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_").concat(t.activities[u].type),t.activities[u].title="Batch(".concat(e,")_").concat(t.activities[u].type),"workshop"===t.activities[u].type&&(d++,console.log("found workshop",d),t.activities[u].startDate=new Date(t.activities[u].startDate),t.activities[u].endDate=new Date(t.activities[u].endDate),t.activities[u].time=new Date(t.activities[u].startDate),t.activities[u].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_").concat(t.activities[u].type,"(").concat(d,")"),t.activities[u].title="Batch(".concat(e,")_").concat(t.activities[u].type,"(").concat(d,")")));for(var v=new Array,f=0;f<o.length;f++)f<=3&&v.push(o[f]);var p=v[v.length-1],m=this.$lodash.filter(t.activities,function(t){return"workshop"===t.type});if(0===m.length)return!1;var y=this.$mathMixin.dayDiff(new Date(p.startDate),new Date(m[0].startDate));return this.generatedBatchActivities=r()({},t),y>0?(console.log("ahead pa ung workshop"),!1):(console.log("di na ahead ung workshop"),!0)}}),n()(nt,"getSeasonStatus",function(){try{return this.$store.getters["startUp/getSeason"]({eventKey:this.eventKey,seasonNumber:this.seasonNumber}).status}catch(t){}}),n()(nt,"batchNodeActivityModal",{get:function(){return this.$store.state.users.batchNodeActivityModal},set:function(t){this.$store.state.users.batchNodeActivityModal=t}}),n()(nt,"parseDetails",function(){return this.$store.getters["startUp/parseDetails"]}),n()(nt,"parseLocations",function(){return this.$store.getters["startUp/parseLocations2"]}),n()(nt,"upcomingSundays",function(){try{var t=this.$store.getters["users/getLastOf3Payment"](this.generatedBatchActivities.activities);return this.$store.getters["startUp/getUpcomingSundays2"](t.startDate)}catch(t){return[]}}),n()(nt,"batchNode",{get:function(){return this.$store.state.users.batchesNode},set:function(t){this.$store.state.users.batchesNode=t}}),n()(nt,"viewMode",{get:function(){return this.$store.state.users.viewMode},set:function(t){this.$store.state.users.viewMode=t}}),n()(nt,"isCalendarView",function(){return"calendarMode"===this.viewMode}),n()(nt,"isAgendaView",function(){return"agendaMode"===this.viewMode}),n()(nt,"mergeBatches",function(){for(var t=[],e=0;e<this.getSeasonBatches.length;e++)for(var a=0;a<this.getSeasonBatches[e].activities.length;a++)t.push(this.getSeasonBatches[e].activities[e]);for(var s=0;s<t.length;s++)t[s].startDate=new Date(t[s].startDate),t[s].endDate=new Date(t[s].endDate);console.log("merge batches to calendar",t),this.$store.state.users.newSeasonActivities=t}),n()(nt,"getBatchNewOrientation",function(){return this.$store.state.users.newSeasonActivities[0]}),n()(nt,"activityModal",{get:function(){return this.$store.state.users.activityModal2},set:function(t){this.$store.state.users.activityModal2=t}}),n()(nt,"activity",{get:function(){return this.$store.state.users.activity},set:function(t){return this.$store.state.users.activity=t}}),n()(nt,"showRight",{get:function(){return this.$store.state.users.showRight},set:function(t){return this.$store.state.users.showRight=t}}),n()(nt,"is4BatchMax",function(){return this.getSeasonBatches.length%4===0?(this.generateWorkshopScheds(),console.log("found modulo of 4"),!0):(console.log("is not 4 batch max"),!1)}),n()(nt,"getWorkshopActivity",function(){try{console.log("getWorkshopActivity",this.getSeasonBatches);var t=this.getSeasonBatches.length,e=r()({},this.getSeasonBatches[t-1]),a=this.$lodash.filter(e.activities,function(t){return"workshop"===t.type}),s=Object.assign([],a);console.log("worksho",s);for(var i=0;i<s.length;i++)s[i].newStartDate="";return s}catch(t){return[]}}),n()(nt,"course",function(){return this.$store.getters["startUp/getCourse"](this.getSeasonBatches[0].course)}),n()(nt,"getWorkshop",function(){try{var t=this.$lodash.findIndex(this.course.activities,function(t){return"workshop"===t.value});return this.course.activities[t]}catch(t){return{}}}),n()(nt,"getSeasonEnd",function(){try{return this.getSeasonBatches[0].seasonEnd}catch(t){return""}}),n()(nt,"getEventName",function(){try{return this.$store.getters["startUp/getEvent"](this.eventKey).eventName}catch(t){return""}}),n()(nt,"getBatchFinalEvent",function(){try{var t=this.getSeasonBatches[0].activities.length-1;return this.getSeasonBatches[0].activities[t]}catch(t){return""}}),n()(nt,"getLastBatchOrientation",function(){try{return this.$mathMixin.addDays(new Date(this.getSeasonBatches[this.getSeasonBatches.length-1].activities[0].startDate),1).toString()}catch(t){return""}}),n()(nt,"newBatchModal",{get:function(){return this.$store.state.users.newBatchModal},set:function(t){this.$store.state.users.newBatchModal=t}}),n()(nt,"getColumnsActivities",function(){for(var t=[],e=0,a=0,s=0;s<this.getSeasonBatches[0].activities.length;s++){var i={};"payment"===this.getSeasonBatches[0].activities[s].type.toLowerCase()?(e++,i[this.getSeasonBatches[0].activities[s].type+e]={startDate:this.getSeasonBatches[0].activities[s].startDate,endDate:this.getSeasonBatches[0].activities[s].endDate,dueDate:this.getSeasonBatches[0].activities[s].dueDate,location:this.getSeasonBatches[0].activities[s].location,time:this.getSeasonBatches[0].activities[s].time,amount:this.getSeasonBatches[0].activities[s].amount,type:this.getSeasonBatches[0].activities[s].type,name:this.getSeasonBatches[0].activities[s].id,classes:this.getSeasonBatches[0].activities[s].classes,title:this.getSeasonBatches[0].activities[s].title}):"workshop"===this.getSeasonBatches[0].activities[s].type.toLowerCase()?(a++,i[this.getSeasonBatches[0].activities[s].type+a]={startDate:this.getSeasonBatches[0].activities[s].startDate,endDate:this.getSeasonBatches[0].activities[s].endDate,dueDate:this.getSeasonBatches[0].activities[s].dueDate,location:this.getSeasonBatches[0].activities[s].location,time:this.getSeasonBatches[0].activities[s].time,amount:this.getSeasonBatches[0].activities[s].amount,type:this.getSeasonBatches[0].activities[s].type,name:this.getSeasonBatches[0].activities[s].id,classes:this.getSeasonBatches[0].activities[s].classes,title:this.getSeasonBatches[0].activities[s].title}):i[this.getSeasonBatches[0].activities[s].type.toLowerCase()]={startDate:this.getSeasonBatches[0].activities[s].startDate,endDate:this.getSeasonBatches[0].activities[s].endDate,dueDate:this.getSeasonBatches[0].activities[s].dueDate,location:this.getSeasonBatches[0].activities[s].location,time:this.getSeasonBatches[0].activities[s].time,amount:this.getSeasonBatches[0].activities[s].amount,type:this.getSeasonBatches[0].activities[s].type,name:this.getSeasonBatches[0].activities[s].id,classes:this.getSeasonBatches[0].activities[s].classes,title:this.getSeasonBatches[0].activities[s].title},t.push(i)}return t}),n()(nt,"customColumns",function(){var t=this;try{var e=0,a=0,s=this.$lodash.map(this.getSeasonBatches[0].activities,function(s){return"payment"===s.type?(e++,{align:"center",label:t.$store.getters["settings/titleCase"]("".concat(s.type," ").concat(e)),name:"".concat(s.type.toLowerCase()).concat(e),field:"".concat(s.type.toLowerCase()).concat(e),type:s.type,required:!0}):"workshop"===s.type?(a++,{align:"center",label:t.$store.getters["settings/titleCase"]("".concat(s.type," ").concat(a)),name:"".concat(s.type.toLowerCase()).concat(a),field:"".concat(s.type.toLowerCase()).concat(a),type:s.type,required:!0}):{align:"center",label:t.$store.getters["settings/titleCase"](s.type),name:s.type.toLowerCase(),type:s.type,field:"".concat(s.type.toLowerCase()),required:!0}});s.splice(0,0,{align:"center",label:"Batch",name:"batch",required:!0}),e=0,a=0,s=l()(s);var i={align:"center",label:"No. of Signed Models",name:"signedModels",style:"width: 500px"},o={align:"center",label:"Action",name:"action"};return s.push(i),s.push(o),s}catch(t){return[]}}),n()(nt,"customBatches",function(){for(var t=[],e=0,a=0,s=[],i=0;i<this.getSeasonBatches.length;i++){for(var o=0;o<this.getSeasonBatches[i].activities.length;o++){var n={};if("payment"===this.getSeasonBatches[i].activities[o].type.toLowerCase()){e++;var c=this.$moment(this.getSeasonBatches[i].activities[o].startDate).format("ll");n[this.getSeasonBatches[i].activities[o].type+e]=c}else if("workshop"===this.getSeasonBatches[i].activities[o].type.toLowerCase()){a++;c=this.$moment(this.getSeasonBatches[i].activities[o].startDate).format("ll");n[this.getSeasonBatches[i].activities[o].type+a]=c}else{c=this.$moment(this.getSeasonBatches[i].activities[o].startDate).format("ll");n[this.getSeasonBatches[i].activities[o].type.toLowerCase()]=c}t.push(n)}var r={};for(o=0;o<t.length;o++){var h=t[o];for(var l in h)"function"!=typeof h[l]&&(r[l]=h[l])}e=0,a=0,s.push(r)}return s}),n()(nt,"schedules",{get:function(){return this.$store.state.startUp.schedules},set:function(t){this.$store.state.startUp.schedules}}),n()(nt,"getBatches",function(){var t=this,e=this.$lodash.filter(this.schedules,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)});return e}),n()(nt,"getSeasonBatches",{get:function(){var t=this,e=l()(this.$store.state.startUp.schedules),a=this.$lodash.filter(e,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)});return this.batches=a,a},set:function(t){this.batches=t}}),n()(nt,"newSeason",function(){return this.$store.state.users.newSeason}),n()(nt,"newSeasonActivities",{get:function(){return this.$store.state.users.newSeasonActivities},set:function(t){this.$store.state.users.newSeasonActivities=t}}),n()(nt,"getPaymentCourseActivity",function(){var t=this,e=this.$store.getters["startUp/getEvent"](this.eventKey),a=this.$lodash.findIndex(this.$store.state.startUp.courses,function(a){return a[".key"]===e.seasons[t.seasonNumber-1].course}),s=this.$lodash.findIndex(this.$store.state.startUp.courses[a].activities,function(t){return"payment"===t.value});return this.$store.state.startUp.courses[a].activities[s]}),n()(nt,"getPhotoshootCourseActivity",function(){var t=this,e=this.$store.getters["startUp/getEvent"](this.eventKey),a=this.$lodash.findIndex(this.$store.state.startUp.courses,function(a){return a[".key"]===e.seasons[t.seasonNumber-1].course}),s=this.$lodash.findIndex(this.$store.state.startUp.courses[a].activities,function(t){return"photoshoot"===t.value});return this.$store.state.startUp.courses[a].activities[s]}),n()(nt,"getPhotolikingCourseActivity",function(){var t=this,e=this.$store.getters["startUp/getEvent"](this.eventKey),a=this.$lodash.findIndex(this.$store.state.startUp.courses,function(a){return a[".key"]===e.seasons[t.seasonNumber-1].course});console.log("i",a);var s=this.$lodash.findIndex(this.$store.state.startUp.courses[a].activities,function(t){return"photoliking"===t.value});return this.$store.state.startUp.courses[a].activities[s]}),nt),data:function(){return{selectedBatch:"",agendaActivities:[],someEventObject:[{id:1,summary:"Test event",description:"Some extra info goes here",location:"Office of the Divine Randomness, 1232 Main St., Denver, CO",start:{dateTime:"2018-10-14T00:00:00.000Z"},end:{dateTime:"2018-10-14T00:00:00.000Z"},color:"positive",attendees:[{id:5,email:"somebody@somewhere.com",displayName:"John Q. Public",organizer:!1,self:!1,resource:!1}]},{id:2,summary:"Test event",description:"Some extra info goes here",location:"Office of the Divine Randomness, 1232 Main St., Denver, CO",start:{dateTime:"2018-11-16T10:00:00"},end:{dateTime:"2018-11-16T10:00:00"},color:"positive",attendees:[{id:5,email:"somebody@somewhere.com",displayName:"John Q. Public",organizer:!1,self:!1,resource:!1}]}],viewAllBatches:"",editMode:!1,generatedBatchActivities:[],selectedNode:"",workshops:{startDate:[],endDate:[],location:[],details:[],time:[]},workshopLength:1,batch0:{},batches:[],messages:[],schedules2:[],isNewBatch:!1,newBatch:{batchNumber:"",startDate:""},newBatchStartDate:"",eventKey:"",seasonNumber:"",getAllActivities:[],showDate:new Date,showEventTimes:!0,enableDragDrop:!1,startingDayOfWeek:0,columns:[{name:"batch",required:!0,label:"batch",field:"batchNumber",align:"left"},{name:"orientation",required:!0,label:"Orientation",align:"left"},{name:"payments",required:!0,label:"Payment",align:"left"},{name:"photoshoot",required:!0,label:"Photoshoot",align:"left"},{name:"photoliking",required:!0,label:"Photoliking",align:"center"},{name:"workshops",required:!0,label:"Workshops",align:"center"},{name:"otherActivities",required:!0,label:"Other Activities",align:"center"},{name:"finalEvent",required:!0,label:"Final event",align:"left"}],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:0}}},methods:{onChangeSelectBatch:function(){},onShowEditBatch:function(){this.selectedBatch=this.editBatchOpt[0].value},isMissingDetails:function(t){var e="undefined"!==typeof t.node.location&&t.node.location,a="undefined"!==typeof t.node.details&&t.node.details;return(""===e||""===a)&&"payment"!==t.node.type&&"photoliking"!==t.node.type&&"orientation"!==t.node.type},isBatchMissingDetails:function(t){if(t.node.children)for(var e=t.node.children,a=0;a<e.length;a++)if((""===e[a].location||""===e[a].details)&&"payment"!==e[a].type&&"photoliking"!==e[a].type&&"orientation"!==e[a].type)return!0;return!1},routeToSeason:function(){this.$router.push("/eventseason/".concat(eventKey))},getSignedModelInBatch:function(t){console.log("getSignedModelInBatch",t)},activityType:function(t){return this.$store.getters["startUp/titleCase"](t)},editBatch2:function(){this.editBatchModal=!0},editBatch:function(){this.editMode=!this.editMode,this.viewMode="calendarMode"},selected:function(t){console.log("item selected",t)},searchDetails:function(t,e){var a=this;setTimeout(function(){e(Object(f["a"])(t,{field:"value",list:a.parseDetails}))},1e3)},searchLocation:function(t,e){var a=this;setTimeout(function(){e(Object(f["a"])(t,{field:"value",list:a.parseLocations}))},500)},selectUpcomingDate:function(t,e){this.workshops.startDate[t]=e,this.$forceUpdate()},alreadySelected:function(t){try{var e=new Date(t);e.setHours(0,0,0,0);var a=this.$store.getters["users/getLastOf3Payment"](this.generatedBatchActivities.activities),s=this.$mathMixin.dayDiff(new Date(this.getBatchFinalEvent.startDate),e);s+=14;var i=this.$mathMixin.dayDiff(a.startDate,e);if(s>=0)return!1;if(i<=0)return!1;if(0!=this.workshops.startDate.length)for(var o=0;o<this.workshops.startDate.length;o++){var n=this.$mathMixin.dayDiff(new Date(this.workshops.startDate[o]),e);if(n<=0)return!1}return!0}catch(t){return!0}},generateBatchNodes:function(){this.batchNode=[];var t=new Array;if(this.isNewBatch){this.batchNode=[];for(var e=l()(this.getSeasonBatches),a=new Array,s=0;s<e.length;s++)a.push(e[s].activities);a.push(this.$store.state.users.newSeasonActivities);for(var i=0;i<a.length;i++){var o=i;o++;for(var n={label:"Batch "+o,children:new Array},c=new Array,r=0;r<a[i].length;r++){var h={label:this.$store.getters["startUp/hasNumber"](this.$store.getters["startUp/get3rdAfterUnderline"](a[i][r].id))?this.$store.getters["startUp/titleCase"](this.$store.getters["startUp/get3rdAfterUnderline"](a[i][r].id)):this.$store.getters["startUp/titleCase"](a[i][r].type),startDate:a[i][r].startDate.toString(),endDate:a[i][r].endDate.toString(),amount:a[i][r].amount?a[i][r].amount:"",dueDate:a[i][r].dueDate?a[i][r].dueDate:"",time:a[i][r].time?a[i][r].time:"",location:a[i][r].location?a[i][r].location:"",details:a[i][r].details?a[i][r].details:"",batch:a[i][r].batch,classes:a[i][r].classes,eventKey:a[i][r].eventKey,id:a[i][r].id,title:a[i][r].title,type:a[i][r].type};c.push(h)}n.children=c,t.push(n)}this.batchNode=t}else if(this.$store.state.users.isNewSeasonActivities){console.log("new season activities");var d=this.$store.state.users.newSeasonActivities,u={label:"Batch 1",children:new Array},v=new Array;for(r=0;r<d.length;r++){var f={label:this.$store.getters["startUp/hasNumber"](this.$store.getters["startUp/get3rdAfterUnderline"](d[r].id))?this.$store.getters["startUp/titleCase"](this.$store.getters["startUp/get3rdAfterUnderline"](d[r].id)):this.$store.getters["startUp/titleCase"](d[r].type),startDate:d[r].startDate.toString(),endDate:d[r].endDate.toString(),amount:d[r].amount?d[r].amount:"",dueDate:d[r].dueDate?d[r].dueDate:"",time:d[r].time?d[r].time:"",location:d[r].location?d[r].location:"",details:d[r].details?d[r].details:"",batch:d[r].batch,classes:d[r].classes,eventKey:d[r].eventKey,id:d[r].id,title:d[r].title,type:d[r].type};v.push(f)}u.children=v,t.push(u),this.batchNode=t}else{new Array;var p=this.$store.state.users.newSeasonActivities,m=new Array;for(s=1;s<=this.getSeasonBatches.length;s++){var y=this.$lodash.filter(p,function(t){return t.batch===s});m.push(y)}for(i=0;i<m.length;i++){o=i;o++;var g={label:"Batch "+o,children:new Array},D=new Array;for(r=0;r<m[i].length;r++){var k={label:this.$store.getters["startUp/hasNumber"](this.$store.getters["startUp/get3rdAfterUnderline"](m[i][r].id))?this.$store.getters["startUp/titleCase"](this.$store.getters["startUp/get3rdAfterUnderline"](m[i][r].id)):this.$store.getters["startUp/titleCase"](m[i][r].type),startDate:m[i][r].startDate.toString(),endDate:m[i][r].endDate.toString(),amount:m[i][r].amount?m[i][r].amount:"",dueDate:m[i][r].dueDate?m[i][r].dueDate:"",time:m[i][r].time?m[i][r].time:"",location:m[i][r].location?m[i][r].location:"",details:m[i][r].details?m[i][r].details:"",batch:m[i][r].batch,classes:m[i][r].classes,eventKey:m[i][r].eventKey,id:m[i][r].id,title:m[i][r].title,type:m[i][r].type};D.push(k)}g.children=D,t.push(g)}this.batchNode=t}},selectNode:function(t){console.log("n",t)},switchMode:function(){console.log("allAct",this.mergeBatches)},getStartDateMin:function(t){try{return this.$store.state.users.newSeasonActivities[0].startDate}catch(t){return""}},removeWorkshop:function(t){try{"undefined"!==typeof this.workshops.startDate[t]&&this.workshops.startDate.splice(t,1),"undefined"!==typeof this.workshops.location[t]&&this.workshops.location.splice(t,1),"undefined"!==typeof this.workshops.details[t]&&this.workshops.details.splice(t,1)}catch(t){}this.workshopLength--},workshopMinDate:function(t){try{if(!(t<2))return this.$mathMixin.addDays(new Date(this.workshops.startDate[t-1]),1).toString();if(0!=this.workshops.startDate.length){var e=this.$store.getters["users/getLastOf3Payment"](this.generatedBatchActivities.activities);return e.startDate}}catch(t){return""}},getSeasonBatches2:function(t,e){var a=this.$lodash.filter(this.schedules,function(a){return a.eventKey===t&&a.seasonNumber===parseInt(e)});return a},clearNewBatch:function(){this.newBatch.batchNumber="",this.newBatchStartDate="",this.workshops={startDate:[],endDate:[],location:[],details:[],time:[]},this.workshopLength=1},getField:function(t){for(var e=Object.keys(t),a=0;a<e.length;a++)return console.log("k",e[a]),"body-cell-".concat(e[a])},getNumberOfPayments:function(){return!1},getBatch:function(t){var e=r()({},t);return++e.__index},getOrientation:function(t){console.log("b",t.activities);var e=l()(t.activities),a=this.$lodash.findIndex(e,function(t){return"orientation"===t.type});return console.log("orientation",e[a]),e[a].startDate},getPayments:function(t){console.log("p",t)},newSeasonStart:function(){return new Date(this.newSeason.seasonStart)},clearActivityModal:function(){},saveActivity:function(){var t=this,e=this.$lodash.findIndex(this.newSeasonActivities,function(e){return e.id===t.activity.originalEvent.id});if(this.newSeasonActivities[e].dueDate=this.activity.originalEvent.dueDate,""===this.activity.originalEvent.dueDate&&"undefined"===typeof this.activity.originalEvent.dueDate||(this.newSeasonActivities[e].endDate=this.activity.originalEvent.dueDate),this.newSeasonActivities[e].details=this.activity.originalEvent.details,this.newSeasonActivities[e].location=this.activity.originalEvent.location,this.newSeasonActivities[e].time=this.activity.originalEvent.time,"open"===this.getSeasonStatus&&(this.newSeasonActivities[e].updated=!0),""!==this.activity.originalEvent.time&&"undefined"!==typeof this.activity.originalEvent.time){console.log("with time"),this.newSeasonActivities[e].startDate=new Date(this.activity.originalEvent.startDate),this.newSeasonActivities[e].endDate=new Date(this.activity.originalEvent.startDate);var a=new Date(this.activity.originalEvent.time).getHours(),s=new Date(this.activity.originalEvent.time).getMinutes();this.newSeasonActivities[e].endDate.setHours(a,s),this.newSeasonActivities[e].startDate.setHours(a,s)}else""!==this.activity.originalEvent.dueDate&&"payment"!==this.activity.originalEvent.type?(this.newSeasonActivities[e].startDate=new Date(this.activity.originalEvent.startDate),this.newSeasonActivities[e].endDate=new Date(this.activity.originalEvent.dueDate),console.log("act",this.newSeasonActivities[e])):(this.newSeasonActivities[e].startDate=new Date(this.activity.originalEvent.startDate),this.newSeasonActivities[e].endDate=new Date(this.activity.originalEvent.startDate));this.activity.endDate=this.newSeasonActivities[e].endDate,console.log("real",this.activity),this.activityModal=!1,this.$forceUpdate()},saveSeasonActivities:function(){var t=this;console.log("saving activities"),this.showRight=!1,this.$q.dialog({title:"Confirm Batch",message:"Do you want to save?",ok:"Yes",cancel:"No"}).then(function(){if(t.$store.state.users.isNewSeasonActivities)console.log("new seaon saving"),console.log("season",t.$store.state.users.newSeason),console.log("season activities",t.$store.state.users.newSeasonActivities),t.$store.dispatch("users/addNewSeason").then(function(){t.editMode=!1});else if(t.editMode)console.log("editMode saving"),t.confirmEditBatch();else{console.log("new batch saving");var e=r()({},t.newBatch),a=t.getSeasonBatches.length;++a,e.batchNumber=a,delete e.startDate;for(var s=0;s<e.activities.length;s++)e.activities[s].batch=a,e.activities[s].startDate=e.activities[s].startDate.toString(),e.activities[s].endDate=e.activities[s].endDate.toString(),e.activities[s].dueDate=e.activities[s].dueDate?e.activities[s].dueDate.toString():"",e.activities[s].updated=!1;e.batchStart=e.activities[0].startDate,console.log("batch to save",e),t.$store.dispatch("users/addNewBatch",e).then(function(){t.isNewBatch=!1,t.$bindAsArray("schedules2",t.$database.ref("event_schedules"));var e=t.$lodash.filter(t.schedules2,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)});t.getSeasonBatches[0].activities=e[0].activities}),t.$forceUpdate()}}).catch(function(){})},cancel:function(){var t=this;if(this.$store.state.users.isNewSeasonActivities)this.$router.push("/eventseason/".concat(this.eventKey));else if(this.editMode){this.editMode=!this.editMode,this.$bindAsArray("schedules2",this.$database.ref("event_schedules")),this.batches=this.$lodash.filter(this.schedules2,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)}),this.getSeasonBatches=this.batches,this.newBatch={},console.log("new batch refresh",this.newBatch),this.$bindAsArray("schedules2",this.$database.ref("event_schedules"));var e=this.$lodash.filter(this.schedules2,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)});this.getSeasonBatches[0].activities=e[0].activities,this.$store.state.users.showRight=!1,this.$store.state.startUp.schedules=this.schedules2,this.viewMode="batchMode"}else{this.$store.state.users.newSeasonActivities=[],this.$store.state.users.isNewSeasonActivities=!1,this.isNewBatch=!1,this.$bindAsArray("schedules2",this.$database.ref("event_schedules")),this.batches=this.$lodash.filter(this.schedules2,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)}),this.getSeasonBatches=this.batches,this.newBatch={},console.log("new batch refresh",this.newBatch),this.$bindAsArray("schedules2",this.$database.ref("event_schedules"));var a=this.$lodash.filter(this.schedules2,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)});this.viewAllBatches=!1,this.$store.state.startUp.schedules=this.schedules2,this.getSeasonBatches[0].activities=a[0].activities,this.$store.state.users.showRight=!1}},clickDate:function(t){},clickEvent:function(t){console.log("e",t),this.activity=this.$store.getters["startUp/getPlainValue"](t),console.log("this.activity",this.activity),this.activityModal=!0},dropOnDate:function(t,e){if(this.editMode||this.isNewBatch){var a=this.$mathMixin.dayDiff(t.startDate,e),s=0;s=this.$store.state.users.isNewSeasonActivities?this.$mathMixin.dayDiff(new Date(this.newSeason.seasonStart),e):this.$mathMixin.dayDiff(new Date(this.getBatchNewOrientation.startDate),e),console.log("elength2",s),console.log("elength",a),console.log("e",t),s>=1&&"orientation"!==t.originalEvent.type&&t.originalEvent.type!==this.getBatchFinalEvent.type&&(t.originalEvent.startDate=this.$mathMixin.addDays(new Date(t.startDate),a),t.originalEvent.endDate=this.$mathMixin.addDays(new Date(t.endDate),a))}},setShowDate:function(t){this.showDate=t},confirmNewBatch:function(){console.log("this new bach",this.newBatch),this.batch=new Array,this.batch0=r()({},this.getSeasonBatches[0]);for(var t=this.$store.getters["startUp/getPlainValue"](this.getLastBatch),e=this.getSeasonBatches.length,a=0;a<t.activities.length;a++)t.activities[a].startDate=t.activities[a].startDate.toString(),t.activities[a].endDate=t.activities[a].endDate.toString();++e;var s=this.$lodash.findIndex(t.activities,function(t){return"orientation"===t.type});t.activities[s].startDate=new Date(this.newBatchStartDate),t.activities[s].endDate=new Date(this.newBatchStartDate),t.activities[s].startDate.setHours(0,0,0,0),t.activities[s].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_orientation"),t.activities[s].title="Batch(".concat(e,")_orientation");for(var i=this.$store.getters["users/convertToDays"]({dateType:this.getPaymentCourseActivity.dayAfter.dateType,dateNumber:this.getPaymentCourseActivity.dayAfter.dateNumber}),o=this.$lodash.filter(t.activities,function(t){return"payment"===t.type}),n=0;n<o.length;n++)0===n?(o[n].startDate=this.$mathMixin.addDays(new Date(this.newBatchStartDate),3),o[n].endDate=this.$mathMixin.addDays(new Date(this.newBatchStartDate),3),o[n].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_payment(").concat(n+1,")"),o[n].title="Batch(".concat(e,")_payment(").concat(n+1,")"),o[n].startDate.setHours(0,0,0,0),o[n].endDate.setHours(0,0,0,0)):(o[n].startDate=this.$mathMixin.addDays(new Date(o[n-1].startDate),i),o[n].endDate=this.$mathMixin.addDays(new Date(o[n-1].startDate),i),o[n].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_payment(").concat(n+1,")"),o[n].title="Batch(".concat(e,")_payment(").concat(n+1,")"),o[n].startDate.setHours(0,0,0,0),o[n].endDate.setHours(0,0,0,0));var c=this.$store.getters["users/convertToDays"]({dateType:this.getPhotoshootCourseActivity.dayAfter.dateType,dateNumber:this.getPhotoshootCourseActivity.dayAfter.dateNumber}),h=this.$lodash.findIndex(t.activities,function(t){return"photoshoot"===t.type});t.activities[h].startDate=this.$mathMixin.addDays(new Date(o[0].startDate),c),t.activities[h].endDate=this.$mathMixin.addDays(new Date(o[0].startDate),c),t.activities[h].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_photoshoot"),t.activities[h].title="Batch(".concat(e,")_photoshoot");this.$store.getters["users/convertToDays"]({dateType:this.getPhotolikingCourseActivity.dayAfter.dateType,dateNumber:this.getPhotolikingCourseActivity.dayAfter.dateNumber});var d=this.$lodash.findIndex(t.activities,function(t){return"photoliking"===t.type});t.activities[d].startDate=this.$mathMixin.addDays(new Date(o[1].startDate),c),t.activities[d].endDate=this.$mathMixin.addDays(new Date(o[1].startDate),14),t.activities[d].dueDate=this.$mathMixin.addDays(new Date(o[1].startDate),14),t.activities[d].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_photoliking"),t.activities[d].title="Batch(".concat(e,")_photoliking"),t.activities[d].startDate.setHours(0,0,0,0),t.activities[d].endDate.setHours(0,0,0,0);for(var u=0,v=0;v<t.activities.length;v++)"orientation"!==t.activities[v].type&&"payment"!==t.activities[v].type&&"photoshoot"!==t.activities[v].type&&"photoliking"!==t.activities[v].type&&(t.activities[v].startDate=new Date(t.activities[v].startDate),t.activities[v].endDate=new Date(t.activities[v].endDate),t.activities[v].time=t.activities[v].time?new Date(t.activities[v].time):"",t.activities[v].dueDate=t.activities[v].dueDate?new Date(t.activities[v].dueDate):"",t.activities[v].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_").concat(t.activities[v].type),t.activities[v].title="Batch(".concat(e,")_").concat(t.activities[v].type),"workshop"===t.activities[v].type&&(u++,console.log("found workshop",u),t.activities[v].startDate=new Date(t.activities[v].startDate),t.activities[v].endDate=new Date(t.activities[v].endDate),t.activities[v].time=new Date(t.activities[v].startDate),t.activities[v].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_").concat(t.activities[v].type,"(").concat(u,")"),t.activities[v].title="Batch(".concat(e,")_").concat(t.activities[v].type,"(").concat(u,")")));if(this.is4BatchMax){console.log("workshop is 4batchMax");for(var f=this.$lodash.filter(t.activities,function(t){return"workshop"===t.type}),p=0;p<f.length;p++){f[p].startDate=new Date(this.workshops.startDate[p]),f[p].endDate=new Date(this.workshops.startDate[p]),f[p].time=new Date(this.workshops.time[p]),f[p].location=this.workshops.location[p]?this.workshops.location[p]:"",f[p].details=this.workshops.details[p]?this.workshops.details[p]:"";var m=new Date(f[p].time).getHours(),y=new Date(f[p].time).getMinutes();f[p].startDate.setHours(m,y),f[p].endDate.setHours(m,y),delete f[p].dueDate}}console.log("batch",t),this.newBatch=r()({},t),this.$store.state.users.newSeasonActivities=l()(t.activities),this.setShowDate(new Date(this.newBatch.activities[0].startDate)),this.generateBatchNodes,this.isNewBatch=!0,this.newBatchModal=!1},confirmEditBatch:function(){console.log("confirmEditBatch",this.getSeasonBatches);for(var t=0;t<this.getSeasonBatches.length;t++){for(var e=this.getSeasonBatches[t][".key"],a=this.getSeasonBatches[t].activities,s=0;s<a.length;s++)a[s].startDate=a[s].startDate.toString(),a[s].endDate=a[s].endDate.toString(),a[s].dueDate=a[s].dueDate?a[s].dueDate.toString():"",a[s].time=a[s].time?a[s].time.toString():"";console.log("act",a),this.$database.ref("event_schedules/".concat(e,"/activities")).set(a).then(function(){console.log("success")}).catch(function(t){console.log("error",t)})}this.$bindAsArray("schedules2",this.$database.ref("event_schedules")),this.$store.state.startUp.schedules=this.schedules2,this.viewMode="batchMode",this.editMode=!1},isAbleToRemove:function(t){if(!(t.row.__index>=this.customBatches.length-1))return!1;var e=t.row.__index;if("standby"===this.getSeasonStatus){if("standby"===this.getSeasonStatus||0===e)return!0;e++;var a=this.$lodash.findIndex(this.getSeasonBatches,function(t){return t.batchNumber===e}),s=this.getSeasonBatches[a],i=(s[".key"],this.$mathMixin.dayDiff(new Date,new Date(t.row.orientation)));if(i>0)return!0}},removeBatch:function(t){var e=this;this.$q.dialog({title:"Confirm",message:"Are you sure you want to delete this batch?",ok:"Yes",cancel:"No"}).then(function(){console.log("props",t),console.log("getSeasonBatches",e.getSeasonBatches);var a=t.row.__index;if(a++,a<=1){var s=e.$lodash.findIndex(e.getSeasonBatches,function(t){return t.batchNumber===a});console.log("bIndex",e.getSeasonBatches[s]);var i=e.getSeasonBatches[s],o=i[".key"],n=e;e.$database.ref("event_schedules").child(o).remove().then(function(){e.eventKey,e.seasonNumber;e.$database.ref("events/".concat(e.eventKey,"/seasons/").concat(e.seasonNumber-1)).remove().then(function(){n.$q.notify({message:"".concat(i.eventName," Season ").concat(i.seasonNumber," has been removed"),type:"info",color:"info",textColor:"white",icon:"info"}),n.$router.push("/eventseason/".concat(e.eventKey))}).catch(function(t){console.log("an error occur",t)})})}else{s=e.$lodash.findIndex(e.getSeasonBatches,function(t){return t.batchNumber===a});console.log("bIndex",e.getSeasonBatches[s]);var c=e.getSeasonBatches[s];o=c[".key"];e.$database.ref("event_schedules").child(o).remove().then(function(){e.$q.notify({message:"".concat(c.eventName," Season ").concat(c.seasonNumber," has been removed"),type:"info",color:"info",textColor:"white",icon:"info"})})}}).catch(function(){})},checkIfOverlap:function(){this.getSeasonBatches[0].activities;this.newBatchModal=!this.newBatchModal},getNumOfSignedModels:function(t){console.log("contractSigned",t);var e=t.__index;++e,console.log("b number",e);var a=this.$lodash.findIndex(this.getSeasonBatches,function(t){return t.batchNumber===e}),s=this.getSeasonBatches[a];console.log("batch",s),console.log("batchkey",s[".key"]);var i=this.$lodash.filter(this.seasonBatchContractSigned,function(t){return console.log("sbcs",t.batchKey),t.batchKey===s[".key"]});return console.log("signedbatchmodels",i.length),i.length},generateNewBatchDate:function(){for(var t=this.getLastBatch.activities[0],e=this.$store.getters["startUp/getUpcomingWeekEnds"]({startDate:new Date(t.startDate),weekEnd:"sundays"}),a=new Array,s=0;s<e.length;s++){var i=this.$mathMixin.dayDiff(new Date(t.startDate),new Date(e[s]));i>0&&a.push(e[s])}this.newBatchStartDate=a[0]},generateWorkshopScheds:function(){for(var t=this,e=this.$lodash.filter(this.getLastBatch.activities,function(t){return"payment"===t.type})[2],a=this.$lodash.filter(this.getLastBatch.activities,function(e){return e.type===t.getOtherActivities[0].label})[0],s=this.$store.getters["startUp/getUpcomingWeekEnds"]({startDate:new Date(e.startDate),weekEnd:"sundays"}),i=new Array,o=0;o<s.length;o++){var n=this.$mathMixin.dayDiff(new Date(e.startDate),new Date(s[o]));n>0&&i.push(s[o])}i.splice(0,this.getWorkshopActivity.length);var c=new Array;for(o=0;o<i.length;o++){var r=this.$mathMixin.dayDiff(new Date(a.startDate),new Date(i[o]));r<0&&c.push(i[o])}console.log("filterSun2",c),console.log("getWorkshopActivity",this.getWorkshopActivity);for(o=0;o<this.getWorkshopActivity.length;o++){this.workshops.startDate[o]=new Date(c[o]),this.workshops.endDate[o]=new Date(c[o]),this.workshops.location[o]=this.getWorkshopActivity[o].location,this.workshops.details[o]=this.getWorkshopActivity[o].details;var h=new Date(this.getWorkshopActivity[o].startDate).getHours(),l=new Date(this.getWorkshopActivity[o].startDate).getMinutes();this.workshops.startDate[o].setHours(h,l,0,0),this.workshops.endDate[o].setHours(h,l,0,0),this.workshops.time[o]=new Date(this.getWorkshopActivity[o].startDate)}console.log("workshops",this.workshops)},test:function(){console.log("getSeasonBatches",this.getSeasonBatches)}}},ut=dt,vt=Object(D["a"])(ut,s,i,!1,null,null,null);e["default"]=vt.exports},T39b:function(t,e,a){"use strict";var s=a("wmvG"),i=a("s5qY"),o="Set";t.exports=a("4LiD")(o,function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return s.def(i(this,o),t=0===t?0:t,t)}},s)},i7dR:function(t,e,a){},iO8G:function(t,e,a){},s5qY:function(t,e,a){var s=a("0/R4");t.exports=function(t,e){if(!s(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},vL7x:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row flex justify-center"},[t.activityListDrawer?a("div",{staticClass:"q-mr-md",staticStyle:{width:"168px"}},[a("transition",{attrs:{appear:"","enter-active-class":"animated slideInLeft","leave-active-class":"animated slideOutLeft"}},[a("q-list",{attrs:{highlight:""}},[a("p",{staticClass:"q-title q-ma-md"},[t._v("Activities")]),t._l(t.plottedActivities,function(e,s){return a("q-item",{key:s},[a("q-item-main",[a("div",{on:{click:function(a){t.locateActivity(e)}}},[a("q-item-tile",{attrs:{label:""}},[t._v(" "+t._s(e.title))]),"detailed"===e.actType?a("div",[a("q-item-tile",{staticClass:"q-caption",attrs:{sublabel:""}},[t._v(t._s(t.$moment(e.startDate).format("ll"))+"\n\t\t\t\t\t\t\t      "+t._s(e.time?"- "+t.$moment(e.time).format("LT"):""))]),"payments"===e.type?a("q-item-tile",{attrs:{sublabel:""}},[a("b",[t._v("Amount: P"+t._s(e.amount))])]):t._e()],1):a("div",[a("q-item-tile",{staticClass:"q-caption",attrs:{sublabel:""}},[a("b",[t._v("Start Date: ")]),t._v(" "+t._s(t.$moment(e.startDate).format("ll")))]),a("q-item-tile",{staticClass:"q-caption",attrs:{sublabel:""}},[a("b",[t._v("End Date: ")]),t._v(" "+t._s(t.$moment(e.endDate).format("ll")))])],1)],1)])],1)})],2)],1)],1):t._e(),a("div",{staticClass:"col"},[a("q-btn",{attrs:{size:"sm",flat:"",icon:"calendar view day"},on:{click:function(e){t.activityListDrawer=!t.activityListDrawer}}}),a("q-btn",{attrs:{size:"sm",flat:"",label:"test"},on:{click:t.test}}),a("div",{staticClass:"a"},[a("q-toggle",{attrs:{label:"All Schedules"},on:{input:t.onChangeAllSchedules},model:{value:t.allScheduleChecked,callback:function(e){t.allScheduleChecked=e},expression:"allScheduleChecked"}}),t.isNewBatch?a("q-toggle",{attrs:{label:"View Batches"},on:{input:t.onChangeViewBatches},model:{value:t.viewBatchesChecked,callback:function(e){t.viewBatchesChecked=e},expression:"viewBatchesChecked"}}):t._e()],1),a("calendar-view",{staticClass:"calendar theme-default holiday-us-traditional q-ma-md",attrs:{"show-date":t.showDate,events:t.localPlottedActivities,"show-event-times":t.showEventTimes,enableDragDrop:t.enableDragDrop,timeFormatOptions:{hour:"numeric",minute:"numeric",hour12:!0},startingDayOfWeek:t.startingDayOfWeek},on:{"show-date-change":t.setShowDate,"click-date":t.clickDate,"click-event":t.clickEvent,"drop-on-date":t.dropOnDate}})],1),a("q-modal",{attrs:{minimized:"","content-css":{minWidth:"60px",minHeight:"85vh"}},model:{value:t.activityModal,callback:function(e){t.activityModal=e},expression:"activityModal"}},[a("q-modal-layout",[a("q-toolbar",{attrs:{slot:"header"},slot:"header"},[a("q-btn",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],attrs:{flat:"",round:"",dense:"",icon:"keyboard_arrow_left"}}),a("q-toolbar-title",[t._v("\n\t\t        "+t._s(t.selectedActivity.title)+"\n\t\t      ")])],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("p",[t._v("Footer")])]),a("div",{staticClass:"layout-padding"},[a("q-field",{attrs:{"label-width":"2",icon:"date_range"}},[a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-select",{attrs:{"stack-label":"Select Date",filter:"",options:t.otherActivityOpt},model:{value:t.selectedActivity.startDate,callback:function(e){t.$set(t.selectedActivity,"startDate",e)},expression:"selectedActivity.startDate"}}),a("q-datetime",{attrs:{"stack-label":"Date",format:"ddd MMM D, YYYY",type:"date"},model:{value:t.selectedActivity.startDate,callback:function(e){t.$set(t.selectedActivity,"startDate",e)},expression:"selectedActivity.startDate"}})],1),a("q-checkbox",{staticClass:"col-1 q-mt-md",attrs:{"checked-icon":"calendar_today","unchecked-icon":"calendar_today"},model:{value:t.modelcheck,callback:function(e){t.modelcheck=e},expression:"modelcheck"}})],1),a("q-datetime",{attrs:{"stack-label":"Time",format:"h:mm A",type:"time"},model:{value:t.selectedActivity.time,callback:function(e){t.$set(t.selectedActivity,"time",e)},expression:"selectedActivity.time"}})],1)]),a("q-item-separator"),a("q-field",{attrs:{icon:"description"}},[a("q-select",{attrs:{separator:"","float-label":"Select Location",filter:"",options:t.locationTemplateOpt},model:{value:t.selectedActivity.location,callback:function(e){t.$set(t.selectedActivity,"location",e)},expression:"selectedActivity.location"}}),a("q-input",{attrs:{type:"textarea","float-label":"Location","max-height":80,rows:"5"},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}),a("q-input",{attrs:{type:"textarea","float-label":"Details (optional)","max-height":80,rows:"5"},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1)],1)],1)],1)},i=[];s._withStripped=!0;a("dRSK"),a("a1Th"),a("rE2o"),a("ioFf"),a("yt8O"),a("T39b");var o=a("RIqP"),n=a.n(o),c=(a("rGqo"),a("VRzm"),a("ls82"),a("yXPU")),r=a.n(c),h=(a("xfY5"),a("9JDm")),l=a("VVcl"),d=a.n(l);a("i7dR"),a("iO8G");var u={components:{CalendarView:d.a},props:{course:{type:String,default:""},discount:{type:Number,default:0},eventKey:{type:String,default:""},eventCode:{type:String,default:""},eventName:{type:String,default:""},numberOfPayments:{type:Number,default:0},numberOfWorkshops:{type:Number,default:0},seasonNumber:{type:Number,default:0},ticketCount:{type:Number,default:0},ticketPrice:{type:Number,default:0},totalAmount:{type:Number,default:0},seasonDraftKey:{type:String,default:""},newBatchObject:{type:Object,default:{}},isNewBatch:{type:Boolean,defaul:!1}},created:function(){this.localPlottedActivities=this.plottedActivities,this.setLocalPlottedAsOriginalActivity(),this.setShowDate(this.localPlottedActivities[0].startDate),console.log(this.localPlottedActivities,"localPlottedActivities")},watch:{allScheduleChecked:function(){}},computed:{seasonBatches:function(){var t=this,e=this.$lodash.filter(this.eventSchedules,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===t.seasonNumber});return e},getFinalEventActivity:function(){return this.$store.state.schedules.finalEvent},getOrientationActivity:function(){return this.$store.state.schedules.orientation},plottedActivities:{get:function(){return this.$store.state.schedules.plottedActivities},set:function(t){this.$store.state.schedules.plottedActivities=t}},otherActivityOpt:function(){return[]},locationTemplateOpt:function(){return[]}},firebase:function(){return{eventSchedules:this.$database.ref("event_schedules")}},data:function(){return{localPlottedActivities:[],viewBatchesChecked:!1,allScheduleChecked:!1,selectedActivity:{actType:"",classes:"",details:"",endDate:"",eventKey:"",id:"",location:"",startDate:"",time:"",title:"",type:""},modelcheck:!1,model:"",activityModal:!1,activityListDrawer:!1,events:[{startDate:new Date("Sat Jan 12 2019 08:00:00"),endDate:new Date("Sat Jan 12 2019 08:00:00"),id:"test",title:"testing",classes:"salad yellow"}],checked:!1,showDate:new Date,showEventTimes:!0,enableDragDrop:!0,startingDayOfWeek:0}},methods:{onChangeViewBatches:function(){var t=r()(regeneratorRuntime.mark(function t(){var e,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=new Promise(function(t){if(a.viewBatchesChecked){var e;a.allScheduleChecked&&(a.allScheduleChecked=!1,a.onChangeAllSchedules());var s=a.$store.getters["startUp/getPlainValue"](a.localPlottedActivities),i=a.$store.getters["startUp/getPlainValue"](a.seasonBatches),o=[];a.$lodash.remove(i,function(t){return t[".key"]===a.editBatchKey}),a.$lodash.forEach(i,function(t){var e=a.$store.getters["startUp/getPlainValue"](t.activities);o.push(e)}),o.push(s);var c=n()(new Set((e=[]).concat.apply(e,o))),r=a.$lodash.map(c,function(t){var e=a.$store.getters["startUp/get2ndAfterUnderline"](t.id),s=a.$store.getters["startUp/extractNumber"](e);return t.title="Batch(".concat(s,")_").concat(a.$store.getters["startUp/get3rdAfterUnderline"](t.id)),t.startDate=new Date(t.startDate),t.endDate=new Date(t.endDate),t});a.localPlottedActivities=r}else{var h=a.$store.getters["startUp/getPlainValue"](a.localPlottedActivities);console.log("tempAct",h);for(var l=[],d=0;d<h.length;d++)h[d].originalActivity&&(h[d].startDate=new Date(h[d].startDate),h[d].endDate=new Date(h[d].endDate),l.push(h[d]));console.log("toReplacement",l),a.localPlottedActivities=[],a.localPlottedActivities=l,console.log("this.localPlottedActivities",a.localPlottedActivities)}t("done")}),t.next=3,e;case 3:t.sent;case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),setLocalPlottedAsOriginalActivity:function(){for(var t=0;t<this.localPlottedActivities.length;t++)0!==t&&(this.localPlottedActivities[t].beforeDate=this.localPlottedActivities[t-1].startDate),this.localPlottedActivities.length,this.localPlottedActivities[t].index=t,this.localPlottedActivities[t].originalActivity=!0},setShowDate:function(t){this.showDate=t},locateActivity:function(t){this.setShowDate(t.startDate)},onChangeAllSchedules:function(){var t=r()(regeneratorRuntime.mark(function t(e){var a,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=new Promise(function(t){if(s.allScheduleChecked){var e;s.allScheduleChecked&&(s.viewBatchesChecked=!1,s.onChangeViewBatches());var a=[],i=s.$store.getters["startUp/getPlainValue"](s.localPlottedActivities),o=s.$store.getters["startUp/getPlainValue"](s.eventSchedules);s.$lodash.remove(o,function(t){return t[".key"]===s.editBatchKey&&t.batchNumber===s.batchNumber}),console.log("eventSchedules",o);for(var c=0;c<o.length;c++)a.push(o[c].activities);for(c=0;c<i.length;c++)i[c].startDate=new Date(i[c].startDate),i[c].endDate=new Date(i[c].endDate);a.push(i);var r=n()(new Set((e=[]).concat.apply(e,a))),h=s.$lodash.map(r,function(t){return t.originalActivity||(t.title=t.id,t.startDate=new Date(t.startDate),t.endDate=new Date(t.endDate)),t});s.localPlottedActivities=h}else{var l=s.$store.getters["startUp/getPlainValue"](s.localPlottedActivities),d=[];for(c=0;c<l.length;c++)l[c].originalActivity&&(l[c].startDate=new Date(l[c].startDate),l[c].endDate=new Date(l[c].endDate),d.push(l[c]));s.localPlottedActivities=[],s.localPlottedActivities=d,console.log("this.localPlottedActivities",s.localPlottedActivities)}t("done")}),t.next=3,a;case 3:t.sent;case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),convertToStringDates:function(t){var e=!0,a=!1,s=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var n=i.value;n.startDate=n.startDate.toString(),n.endDate=n.endDate.toString(),n.time=n.time.toString()}}catch(t){a=!0,s=t}finally{try{e||null==o.return||o.return()}finally{if(a)throw s}}return console.log("act",t),t},saveNewSeasonBatchActivity:function(){var t=r()(regeneratorRuntime.mark(function t(){var e,a,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=new Promise(function(t,e){s.$q.dialog({title:"Confirmation",message:"Do you want to save ?",ok:"Yes",cancel:"No"}).then(function(){s.viewBatchesChecked=!1,s.onChangeViewBatches(),s.allScheduleChecked=!1,s.onChangeAllSchedules(),s.isNewBatch?s.saveNewBatch().then(function(e){s.localPlottedActivities=[],t(!0)}):s.saveNewSeason()}).catch(function(){t(!1)})}),t.next=3,e;case 3:return a=t.sent,console.log("saveNewSeasonBatchActivity ,result ",a),t.abrupt("return",a);case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),removeOriginalActivityField:function(){this.$lodash.forEach(this.localPlottedActivities,function(t){return delete t.originalActivity,t})},removeSeasonDraft:function(){var t=r()(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("schedules/removeSeasonDraftAfterSave",this.seasonDraftKey);case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),saveNewBatch:function(){var t=r()(regeneratorRuntime.mark(function t(){var e,a,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=new Promise(function(t){s.removeOriginalActivityField();var e=s.$store.getters["startUp/getPlainValue"](s.newBatchObject),a=s.$store.getters["startUp/getPlainValue"](s.localPlottedActivities);e.activities=a,delete e[".key"],e.batchNumber++,e.batchStart=e.activities[0].startDate,e.dateCreated=(new Date).toString(),console.log("newBatch",e),s.$store.dispatch("schedules/saveNewBatch",e).then(function(){s.plottedActivities=[],s.$store.state.users.newBatchModal=!1,t(!0)}).catch(function(t){})}),t.next=3,e;case 3:return a=t.sent,t.abrupt("return",a);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),saveNewSeason:function(){var t=this;this.removeOriginalActivityField();var e=this.$store.getters["startUp/getPlainValue"](this.localPlottedActivities);console.log(e,"activities");var a={activities:e,batchNumber:1,batchStart:this.getOrientationActivity.startDate.toString(),colorCode:this.getOrientationActivity.classes,course:this.course,dateCreated:(new Date).toString(),discount:this.discount,eventKey:this.eventKey,eventCode:this.eventCode,eventName:this.eventName,numberOfPayments:this.numberOfPayments,numberOfWorkshops:this.numberOfWorkshops,seasonEnd:this.getFinalEventActivity.startDate.toString(),seasonName:"".concat(this.eventCode,"_Season").concat(this.seasonNumber),seasonNumber:this.seasonNumber,seasonStart:this.getOrientationActivity.startDate.toString(),status:"standby",ticketCount:this.ticketCount,ticketPrice:this.ticketPrice,totalAmount:this.totalAmount};console.log("newSeason",a),this.$store.dispatch("schedules/saveNewSeasonBatchActivity",a).then(function(){""!==t.seasonDraftKey&&t.removeSeasonDraft(),t.$router.push("/eventseason/".concat(t.$route.params.id,"/").concat(a.seasonNumber,"/seasonBatches"))}).catch(function(t){console.log("err")})},test:function(t){console.log("localPlottedActivities",this.localPlottedActivities)},clickDate:function(t){},clickEvent:function(t){},setTime:function(t,e){var a=new Date(e).getHours(),s=new Date(e).getMinutes(),i=new Date(t);return i.setHours(a,s,0,0),i},removeTime:function(t){var e=new Date(t);return e.setHours(0,0,0,0),e},dropOnDate:function(t,e){var a=t.originalEvent;if(this.isNewBatch){if(t.originalEvent.originalActivity){var s=this.$lodash.find(this.localPlottedActivities,function(t){return"orientation"===t.type}),i=this.$lodash.find(this.localPlottedActivities,function(t){return"final event"===t.type}),o=h["d"].getDateDiff(e,s.startDate),n=h["d"].getDateDiff(e,i.startDate);if("orientation"!=a.type&&"final event"!=a.type&&o>0&&n<0)if("detailed"===a.actType)"payments"===a.type?(a.startDate=this.removeTime(e),a.endDate=this.removeTime(e)):(a.startDate=this.setTime(e,a.time),a.endDate=this.setTime(e,a.time));else{var c=h["d"].getDateDiff(a.startDate,a.endDate);a.startDate=e,a.endDate=h["d"].addToDate(e,{days:Math.abs(c)})}}}else{o=h["d"].getDateDiff(e,this.getOrientationActivity.startDate),n=h["d"].getDateDiff(e,this.getFinalEventActivity.startDate);if(t.originalEvent.originalActivity&&"orientation"!=a.type&&"final event"!=a.type&&o>0&&n<0)if("detailed"===a.actType)"payments"===a.type?(a.startDate=this.removeTime(e),a.endDate=this.removeTime(e)):(a.startDate=this.setTime(e,a.time),a.endDate=this.setTime(e,a.time));else{c=h["d"].getDateDiff(a.startDate,a.endDate);a.startDate=e,a.endDate=h["d"].addToDate(e,{days:Math.abs(c)})}}}},destroyed:function(){console.log("destryoed"),this.locateActivity=[],this.plottedActivities=[]}},v=u,f=(a("Bjc7"),a("KHd+")),p=Object(f["a"])(v,s,i,!1,null,null,null);e["a"]=p.exports},wmvG:function(t,e,a){"use strict";var s=a("hswa").f,i=a("Kuth"),o=a("3Lyj"),n=a("m0Pp"),c=a("9gX7"),r=a("SlkY"),h=a("Afnz"),l=a("1TsA"),d=a("elZq"),u=a("nh4g"),v=a("Z6vF").fastKey,f=a("s5qY"),p=u?"_s":"size",m=function(t,e){var a,s=v(e);if("F"!==s)return t._i[s];for(a=t._f;a;a=a.n)if(a.k==e)return a};t.exports={getConstructor:function(t,e,a,h){var l=t(function(t,s){c(t,l,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[p]=0,void 0!=s&&r(s,a,t[h],t)});return o(l.prototype,{clear:function(){for(var t=f(this,e),a=t._i,s=t._f;s;s=s.n)s.r=!0,s.p&&(s.p=s.p.n=void 0),delete a[s.i];t._f=t._l=void 0,t[p]=0},delete:function(t){var a=f(this,e),s=m(a,t);if(s){var i=s.n,o=s.p;delete a._i[s.i],s.r=!0,o&&(o.n=i),i&&(i.p=o),a._f==s&&(a._f=i),a._l==s&&(a._l=o),a[p]--}return!!s},forEach:function(t){f(this,e);var a,s=n(t,arguments.length>1?arguments[1]:void 0,3);while(a=a?a.n:this._f){s(a.v,a.k,this);while(a&&a.r)a=a.p}},has:function(t){return!!m(f(this,e),t)}}),u&&s(l.prototype,"size",{get:function(){return f(this,e)[p]}}),l},def:function(t,e,a){var s,i,o=m(t,e);return o?o.v=a:(t._l=o={i:i=v(e,!0),k:e,v:a,p:s=t._l,n:void 0,r:!1},t._f||(t._f=o),s&&(s.n=o),t[p]++,"F"!==i&&(t._i[i]=o)),t},getEntry:m,setStrong:function(t,e,a){h(t,e,function(t,a){this._t=f(t,e),this._k=a,this._l=void 0},function(){var t=this,e=t._k,a=t._l;while(a&&a.r)a=a.p;return t._t&&(t._l=a=a?a.n:t._t._f)?l(0,"keys"==e?a.k:"values"==e?a.v:[a.k,a.v]):(t._t=void 0,l(1))},a?"entries":"values",!a,!0),d(e)}}},xRJO:function(t,e,a){"use strict";var s=a("JGJa"),i=a.n(s);i.a}}]);